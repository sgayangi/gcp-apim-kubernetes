WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
Successfully copied 16.4kB to /data/schema.yaml
457fd04e67faa26b7337a4ae7af1d5d1a7656aba4a663ec2a675663dff66bf3b
INFO Parameters: {
  "name": "apptest-9eyndrif",
  "namespace": "apptest-9eyndrif"
}
INFO Creates namespace "apptest-9eyndrif"
Using /opt/kubectl/1.31/kubectl (server=1.32)
namespace/apptest-9eyndrif created
INFO Initializes the deployer container which will deploy all the application components
WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
Successfully copied 16.4kB to /data/schema.yaml
90f9df45f93b98fc5c68de573e88a31ee843b0cc954b1a36716f8449fabaf948
INFO: /data/schema.yaml:
x-google-marketplace:
  schemaVersion: v2
  applicationApiVersion: v1beta1
  publishedVersion: "4.5.0"
  publishedVersionMetadata:
    releaseNote: >-
      Initial release of WSO2 APIM Kubernetes deployment with support for
      API Manager Control Plane (ACP), API Platform for Kubernetes (APK),
      and APK Agent integration on Google Cloud Platform.
    releaseTypes:
      - Feature
    recommended: false

  clusterConstraints:
    resources:
      - replicas: 1
        requests:
          cpu: 500m
          memory: 1Gi
    k8sVersion: ">=1.24.0"

  images:
    wso2am-acp:
      properties:
        wso2amAcpImage:
          type: FULL
    apk-config-deployer-service:
      properties:
        configDeployerImage:
          type: FULL
    apk-adapter:
      properties:
        adapterImage:
          type: FULL
    apk-common-controller:
      properties:
        commonControllerImage:
          type: FULL
    apk-ratelimiter:
      properties:
        ratelimiterImage:
          type: FULL
    apk-router:
      properties:
        routerImage:
          type: FULL
    apk-enforcer:
      properties:
        enforcerImage:
          type: FULL
    apim-apk-agent:
      properties:
        apimApkAgentImage:
          type: FULL

  deployerServiceAccount:
    description: >
      Deployer service account for installing WSO2 APIM APK, including CRDs, RBAC resources, and cluster-wide configurations.
    roles:
      - type: ClusterRole
        rulesType: CUSTOM
        rules:
          - apiGroups: ["apiextensions.k8s.io"]
            resources: ["customresourcedefinitions"]
            verbs: ["*"]
          - apiGroups: ["rbac.authorization.k8s.io"]
            resources:
              ["clusterroles", "clusterrolebindings", "roles", "rolebindings"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: [""]
            resources:
              [
                "services",
                "configmaps",
                "secrets",
                "serviceaccounts",
                "persistentvolumeclaims",
                "pods",
                "namespaces",
              ]
            verbs: ["get", "list", "watch", "update", "delete", "create"]
          - apiGroups: ["apps"]
            resources: ["deployments", "statefulsets", "replicasets"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["batch"]
            resources: ["jobs"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["networking.k8s.io"]
            resources: ["ingresses", "networkpolicies"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["policy"]
            resources: ["podsecuritypolicies"]
            verbs:
              [
                "get",
                "list",
                "watch",
                "create",
                "update",
                "patch",
                "delete",
                "use",
              ]
          - apiGroups: ["admissionregistration.k8s.io"]
            resources:
              [
                "mutatingwebhookconfigurations",
                "validatingwebhookconfigurations",
              ]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["cert-manager.io"]
            resources: ["certificates", "issuers", "clusterissuers"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["coordination.k8s.io"]
            resources: ["leases"]
            verbs:
              ["get", "list", "watch", "update", "patch", "create", "delete"]
          - apiGroups: ["gateway.networking.k8s.io"]
            resources:
              [
                "httproutes",
                "gateways",
                "gatewayclasses",
                "grpcroutes",
                "httproutes/status",
                "gateways/status",
                "gatewayclasses/status",
              ]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["dp.wso2.com"]
            resources: ["*"]
            verbs: ["*"]
          - apiGroups: ["cp.wso2.com"]
            resources: ["*"]
            verbs: ["*"]

properties:
  controller.serviceAccount:
    type: string
    x-google-marketplace:
      type: SERVICE_ACCOUNT
      serviceAccount:
        description: Service account for API controller
        roles:
          - type: ClusterRole
            rulesType: CUSTOM
            rules:
              - apiGroups: ["apiextensions.k8s.io"]
                resources: ["customresourcedefinitions"]
                verbs: ["*"]
              - apiGroups: ["rbac.authorization.k8s.io"]
                resources:
                  [
                    "clusterroles",
                    "clusterrolebindings",
                    "roles",
                    "rolebindings",
                  ]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: [""]
                resources:
                  [
                    "services",
                    "configmaps",
                    "secrets",
                    "serviceaccounts",
                    "persistentvolumeclaims",
                    "pods",
                    "namespaces",
                  ]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["apps"]
                resources: ["deployments", "statefulsets", "replicasets"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["batch"]
                resources: ["jobs"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["networking.k8s.io"]
                resources: ["ingresses", "networkpolicies"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["policy"]
                resources: ["podsecuritypolicies"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                    "use",
                  ]
              - apiGroups: ["admissionregistration.k8s.io"]
                resources:
                  [
                    "mutatingwebhookconfigurations",
                    "validatingwebhookconfigurations",
                  ]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["cert-manager.io"]
                resources: ["certificates", "issuers", "clusterissuers"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["gateway.networking.k8s.io"]
                resources: ["httproutes", "gateways", "gatewayclasses"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["gateway.networking.k8s.io"]
                resources: ["gateways/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apis"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apis/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apis/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["authentications"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["authentications/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["authentications/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backends"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backends/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backends/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apipolicies"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apipolicies/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apipolicies/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["interceptorservices"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["interceptorservices/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["interceptorservices/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["scopes"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["scopes/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["scopes/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["ratelimitpolicies"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["ratelimitpolicies/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["ratelimitpolicies/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["coordination.k8s.io"]
                resources: ["leases"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "update",
                    "patch",
                    "create",
                    "delete",
                  ]
              - apiGroups: ["dp.wso2.com"]
                resources: ["tokenissuers"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["tokenissuers/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["tokenissuers/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backendjwts"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backendjwts/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backendjwts/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["gqlroutes"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["gqlroutes/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["gqlroutes/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["aiproviders"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["aiproviders/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["aiproviders/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["airatelimitpolicies"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["airatelimitpolicies/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["airatelimitpolicies/status"]
                verbs: ["get", "patch", "update"]
  name:
    type: string
    x-google-marketplace:
      type: NAME
    title: Application name
    description: The name of the application instance

  namespace:
    type: string
    x-google-marketplace:
      type: NAMESPACE
    title: Namespace
    description: The Kubernetes namespace where the application will be deployed

required:
  - name
  - namespace
Using /opt/kubectl/1.31/kubectl (server=1.32)
Using /opt/kubectl/1.31/kubectl (server=1.32)
application.app.k8s.io/apptest-9eyndrif created
Using /opt/kubectl/1.31/kubectl (server=1.32)
Using /opt/kubectl/1.31/kubectl (server=1.32)
serviceaccount/apptest-9eyndrif-deployer-sa created
Using /opt/kubectl/1.31/kubectl (server=1.32)
INFO Application 'apptest-9eyndrif' owns 'ServiceAccount/apptest-9eyndrif-controller-serviceaccount'
INFO Application 'apptest-9eyndrif' does not own cluster-scoped 'ClusterRole/apptest-9eyndrif:apptest-9eyndrif:controller.serviceAccount-r0'
INFO Application 'apptest-9eyndrif' does not own cluster-scoped 'ClusterRoleBinding/apptest-9eyndrif:apptest-9eyndrif:controller.serviceAccount-rb0'
INFO Application 'apptest-9eyndrif' owns 'ServiceAccount/apptest-9eyndrif-deployer-sa'
INFO Application 'apptest-9eyndrif' owns 'Secret/apptest-9eyndrif-deployer-config'
INFO Application 'apptest-9eyndrif' owns 'Job/apptest-9eyndrif-deployer'
INFO Application 'apptest-9eyndrif' owns 'RoleBinding/apptest-9eyndrif-deployer-rb'
INFO Application 'apptest-9eyndrif' does not own cluster-scoped 'ClusterRole/apptest-9eyndrif:apptest-9eyndrif:deployer-cr0'
INFO Application 'apptest-9eyndrif' does not own cluster-scoped 'ClusterRoleBinding/apptest-9eyndrif:apptest-9eyndrif:deployer-crb0'
INFO: Applying the following manifests:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app.kubernetes.io/component: auto-provisioned.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    marketplace.cloud.google.com/auto-provisioned-for-property: controller.serviceAccount
  name: apptest-9eyndrif-controller-serviceaccount
  namespace: apptest-9eyndrif
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-9eyndrif
    uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/component: auto-provisioned.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    app.kubernetes.io/namespace: apptest-9eyndrif
    marketplace.cloud.google.com/auto-provisioned-for-property: controller.serviceAccount
  name: apptest-9eyndrif:apptest-9eyndrif:controller.serviceAccount-r0
rules:
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  verbs:
  - '*'
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - clusterrolebindings
  - roles
  - rolebindings
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ''
  resources:
  - services
  - configmaps
  - secrets
  - serviceaccounts
  - persistentvolumeclaims
  - pods
  - namespaces
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - apps
  resources:
  - deployments
  - statefulsets
  - replicasets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - batch
  resources:
  - jobs
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  - networkpolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - policy
  resources:
  - podsecuritypolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
  - use
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - cert-manager.io
  resources:
  - certificates
  - issuers
  - clusterissuers
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - gateway.networking.k8s.io
  resources:
  - httproutes
  - gateways
  - gatewayclasses
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - gateway.networking.k8s.io
  resources:
  - gateways/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apis
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - apis/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apis/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - authentications
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - authentications/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - authentications/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backends
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - backends/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backends/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apipolicies
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - apipolicies/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apipolicies/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - interceptorservices
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - interceptorservices/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - interceptorservices/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - scopes
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - scopes/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - scopes/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - ratelimitpolicies
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - ratelimitpolicies/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - ratelimitpolicies/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - update
  - patch
  - create
  - delete
- apiGroups:
  - dp.wso2.com
  resources:
  - tokenissuers
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - tokenissuers/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - tokenissuers/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backendjwts
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - backendjwts/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backendjwts/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - gqlroutes
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - gqlroutes/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - gqlroutes/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - aiproviders
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - aiproviders/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - aiproviders/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - airatelimitpolicies
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - airatelimitpolicies/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - airatelimitpolicies/status
  verbs:
  - get
  - patch
  - update
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/component: auto-provisioned.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    marketplace.cloud.google.com/auto-provisioned-for-property: controller.serviceAccount
  name: apptest-9eyndrif:apptest-9eyndrif:controller.serviceAccount-rb0
  namespace: apptest-9eyndrif
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: apptest-9eyndrif:apptest-9eyndrif:controller.serviceAccount-r0
subjects:
- kind: ServiceAccount
  name: apptest-9eyndrif-controller-serviceaccount
  namespace: apptest-9eyndrif
---
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app.kubernetes.io/component: deployer.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-9eyndrif-deployer-sa
  namespace: apptest-9eyndrif
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-9eyndrif
    uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    app.kubernetes.io/component: deployer.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-9eyndrif-deployer-config
  namespace: apptest-9eyndrif
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-9eyndrif
    uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
stringData:
  values.yaml: '__image_repo_prefix__: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace

    controller.serviceAccount: apptest-9eyndrif-controller-serviceaccount

    name: apptest-9eyndrif

    namespace: apptest-9eyndrif

    '
type: Opaque
---
apiVersion: batch/v1
kind: Job
metadata:
  labels:
    app.kubernetes.io/component: deployer.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    marketplace.cloud.google.com/deployer: Main
  name: apptest-9eyndrif-deployer
  namespace: apptest-9eyndrif
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-9eyndrif
    uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
spec:
  backoffLimit: 0
  template:
    metadata:
      annotations:
        sidecar.istio.io/inject: 'false'
    spec:
      containers:
      - command:
        - /bin/deploy_with_tests.sh
        image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
        imagePullPolicy: Always
        name: deployer
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
        volumeMounts:
        - mountPath: /data/values.yaml
          name: config-volume
          readOnly: true
          subPath: values.yaml
      restartPolicy: Never
      serviceAccountName: apptest-9eyndrif-deployer-sa
      volumes:
      - name: config-volume
        secret:
          secretName: apptest-9eyndrif-deployer-config
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    app.kubernetes.io/component: deployer-rbac.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-9eyndrif-deployer-rb
  namespace: apptest-9eyndrif
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-9eyndrif
    uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: apptest-9eyndrif-deployer-sa
  namespace: apptest-9eyndrif
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/component: deployer-rbac.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    app.kubernetes.io/namespace: apptest-9eyndrif
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-9eyndrif:apptest-9eyndrif:deployer-cr0
rules:
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  verbs:
  - '*'
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - clusterrolebindings
  - roles
  - rolebindings
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ''
  resources:
  - services
  - configmaps
  - secrets
  - serviceaccounts
  - persistentvolumeclaims
  - pods
  - namespaces
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - apps
  resources:
  - deployments
  - statefulsets
  - replicasets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - batch
  resources:
  - jobs
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  - networkpolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - policy
  resources:
  - podsecuritypolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
  - use
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - cert-manager.io
  resources:
  - certificates
  - issuers
  - clusterissuers
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - update
  - patch
  - create
  - delete
- apiGroups:
  - gateway.networking.k8s.io
  resources:
  - httproutes
  - gateways
  - gatewayclasses
  - grpcroutes
  - httproutes/status
  - gateways/status
  - gatewayclasses/status
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - dp.wso2.com
  resources:
  - '*'
  verbs:
  - '*'
- apiGroups:
  - cp.wso2.com
  resources:
  - '*'
  verbs:
  - '*'
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/component: deployer-rbac.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-9eyndrif
    app.kubernetes.io/namespace: apptest-9eyndrif
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-9eyndrif:apptest-9eyndrif:deployer-crb0
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: apptest-9eyndrif:apptest-9eyndrif:deployer-cr0
subjects:
- kind: ServiceAccount
  name: apptest-9eyndrif-deployer-sa
  namespace: apptest-9eyndrif
Using /opt/kubectl/1.31/kubectl (server=1.32)
serviceaccount/apptest-9eyndrif-controller-serviceaccount created
clusterrole.rbac.authorization.k8s.io/apptest-9eyndrif:apptest-9eyndrif:controller.serviceAccount-r0 created
clusterrolebinding.rbac.authorization.k8s.io/apptest-9eyndrif:apptest-9eyndrif:controller.serviceAccount-rb0 created
serviceaccount/apptest-9eyndrif-deployer-sa configured
secret/apptest-9eyndrif-deployer-config created
job.batch/apptest-9eyndrif-deployer created
rolebinding.rbac.authorization.k8s.io/apptest-9eyndrif-deployer-rb created
clusterrole.rbac.authorization.k8s.io/apptest-9eyndrif:apptest-9eyndrif:deployer-cr0 created
clusterrolebinding.rbac.authorization.k8s.io/apptest-9eyndrif:apptest-9eyndrif:deployer-crb0 created
INFO wait for the deployer to succeed
Using /opt/kubectl/1.31/kubectl (server=1.32)
Elapsed 4sUsing /opt/kubectl/1.31/kubectl (server=1.32)
Elapsed 11sUsing /opt/kubectl/1.31/kubectl (server=1.32)
Elapsed 19sUsing /opt/kubectl/1.31/kubectl (server=1.32)
Elapsed 27sUsing /opt/kubectl/1.31/kubectl (server=1.32)
Elapsed 35sUsing /opt/kubectl/1.31/kubectl (server=1.32)
ERROR Deployer failed
INFO cleaning all resources.
INFO Collecting events for namespace "apptest-9eyndrif"
Using /opt/kubectl/1.31/kubectl (server=1.32)
LAST SEEN   TYPE      REASON                   OBJECT                                                                        MESSAGE
14s         Normal    Scheduled                pod/apkagent-bdb54d4f9-sx2cs                                                  Successfully assigned apptest-9eyndrif/apkagent-bdb54d4f9-sx2cs to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
7s          Warning   FailedMount              pod/apkagent-bdb54d4f9-sx2cs                                                  MountVolume.SetUp failed for volume "apk-agent-certificates" : secret "apk-agent-server-cert" not found
15s         Normal    SuccessfulCreate         replicaset/apkagent-bdb54d4f9                                                 Created pod: apkagent-bdb54d4f9-sx2cs
15s         Normal    ScalingReplicaSet        deployment/apkagent                                                           Scaled up replica set apkagent-bdb54d4f9 from 0 to 1
15s         Normal    Scheduled                pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Successfully assigned apptest-9eyndrif/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7 to gke-wso2-apim-gke-test-cpu-pool-583b68cf-21fl
15s         Normal    Pulling                  pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5"
15s         Normal    Pulled                   pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5" in 469ms (469ms including waiting). Image size: 1220921489 bytes.
15s         Normal    Created                  pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Created container: wso2am-control-plane
15s         Normal    Started                  pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Started container wso2am-control-plane
16s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-acp-deployment-1-69d5775498                       Created pod: apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7
16s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-acp-deployment-1                                  Scaled up replica set apptest-9eyndrif-acp-deployment-1-69d5775498 from 0 to 1
21s         Normal    NoPods                   poddisruptionbudget/apptest-9eyndrif-acp-pdb                                  No matching pods found
47s         Normal    Scheduled                pod/apptest-9eyndrif-deployer-fs226                                           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-deployer-fs226 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
47s         Normal    Pulling                  pod/apptest-9eyndrif-deployer-fs226                                           Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5"
46s         Normal    Pulled                   pod/apptest-9eyndrif-deployer-fs226                                           Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5" in 1.521s (1.521s including waiting). Image size: 130478503 bytes.
46s         Normal    Created                  pod/apptest-9eyndrif-deployer-fs226                                           Created container: deployer
46s         Normal    Started                  pod/apptest-9eyndrif-deployer-fs226                                           Started container deployer
48s         Normal    SuccessfulCreate         job/apptest-9eyndrif-deployer                                                 Created pod: apptest-9eyndrif-deployer-fs226
10s         Warning   BackoffLimitExceeded     job/apptest-9eyndrif-deployer                                                 Job has reached the specified backoff limit
15s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8             Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
8s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8             MountVolume.SetUp failed for volume "adapter-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-adapter-server-cert" not found
8s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8             MountVolume.SetUp failed for volume "enforcer-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-enforcer-server-cert" not found
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5            Created pod: apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8
16s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-adapter-deployment                       Scaled up replica set apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5 from 0 to 1
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c   Created pod: apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s
14s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "sts-shared-auth-key" : failed to sync secret cache: timed out waiting for the condition
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "log-conf-volume" : failed to sync configmap cache: timed out waiting for the condition
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : failed to sync secret cache: timed out waiting for the condition
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : secret "apptest-9eyndrif-wso2-apk-webhook-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-common-controller-server-cert" not found
15s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-common-controller-deployment             Scaled up replica set apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c from 0 to 1
15s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
8s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4           MountVolume.SetUp failed for volume "config-ds-tls-volume" : secret "apptest-9eyndrif-wso2-apk-config-ds-server-cert" not found
16s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798          Created pod: apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4
16s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-config-ds-deployment                     Scaled up replica set apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798 from 0 to 1
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649    Created pod: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw
14s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "router-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-gateway-server-cert" not found
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "adapter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-adapter-server-cert" not found
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "enforcer-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-enforcer-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "enforcer-health-check-volume" : failed to sync configmap cache: timed out waiting for the condition
15s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment               Scaled up replica set apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649 from 0 to 1
16s         Normal    EnsuringLoadBalancer     service/apptest-9eyndrif-wso2-apk-gateway-service                             Ensuring load balancer
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc        Created pod: apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd
14s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           MountVolume.SetUp failed for volume "router-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-gateway-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           MountVolume.SetUp failed for volume "ratelimiter-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           MountVolume.SetUp failed for volume "common-controller-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-common-controller-server-cert" not found
15s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-ratelimiter-deployment                   Scaled up replica set apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc from 0 to 1
15s         Normal    WaitForFirstConsumer     persistentvolumeclaim/redis-data-redis-master-0                               waiting for first consumer to be created before binding
14s         Normal    Provisioning             persistentvolumeclaim/redis-data-redis-master-0                               External provisioner is provisioning volume for claim "apptest-9eyndrif/redis-data-redis-master-0"
14s         Normal    ExternalProvisioning     persistentvolumeclaim/redis-data-redis-master-0                               Waiting for a volume to be created either by the external provisioner 'pd.csi.storage.gke.io' or manually by the system administrator. If volume creation is delayed, please verify that the provisioner is running and correctly registered.
11s         Normal    ProvisioningSucceeded    persistentvolumeclaim/redis-data-redis-master-0                               Successfully provisioned volume pvc-46a6442a-a3e6-4d8d-b913-b4007da26d54
9s          Normal    Scheduled                pod/redis-master-0                                                            Successfully assigned apptest-9eyndrif/redis-master-0 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
3s          Normal    SuccessfulAttachVolume   pod/redis-master-0                                                            AttachVolume.Attach succeeded for volume "pvc-46a6442a-a3e6-4d8d-b913-b4007da26d54"
20s         Normal    NoPods                   poddisruptionbudget/redis-master                                              No matching pods found
15s         Normal    SuccessfulCreate         statefulset/redis-master                                                      create Claim redis-data-redis-master-0 Pod redis-master-0 in StatefulSet redis-master success
14s         Normal    SuccessfulCreate         statefulset/redis-master                                                      create Pod redis-master-0 in StatefulSet redis-master successful
LAST SEEN   TYPE      REASON                   OBJECT                                                                        MESSAGE
14s         Normal    Scheduled                pod/apkagent-bdb54d4f9-sx2cs                                                  Successfully assigned apptest-9eyndrif/apkagent-bdb54d4f9-sx2cs to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
7s          Warning   FailedMount              pod/apkagent-bdb54d4f9-sx2cs                                                  MountVolume.SetUp failed for volume "apk-agent-certificates" : secret "apk-agent-server-cert" not found
15s         Normal    SuccessfulCreate         replicaset/apkagent-bdb54d4f9                                                 Created pod: apkagent-bdb54d4f9-sx2cs
15s         Normal    ScalingReplicaSet        deployment/apkagent                                                           Scaled up replica set apkagent-bdb54d4f9 from 0 to 1
15s         Normal    Scheduled                pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Successfully assigned apptest-9eyndrif/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7 to gke-wso2-apim-gke-test-cpu-pool-583b68cf-21fl
15s         Normal    Pulling                  pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5"
15s         Normal    Pulled                   pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5" in 469ms (469ms including waiting). Image size: 1220921489 bytes.
15s         Normal    Created                  pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Created container: wso2am-control-plane
15s         Normal    Started                  pod/apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7                        Started container wso2am-control-plane
16s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-acp-deployment-1-69d5775498                       Created pod: apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7
16s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-acp-deployment-1                                  Scaled up replica set apptest-9eyndrif-acp-deployment-1-69d5775498 from 0 to 1
21s         Normal    NoPods                   poddisruptionbudget/apptest-9eyndrif-acp-pdb                                  No matching pods found
47s         Normal    Scheduled                pod/apptest-9eyndrif-deployer-fs226                                           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-deployer-fs226 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
47s         Normal    Pulling                  pod/apptest-9eyndrif-deployer-fs226                                           Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5"
46s         Normal    Pulled                   pod/apptest-9eyndrif-deployer-fs226                                           Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5" in 1.521s (1.521s including waiting). Image size: 130478503 bytes.
46s         Normal    Created                  pod/apptest-9eyndrif-deployer-fs226                                           Created container: deployer
46s         Normal    Started                  pod/apptest-9eyndrif-deployer-fs226                                           Started container deployer
48s         Normal    SuccessfulCreate         job/apptest-9eyndrif-deployer                                                 Created pod: apptest-9eyndrif-deployer-fs226
10s         Warning   BackoffLimitExceeded     job/apptest-9eyndrif-deployer                                                 Job has reached the specified backoff limit
15s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8             Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
8s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8             MountVolume.SetUp failed for volume "adapter-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-adapter-server-cert" not found
8s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8             MountVolume.SetUp failed for volume "enforcer-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-enforcer-server-cert" not found
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5            Created pod: apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8
16s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-adapter-deployment                       Scaled up replica set apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5 from 0 to 1
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c   Created pod: apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s
14s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "sts-shared-auth-key" : failed to sync secret cache: timed out waiting for the condition
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "log-conf-volume" : failed to sync configmap cache: timed out waiting for the condition
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : failed to sync secret cache: timed out waiting for the condition
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : secret "apptest-9eyndrif-wso2-apk-webhook-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s           MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-common-controller-server-cert" not found
15s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-common-controller-deployment             Scaled up replica set apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c from 0 to 1
15s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
8s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4           MountVolume.SetUp failed for volume "config-ds-tls-volume" : secret "apptest-9eyndrif-wso2-apk-config-ds-server-cert" not found
16s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798          Created pod: apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4
16s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-config-ds-deployment                     Scaled up replica set apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798 from 0 to 1
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649    Created pod: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw
14s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "router-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-gateway-server-cert" not found
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "adapter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-adapter-server-cert" not found
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "enforcer-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-enforcer-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
14s         Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw           MountVolume.SetUp failed for volume "enforcer-health-check-volume" : failed to sync configmap cache: timed out waiting for the condition
15s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment               Scaled up replica set apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649 from 0 to 1
16s         Normal    EnsuringLoadBalancer     service/apptest-9eyndrif-wso2-apk-gateway-service                             Ensuring load balancer
15s         Normal    SuccessfulCreate         replicaset/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc        Created pod: apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd
14s         Normal    Scheduled                pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           Successfully assigned apptest-9eyndrif/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
7s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           MountVolume.SetUp failed for volume "router-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-gateway-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           MountVolume.SetUp failed for volume "ratelimiter-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
6s          Warning   FailedMount              pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd           MountVolume.SetUp failed for volume "common-controller-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-common-controller-server-cert" not found
15s         Normal    ScalingReplicaSet        deployment/apptest-9eyndrif-wso2-apk-ratelimiter-deployment                   Scaled up replica set apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc from 0 to 1
15s         Normal    WaitForFirstConsumer     persistentvolumeclaim/redis-data-redis-master-0                               waiting for first consumer to be created before binding
14s         Normal    Provisioning             persistentvolumeclaim/redis-data-redis-master-0                               External provisioner is provisioning volume for claim "apptest-9eyndrif/redis-data-redis-master-0"
14s         Normal    ExternalProvisioning     persistentvolumeclaim/redis-data-redis-master-0                               Waiting for a volume to be created either by the external provisioner 'pd.csi.storage.gke.io' or manually by the system administrator. If volume creation is delayed, please verify that the provisioner is running and correctly registered.
11s         Normal    ProvisioningSucceeded    persistentvolumeclaim/redis-data-redis-master-0                               Successfully provisioned volume pvc-46a6442a-a3e6-4d8d-b913-b4007da26d54
9s          Normal    Scheduled                pod/redis-master-0                                                            Successfully assigned apptest-9eyndrif/redis-master-0 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
3s          Normal    SuccessfulAttachVolume   pod/redis-master-0                                                            AttachVolume.Attach succeeded for volume "pvc-46a6442a-a3e6-4d8d-b913-b4007da26d54"
20s         Normal    NoPods                   poddisruptionbudget/redis-master                                              No matching pods found
15s         Normal    SuccessfulCreate         statefulset/redis-master                                                      create Claim redis-data-redis-master-0 Pod redis-master-0 in StatefulSet redis-master success
14s         Normal    SuccessfulCreate         statefulset/redis-master                                                      create Pod redis-master-0 in StatefulSet redis-master successful
Using /opt/kubectl/1.31/kubectl (server=1.32)
INFO Collecting logs for deployer
Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + trap handle_failure EXIT
DEPLOYER + test_schema=/data-test/schema.yaml
DEPLOYER + overlay_test_schema.py --test_schema /data-test/schema.yaml --original_schema /data/schema.yaml --output /data/schema.yaml
DEPLOYER + awk '{print "SMOKE_TEST "$0}'
DEPLOYER ++ /bin/print_config.py --xtype NAME --values_mode raw
DEPLOYER + NAME=apptest-9eyndrif
DEPLOYER ++ /bin/print_config.py --xtype NAMESPACE --values_mode raw
DEPLOYER Deploying application "apptest-9eyndrif" in test mode
DEPLOYER + NAMESPACE=apptest-9eyndrif
DEPLOYER + export NAME
DEPLOYER + export NAMESPACE
DEPLOYER + echo 'Deploying application "apptest-9eyndrif" in test mode'
DEPLOYER ++ kubectl get applications.app.k8s.io/apptest-9eyndrif --namespace=apptest-9eyndrif '--output=jsonpath={.metadata.uid}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + app_uid=2221911f-59d8-47f1-9f44-962d1d6fc80f
DEPLOYER ++ kubectl get applications.app.k8s.io/apptest-9eyndrif --namespace=apptest-9eyndrif '--output=jsonpath={.apiVersion}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + app_api_version=app.k8s.io/v1beta1
DEPLOYER ++ kubectl get namespaces/apptest-9eyndrif '--output=jsonpath={.metadata.uid}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + namespace_uid=d71c8bb6-5403-4610-9544-3b0186e461da
DEPLOYER + /bin/expand_config.py --values_mode raw --app_uid 2221911f-59d8-47f1-9f44-962d1d6fc80f
DEPLOYER + create_manifests.sh --mode=test
DEPLOYER + for i in "$@"
DEPLOYER + case $i in
DEPLOYER + mode=test
DEPLOYER + shift
DEPLOYER + [[ -z apptest-9eyndrif ]]
DEPLOYER + [[ -z apptest-9eyndrif ]]
DEPLOYER + echo 'Creating the manifests for the kubernetes resources that build the application "apptest-9eyndrif"'
DEPLOYER + data_dir=/data
DEPLOYER + manifest_dir=/data/manifest-expanded
DEPLOYER + mkdir -p /data/manifest-expanded
DEPLOYER Creating the manifests for the kubernetes resources that build the application "apptest-9eyndrif"
DEPLOYER + [[ test = \t\e\s\t ]]
DEPLOYER + test_data_dir=/data-test
DEPLOYER + mkdir -p /data-test
DEPLOYER + extract_manifest /data
DEPLOYER + data=/data
DEPLOYER + extracted=/data/extracted
DEPLOYER + data_chart=/data/chart
DEPLOYER + mkdir -p /data/extracted
DEPLOYER + [[ -d /data/chart ]]
DEPLOYER ++ find /data/chart -maxdepth 1 -type f -name '*.tar.gz'
DEPLOYER + for chart in $(find "$data_chart" -maxdepth 1 -type f -name "*.tar.gz")
DEPLOYER ++ basename /data/chart/chart.tar.gz
DEPLOYER ++ sed 's/.tar.gz$//'
DEPLOYER + chart_manifest_file=chart
DEPLOYER + mkdir /data/extracted/chart
DEPLOYER + tar xfC /data/chart/chart.tar.gz /data/extracted/chart
DEPLOYER + [[ test = \t\e\s\t ]]
DEPLOYER + extract_manifest /data-test
DEPLOYER + data=/data-test
DEPLOYER + extracted=/data-test/extracted
DEPLOYER + data_chart=/data-test/chart
DEPLOYER + mkdir -p /data-test/extracted
DEPLOYER + [[ -d /data-test/chart ]]
DEPLOYER ++ find /data-test/chart -maxdepth 1 -type f -name '*.tar.gz'
DEPLOYER + [[ ! -e /data/extracted ]]
DEPLOYER + overlay_test_files.py --manifest /data/extracted --test_manifest /data-test/extracted
DEPLOYER + awk '{print "SMOKE_TEST "$0}'
DEPLOYER + echo '=== values.yaml ==='
DEPLOYER + /bin/print_config.py --output=yaml
DEPLOYER === values.yaml ===
DEPLOYER adapterImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5.0
DEPLOYER apimApkAgentImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5.0
DEPLOYER commonControllerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5.0
DEPLOYER configDeployerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5.0
DEPLOYER controller:
DEPLOYER   serviceAccount: apptest-9eyndrif-controller-serviceaccount
DEPLOYER enforcerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5.0
DEPLOYER name: apptest-9eyndrif
DEPLOYER namespace: apptest-9eyndrif
DEPLOYER ratelimiterImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5.0
DEPLOYER routerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5.0
DEPLOYER wso2amAcpImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5.0
DEPLOYER ===================
DEPLOYER + echo ===================
DEPLOYER + for chart in "$data_dir/extracted"/*
DEPLOYER ++ basename /data/extracted/chart
DEPLOYER ++ sed 's/.tar.gz$//'
DEPLOYER + chart_manifest_file=chart.yaml
DEPLOYER + helm template apptest-9eyndrif /data/extracted/chart/chart --namespace=apptest-9eyndrif --values=/dev/fd/63
DEPLOYER ++ /bin/print_config.py --output=yaml
DEPLOYER coalesce.go:298: warning: cannot overwrite table with non table for wso2-apim.acp.wso2.deployment.image (map[digest: imagePullPolicy:Always registry: repository:])
DEPLOYER coalesce.go:298: warning: cannot overwrite table with non table for wso2-apim.acp.wso2.deployment.image (map[digest: imagePullPolicy:Always registry: repository:])
DEPLOYER coalesce.go:298: warning: cannot overwrite table with non table for wso2-apim.acp.wso2.deployment.image (map[digest: imagePullPolicy:Always registry: repository:])
DEPLOYER + [[ test != \t\e\s\t ]]
DEPLOYER + process_helm_hooks.py --deploy_tests --manifest /data/manifest-expanded/chart.yaml
DEPLOYER INFO Reading /data/manifest-expanded/chart.yaml
DEPLOYER + ensure_k8s_apps_labels.py --manifest /data/manifest-expanded/chart.yaml --appname apptest-9eyndrif
DEPLOYER INFO Reading /data/manifest-expanded/chart.yaml
DEPLOYER + /bin/set_ownership.py --app_name apptest-9eyndrif --app_uid 2221911f-59d8-47f1-9f44-962d1d6fc80f --app_api_version app.k8s.io/v1beta1 --namespace apptest-9eyndrif --namespace_uid d71c8bb6-5403-4610-9544-3b0186e461da --manifests /data/manifest-expanded --dest /data/resources.yaml
DEPLOYER INFO Reading /data/manifest-expanded/chart.yaml
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apk-root-certificate'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apptest-9eyndrif-wso2-apk-adapter-truststore-consul-secret'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apptest-9eyndrif-wso2-apk-sts-shared-auth-key'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apptest-9eyndrif-wso2-apk-enforcer-keystore-secret'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apptest-9eyndrif-wso2-apk-enforcer-truststore-secret'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apptest-9eyndrif-wso2-apk-token'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apim-apk-issuer-cert'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/apk-agent-root-certificate'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Secret/agent-account-secret-token'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-acp-conf-1'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-acp-conf-entrypoint'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-acp-conf-log4j2'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-acp-conf-admin-settings'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-acp-conf-devportal-settings'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-acp-conf-publisher-settings'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/redis-configuration'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/redis-health'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/redis-scripts'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-config-ds-configmap'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-wso2-apk-config-deployer-api-definition'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-wso2-apk-config-generator-api-definition'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-adapter-grpc-probe-script-conf'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-notification-api-definition'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-common-controller-grpc-probe-script-conf'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-common-log-conf'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-enforcer-grpc-probe-script-conf'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-wso2-apk-log-conf'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'ConfigMap/apptest-9eyndrif-log-conf'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/aiproviders.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/airatelimitpolicies.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/apipolicies.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/apis.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/authentications.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/backendjwts.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/backends.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/gqlroutes.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/interceptorservices.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/ratelimitpolicies.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/scopes.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/tokenissuers.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/aiproviders.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/airatelimitpolicies.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/apipolicies.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/apis.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/authentications.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/backendjwts.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/backends.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/gqlroutes.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/interceptorservices.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/ratelimitpolicies.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/scopes.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'CustomResourceDefinition/tokenissuers.dp.wso2.com'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'ClusterRole/wso2apk-role'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'ClusterRole/wso2agent-role'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'ClusterRoleBinding/apptest-9eyndrif-wso2-apk-role-binding'
DEPLOYER INFO Namespace 'apptest-9eyndrif' owns 'ClusterRoleBinding/agent-cluster-role-binding'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-acp-1-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-acp-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/redis-headless'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/redis-master'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-wso2-apk-config-ds-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-wso2-apk-adapter-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-wso2-apk-common-controller-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-wso2-apk-enforcer-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-wso2-apk-gateway-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apptest-9eyndrif-wso2-apk-ratelimiter-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Service/apim-apk-agent-service'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Deployment/apptest-9eyndrif-acp-deployment-1'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Deployment/apptest-9eyndrif-wso2-apk-config-ds-deployment'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Deployment/apptest-9eyndrif-wso2-apk-adapter-deployment'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Deployment/apptest-9eyndrif-wso2-apk-common-controller-deployment'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Deployment/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Deployment/apptest-9eyndrif-wso2-apk-ratelimiter-deployment'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'Deployment/apkagent'
DEPLOYER INFO Application 'apptest-9eyndrif' owns 'StatefulSet/redis-master'
DEPLOYER + validate_app_resource.py --manifests /data/resources.yaml
DEPLOYER INFO Reading /data/resources.yaml
DEPLOYER + separate_tester_resources.py --app_uid 2221911f-59d8-47f1-9f44-962d1d6fc80f --app_name apptest-9eyndrif --app_api_version app.k8s.io/v1beta1 --manifests /data/resources.yaml --out_manifests /data/resources.yaml --out_test_manifests /data/tester.yaml
DEPLOYER INFO Reading /data/resources.yaml
DEPLOYER INFO Prod resource: NetworkPolicy/redis
DEPLOYER INFO Prod resource: PodDisruptionBudget/apptest-9eyndrif-acp-pdb
DEPLOYER INFO Prod resource: PodDisruptionBudget/redis-master
DEPLOYER INFO Prod resource: ServiceAccount/redis-master
DEPLOYER INFO Prod resource: ServiceAccount/wso2apk-platform
DEPLOYER INFO Prod resource: ServiceAccount/wso2agent-platform
DEPLOYER INFO Prod resource: Secret/apk-root-certificate
DEPLOYER INFO Prod resource: Secret/apptest-9eyndrif-wso2-apk-adapter-truststore-consul-secret
DEPLOYER INFO Prod resource: Secret/apptest-9eyndrif-wso2-apk-sts-shared-auth-key
DEPLOYER INFO Prod resource: Secret/apptest-9eyndrif-wso2-apk-enforcer-keystore-secret
DEPLOYER INFO Prod resource: Secret/apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
DEPLOYER INFO Prod resource: Secret/apptest-9eyndrif-wso2-apk-token
DEPLOYER INFO Prod resource: Secret/apim-apk-issuer-cert
DEPLOYER INFO Prod resource: Secret/apk-agent-root-certificate
DEPLOYER INFO Prod resource: Secret/agent-account-secret-token
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-acp-conf-1
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-acp-conf-entrypoint
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-acp-conf-log4j2
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-acp-conf-admin-settings
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-acp-conf-devportal-settings
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-acp-conf-publisher-settings
DEPLOYER INFO Prod resource: ConfigMap/redis-configuration
DEPLOYER INFO Prod resource: ConfigMap/redis-health
DEPLOYER INFO Prod resource: ConfigMap/redis-scripts
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-config-ds-configmap
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-wso2-apk-config-deployer-api-definition
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-wso2-apk-config-generator-api-definition
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-adapter-grpc-probe-script-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-notification-api-definition
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-common-controller-grpc-probe-script-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-common-log-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-enforcer-grpc-probe-script-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-wso2-apk-log-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-9eyndrif-log-conf
DEPLOYER INFO Prod resource: CustomResourceDefinition/aiproviders.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/airatelimitpolicies.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/apipolicies.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/apis.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/authentications.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/backendjwts.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/backends.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/gqlroutes.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/interceptorservices.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/ratelimitpolicies.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/scopes.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/tokenissuers.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/aiproviders.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/airatelimitpolicies.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/apipolicies.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/apis.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/authentications.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/backendjwts.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/backends.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/gqlroutes.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/interceptorservices.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/ratelimitpolicies.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/scopes.dp.wso2.com
DEPLOYER INFO Prod resource: CustomResourceDefinition/tokenissuers.dp.wso2.com
DEPLOYER INFO Prod resource: ClusterRole/wso2apk-role
DEPLOYER INFO Prod resource: ClusterRole/wso2agent-role
DEPLOYER INFO Prod resource: ClusterRoleBinding/apptest-9eyndrif-wso2-apk-role-binding
DEPLOYER INFO Prod resource: ClusterRoleBinding/agent-cluster-role-binding
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-acp-1-service
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-acp-service
DEPLOYER INFO Prod resource: Service/redis-headless
DEPLOYER INFO Prod resource: Service/redis-master
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-wso2-apk-config-ds-service
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-wso2-apk-adapter-service
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-wso2-apk-common-controller-service
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-wso2-apk-enforcer-service
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-wso2-apk-gateway-service
DEPLOYER INFO Prod resource: Service/apptest-9eyndrif-wso2-apk-ratelimiter-service
DEPLOYER INFO Prod resource: Service/apim-apk-agent-service
DEPLOYER INFO Prod resource: Deployment/apptest-9eyndrif-acp-deployment-1
DEPLOYER INFO Prod resource: Deployment/apptest-9eyndrif-wso2-apk-config-ds-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-9eyndrif-wso2-apk-adapter-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-9eyndrif-wso2-apk-common-controller-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-9eyndrif-wso2-apk-ratelimiter-deployment
DEPLOYER INFO Prod resource: Deployment/apkagent
DEPLOYER INFO Prod resource: StatefulSet/redis-master
DEPLOYER INFO Prod resource: Ingress/apptest-9eyndrif-acp-ingress
DEPLOYER INFO Prod resource: AIProvider/ai-provider-azure-ai
DEPLOYER INFO Prod resource: AIProvider/ai-provider-mistral-ai
DEPLOYER INFO Prod resource: AIProvider/ai-provider-open-ai
DEPLOYER INFO Prod resource: API/apptest-9eyndrif-wso2-apk-wso2-apk-config-deployer-api
DEPLOYER INFO Prod resource: API/apptest-9eyndrif-wso2-apk-wso2-apk-config-generator-api
DEPLOYER INFO Prod resource: API/apptest-9eyndrif-wso2-apk-wso2-apk-notification-api
DEPLOYER INFO Prod resource: APIPolicy/apptest-9eyndrif-wso2-apk-config-api-api-policy
DEPLOYER INFO Prod resource: Application/apptest-9eyndrif
DEPLOYER INFO Prod resource: Authentication/apptest-9eyndrif-wso2-apk-configurator-api-no-authentication-policy
DEPLOYER INFO Prod resource: Authentication/apptest-9eyndrif-wso2-apk-notification-api-no-authentication-policy
DEPLOYER INFO Prod resource: Backend/apptest-9eyndrif-wso2-apk-config-deployer-ds-backend
DEPLOYER INFO Prod resource: Backend/apptest-9eyndrif-wso2-apk-config-generator-backend
DEPLOYER INFO Prod resource: Backend/apptest-9eyndrif-wso2-apk-notification-api-backend
DEPLOYER INFO Prod resource: BackendJWT/apptest-9eyndrif-wso2-apk-config-api-backendjwt
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-adapter-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-common-controller-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-config-ds-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-enforcer-server-cert
DEPLOYER INFO Prod resource: Certificate/envoy-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-gateway-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-gw-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-idp-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-localhost-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-runtime-ds-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-system-api-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-9eyndrif-wso2-apk-webhook-server-cert
DEPLOYER INFO Prod resource: Certificate/apim-apk-agent-server-cert
DEPLOYER INFO Prod resource: ClusterIssuer/apptest-9eyndrif-wso2-apk-selfsigned-issuer
DEPLOYER INFO Prod resource: ClusterIssuer/apk-agent-selfsigned-issuer
DEPLOYER INFO Prod resource: Gateway/wso2-apk-default
DEPLOYER INFO Prod resource: GatewayClass/wso2-apk-default
DEPLOYER INFO Prod resource: HTTPRoute/apptest-9eyndrif-wso2-apk-config-api-route
DEPLOYER INFO Prod resource: HTTPRoute/apptest-9eyndrif-wso2-apk-config-deploy-api-route
DEPLOYER INFO Prod resource: HTTPRoute/apptest-9eyndrif-wso2-apk-notification-api-route
DEPLOYER INFO Prod resource: Scope/apptest-9eyndrif-wso2-apk-api-create-scope
DEPLOYER INFO Prod resource: TokenIssuer/apptest-9eyndrif-wso2-apk-default-jwt-issuer
DEPLOYER INFO Prod resource: TokenIssuer/apptest-9eyndrif-wso2-apk-idp-jwt-issuer
DEPLOYER + kubectl apply --namespace=apptest-9eyndrif --filename=/data/resources.yaml
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER networkpolicy.networking.k8s.io/redis created
DEPLOYER poddisruptionbudget.policy/apptest-9eyndrif-acp-pdb created
DEPLOYER poddisruptionbudget.policy/redis-master created
DEPLOYER serviceaccount/redis-master created
DEPLOYER serviceaccount/wso2apk-platform created
DEPLOYER serviceaccount/wso2agent-platform created
DEPLOYER secret/apk-root-certificate created
DEPLOYER secret/apptest-9eyndrif-wso2-apk-adapter-truststore-consul-secret created
DEPLOYER secret/apptest-9eyndrif-wso2-apk-sts-shared-auth-key created
DEPLOYER secret/apptest-9eyndrif-wso2-apk-enforcer-keystore-secret created
DEPLOYER secret/apptest-9eyndrif-wso2-apk-enforcer-truststore-secret created
DEPLOYER secret/apptest-9eyndrif-wso2-apk-token created
DEPLOYER secret/apim-apk-issuer-cert created
DEPLOYER secret/apk-agent-root-certificate created
DEPLOYER secret/agent-account-secret-token created
DEPLOYER configmap/apptest-9eyndrif-acp-conf-1 created
DEPLOYER configmap/apptest-9eyndrif-acp-conf-entrypoint created
DEPLOYER configmap/apptest-9eyndrif-acp-conf-log4j2 created
DEPLOYER configmap/apptest-9eyndrif-acp-conf-admin-settings created
DEPLOYER configmap/apptest-9eyndrif-acp-conf-devportal-settings created
DEPLOYER configmap/apptest-9eyndrif-acp-conf-publisher-settings created
DEPLOYER configmap/redis-configuration created
DEPLOYER configmap/redis-health created
DEPLOYER configmap/redis-scripts created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-config-ds-configmap created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-wso2-apk-config-deployer-api-definition created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-wso2-apk-config-generator-api-definition created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-adapter-grpc-probe-script-conf created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-notification-api-definition created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-common-controller-grpc-probe-script-conf created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-common-log-conf created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-enforcer-grpc-probe-script-conf created
DEPLOYER configmap/apptest-9eyndrif-wso2-apk-log-conf created
DEPLOYER configmap/apptest-9eyndrif-log-conf created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/aiproviders.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/airatelimitpolicies.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/apipolicies.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/apis.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/authentications.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/backendjwts.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/backends.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/gqlroutes.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/interceptorservices.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/ratelimitpolicies.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/scopes.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/tokenissuers.dp.wso2.com created
DEPLOYER customresourcedefinition.apiextensions.k8s.io/aiproviders.dp.wso2.com unchanged
DEPLOYER customresourcedefinition.apiextensions.k8s.io/airatelimitpolicies.dp.wso2.com unchanged
DEPLOYER customresourcedefinition.apiextensions.k8s.io/apipolicies.dp.wso2.com unchanged
DEPLOYER customresourcedefinition.apiextensions.k8s.io/apis.dp.wso2.com unchanged
DEPLOYER customresourcedefinition.apiextensions.k8s.io/authentications.dp.wso2.com unchanged
DEPLOYER customresourcedefinition.apiextensions.k8s.io/backendjwts.dp.wso2.com configured
DEPLOYER customresourcedefinition.apiextensions.k8s.io/backends.dp.wso2.com unchanged
DEPLOYER customresourcedefinition.apiextensions.k8s.io/gqlroutes.dp.wso2.com configured
DEPLOYER customresourcedefinition.apiextensions.k8s.io/interceptorservices.dp.wso2.com configured
DEPLOYER customresourcedefinition.apiextensions.k8s.io/ratelimitpolicies.dp.wso2.com unchanged
DEPLOYER customresourcedefinition.apiextensions.k8s.io/scopes.dp.wso2.com configured
DEPLOYER customresourcedefinition.apiextensions.k8s.io/tokenissuers.dp.wso2.com configured
DEPLOYER clusterrole.rbac.authorization.k8s.io/wso2apk-role created
DEPLOYER clusterrole.rbac.authorization.k8s.io/wso2agent-role created
DEPLOYER clusterrolebinding.rbac.authorization.k8s.io/apptest-9eyndrif-wso2-apk-role-binding created
DEPLOYER clusterrolebinding.rbac.authorization.k8s.io/agent-cluster-role-binding created
DEPLOYER service/apptest-9eyndrif-acp-1-service created
DEPLOYER service/apptest-9eyndrif-acp-service created
DEPLOYER service/redis-headless created
DEPLOYER service/redis-master created
DEPLOYER service/apptest-9eyndrif-wso2-apk-config-ds-service created
DEPLOYER service/apptest-9eyndrif-wso2-apk-adapter-service created
DEPLOYER service/apptest-9eyndrif-wso2-apk-common-controller-service created
DEPLOYER service/apptest-9eyndrif-wso2-apk-enforcer-service created
DEPLOYER service/apptest-9eyndrif-wso2-apk-gateway-service created
DEPLOYER service/apptest-9eyndrif-wso2-apk-ratelimiter-service created
DEPLOYER service/apim-apk-agent-service created
DEPLOYER deployment.apps/apptest-9eyndrif-acp-deployment-1 created
DEPLOYER deployment.apps/apptest-9eyndrif-wso2-apk-config-ds-deployment created
DEPLOYER deployment.apps/apptest-9eyndrif-wso2-apk-adapter-deployment created
DEPLOYER deployment.apps/apptest-9eyndrif-wso2-apk-common-controller-deployment created
DEPLOYER deployment.apps/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment created
DEPLOYER deployment.apps/apptest-9eyndrif-wso2-apk-ratelimiter-deployment created
DEPLOYER deployment.apps/apkagent created
DEPLOYER statefulset.apps/redis-master created
DEPLOYER ingress.networking.k8s.io/apptest-9eyndrif-acp-ingress created
DEPLOYER application.app.k8s.io/apptest-9eyndrif configured
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-adapter-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-common-controller-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-config-ds-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-enforcer-server-cert created
DEPLOYER certificate.cert-manager.io/envoy-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-gateway-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-gw-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-idp-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-localhost-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-ratelimiter-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-runtime-ds-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-system-api-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-9eyndrif-wso2-apk-webhook-server-cert created
DEPLOYER certificate.cert-manager.io/apim-apk-agent-server-cert created
DEPLOYER clusterissuer.cert-manager.io/apptest-9eyndrif-wso2-apk-selfsigned-issuer created
DEPLOYER clusterissuer.cert-manager.io/apk-agent-selfsigned-issuer configured
DEPLOYER gateway.gateway.networking.k8s.io/wso2-apk-default created
DEPLOYER gatewayclass.gateway.networking.k8s.io/wso2-apk-default configured
DEPLOYER httproute.gateway.networking.k8s.io/apptest-9eyndrif-wso2-apk-config-api-route created
DEPLOYER httproute.gateway.networking.k8s.io/apptest-9eyndrif-wso2-apk-config-deploy-api-route created
DEPLOYER httproute.gateway.networking.k8s.io/apptest-9eyndrif-wso2-apk-notification-api-route created
DEPLOYER resource mapping not found for name: "ai-provider-azure-ai" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "AIProvider" in version "dp.wso2.com/v1alpha4"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "ai-provider-mistral-ai" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "AIProvider" in version "dp.wso2.com/v1alpha4"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "ai-provider-open-ai" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "AIProvider" in version "dp.wso2.com/v1alpha4"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-wso2-apk-config-deployer-api" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "API" in version "dp.wso2.com/v1alpha3"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-wso2-apk-config-generator-api" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "API" in version "dp.wso2.com/v1alpha3"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-wso2-apk-notification-api" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "API" in version "dp.wso2.com/v1alpha3"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-config-api-api-policy" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "APIPolicy" in version "dp.wso2.com/v1alpha4"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-configurator-api-no-authentication-policy" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "Authentication" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-notification-api-no-authentication-policy" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "Authentication" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-config-deployer-ds-backend" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "Backend" in version "dp.wso2.com/v1alpha1"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-config-generator-backend" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "Backend" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-notification-api-backend" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "Backend" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-config-api-backendjwt" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "BackendJWT" in version "dp.wso2.com/v1alpha1"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-api-create-scope" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "Scope" in version "dp.wso2.com/v1alpha1"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-default-jwt-issuer" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "TokenIssuer" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-9eyndrif-wso2-apk-idp-jwt-issuer" namespace: "apptest-9eyndrif" from "/data/resources.yaml": no matches for kind "TokenIssuer" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER + handle_failure
DEPLOYER + code=1
DEPLOYER + [[ -z apptest-9eyndrif ]]
DEPLOYER + [[ -z apptest-9eyndrif ]]
DEPLOYER + patch_assembly_phase.sh --status=Failed
DEPLOYER + for i in "$@"
DEPLOYER + case $i in
DEPLOYER + status=Failed
DEPLOYER + shift
DEPLOYER + [[ -z Failed ]]
DEPLOYER + [[ Failed =~ ^(Pending|Success|Failed)$ ]]
DEPLOYER Marking deployment of application "apptest-9eyndrif" as "Failed".
DEPLOYER + [[ -z apptest-9eyndrif ]]
DEPLOYER + [[ -z apptest-9eyndrif ]]
DEPLOYER + echo 'Marking deployment of application "apptest-9eyndrif" as "Failed".'
DEPLOYER + [[ Failed == \S\u\c\c\e\s\s ]]
DEPLOYER + kubectl patch applications.app.k8s.io/apptest-9eyndrif --output=json --namespace=apptest-9eyndrif --type=merge --patch '{"spec": {"assemblyPhase": "Failed"}}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER {
DEPLOYER     "apiVersion": "app.k8s.io/v1beta1",
DEPLOYER     "kind": "Application",
DEPLOYER     "metadata": {
DEPLOYER         "annotations": {
DEPLOYER             "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"app.k8s.io/v1beta1\",\"kind\":\"Application\",\"metadata\":{\"annotations\":{\"kubernetes-engine.cloud.google.com/icon\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==\",\"marketplace.cloud.google.com/deploy-info\":\"{\\\"partner_id\\\": \\\"wso2-marketplace-public\\\", \\\"product_id\\\": \\\"wso2-apim-kubernetes\\\", \\\"partner_name\\\": \\\"WSO2\\\"}\"},\"labels\":{\"app.kubernetes.io/name\":\"apptest-9eyndrif\"},\"name\":\"apptest-9eyndrif\",\"namespace\":\"apptest-9eyndrif\"},\"spec\":{\"componentKinds\":[{\"group\":\"apps/v1\",\"kind\":\"Deployment\"},{\"group\":\"apps/v1\",\"kind\":\"StatefulSet\"},{\"group\":\"v1\",\"kind\":\"Service\"},{\"group\":\"v1\",\"kind\":\"ConfigMap\"},{\"group\":\"v1\",\"kind\":\"Secret\"}],\"descriptor\":{\"description\":\"WSO2 API Manager provides a complete platform for building, managing, and scaling APIs.\",\"links\":[{\"description\":\"User Guide: Getting Started\",\"url\":\"https://apim.docs.wso2.com/\"},{\"description\":\"WSO2 API Manager Documentation\",\"url\":\"https://apim.docs.wso2.com/en/latest/\"}],\"maintainers\":[{\"name\":\"WSO2\",\"url\":\"https://wso2.com\"}],\"notes\":\"WSO2 API Manager has been deployed. Access the management console and API gateway according to your ingress configuration.\",\"type\":\"WSO2 API Manager\",\"version\":\"4.5.0\"},\"selector\":{\"matchLabels\":{\"app.kubernetes.io/name\":\"apptest-9eyndrif\"}}}}\n",
DEPLOYER             "kubernetes-engine.cloud.google.com/icon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==",
DEPLOYER             "marketplace.cloud.google.com/deploy-info": "{\"partner_id\": \"wso2-marketplace-public\", \"product_id\": \"wso2-apim-kubernetes\", \"partner_name\": \"WSO2\"}"
DEPLOYER         },
DEPLOYER         "creationTimestamp": "2025-12-02T10:37:08Z",
DEPLOYER         "generation": 3,
DEPLOYER         "labels": {
DEPLOYER             "app.kubernetes.io/name": "apptest-9eyndrif"
DEPLOYER         },
DEPLOYER         "name": "apptest-9eyndrif",
DEPLOYER         "namespace": "apptest-9eyndrif",
DEPLOYER         "resourceVersion": "1764671891672367021",
DEPLOYER         "uid": "2221911f-59d8-47f1-9f44-962d1d6fc80f"
DEPLOYER     },
DEPLOYER     "spec": {
DEPLOYER         "assemblyPhase": "Failed",
DEPLOYER         "componentKinds": [
DEPLOYER             {
DEPLOYER                 "group": "apps/v1",
DEPLOYER                 "kind": "Deployment"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "apps/v1",
DEPLOYER                 "kind": "StatefulSet"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "v1",
DEPLOYER                 "kind": "Service"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "v1",
DEPLOYER                 "kind": "ConfigMap"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "v1",
DEPLOYER                 "kind": "Secret"
DEPLOYER             }
DEPLOYER         ],
DEPLOYER         "descriptor": {
DEPLOYER             "description": "WSO2 API Manager provides a complete platform for building, managing, and scaling APIs.",
DEPLOYER             "links": [
DEPLOYER                 {
DEPLOYER                     "description": "User Guide: Getting Started",
DEPLOYER                     "url": "https://apim.docs.wso2.com/"
DEPLOYER                 },
DEPLOYER                 {
DEPLOYER                     "description": "WSO2 API Manager Documentation",
DEPLOYER                     "url": "https://apim.docs.wso2.com/en/latest/"
DEPLOYER                 }
DEPLOYER             ],
DEPLOYER             "maintainers": [
DEPLOYER                 {
DEPLOYER                     "name": "WSO2",
DEPLOYER                     "url": "https://wso2.com"
DEPLOYER                 }
DEPLOYER             ],
DEPLOYER             "notes": "WSO2 API Manager has been deployed. Access the management console and API gateway according to your ingress configuration.",
DEPLOYER             "type": "WSO2 API Manager",
DEPLOYER             "version": "4.5.0"
DEPLOYER         },
DEPLOYER         "selector": {
DEPLOYER             "matchLabels": {
DEPLOYER                 "app.kubernetes.io/name": "apptest-9eyndrif"
DEPLOYER             }
DEPLOYER         }
DEPLOYER     }
DEPLOYER }
DEPLOYER + exit 1
Using /opt/kubectl/1.31/kubectl (server=1.32)
INFO Deleting namespace "apptest-9eyndrif"
Using /opt/kubectl/1.31/kubectl (server=1.32)
apiVersion: v1
items:
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: 4318f92538a0228523d71227b6ba9838cd2a6096902dc9a5a99e5dc82946d4fd
    creationTimestamp: "2025-12-02T10:38:09Z"
    generateName: apkagent-bdb54d4f9-
    labels:
      app.kubernetes.io/app: apim-apk-agent
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/name: apkagent
      pod-template-hash: bdb54d4f9
    name: apkagent-bdb54d4f9-sx2cs
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apkagent-bdb54d4f9
      uid: 34220e23-a412-43b8-872d-c82d9ed6b1a9
    resourceVersion: "1764671890271423015"
    uid: f7465396-9a07-46de-bf95-2324f8856934
  spec:
    containers:
    - env:
      - name: APIM_APK_AGENT_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/apk-agent.key
      - name: APIM_APK_AGENT_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/apk-agent.crt
      - name: APIM_APK_AGENT_SERVER_NAME
        value: apim-apk-agent-service.apptest-9eyndrif.svc
      - name: APIM_APK_AGENT_GRPC_PORT
        value: "18000"
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: apkagent
      ports:
      - containerPort: 18000
        name: grpc-port
        protocol: TCP
      - containerPort: 18001
        name: rest-port
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 200m
          memory: 256Mi
        requests:
          cpu: 100m
          memory: 128Mi
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/keystore/apk-agent.key
        name: apk-agent-certificates
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/apk-agent.crt
        name: apk-agent-certificates
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
        name: apk-agent-certificates
        subPath: ca.crt
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-jlj5w
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext: {}
    serviceAccount: wso2agent-platform
    serviceAccountName: wso2agent-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - configMap:
        defaultMode: 420
        name: apptest-9eyndrif-log-conf
      name: log-conf-volume
    - name: apk-agent-certificates
      secret:
        defaultMode: 420
        secretName: apk-agent-server-cert
    - name: kube-api-access-jlj5w
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:10Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:10Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:10Z"
      message: 'containers with unready status: [apkagent]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:10Z"
      message: 'containers with unready status: [apkagent]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:10Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
      imageID: ""
      lastState: {}
      name: apkagent
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/keystore/apk-agent.key
        name: apk-agent-certificates
      - mountPath: /home/wso2/security/keystore/apk-agent.crt
        name: apk-agent-certificates
      - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
        name: apk-agent-certificates
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-jlj5w
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:38:10Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum.am.cp.conf: 29253449acd118148e223f852c8225f78c6024f319555bfa9b3934da7984fdcc
      checksum.am.cp.conf.log4j2: 5166ece53af100d4fcaad01e127ffac9213bae9a3aa7f47f5e1eee1459fa3da0
      checksum.am.cp.conf.secret: 6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb
      cloudmarketplace.googleapis.com/product.metadata: v1:{"services":[{"service_name":"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog",
        "service_level":"default"}]}
    creationTimestamp: "2025-12-02T10:38:08Z"
    generateName: apptest-9eyndrif-acp-deployment-1-69d5775498-
    labels:
      deployment: apptest-9eyndrif-acp
      node: apptest-9eyndrif-acp-1
      pod-template-hash: 69d5775498
      product: apim
    name: apptest-9eyndrif-acp-deployment-1-69d5775498-65hs7
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-9eyndrif-acp-deployment-1-69d5775498
      uid: f1c3651e-af1f-45de-a430-55e25af651dd
    resourceVersion: "1764671890100623001"
    uid: 66f987b7-0772-44ba-8aec-034cbf8a6dbf
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: deployment
                operator: In
                values:
                - apptest-9eyndrif-acp
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - env:
      - name: PROFILE_NAME
        value: default
      - name: NODE_IP
        valueFrom:
          fieldRef:
            apiVersion: v1
            fieldPath: status.podIP
      - name: JVM_MEM_OPTS
        value: -Xms2048m -Xmx2048m
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
      imagePullPolicy: Always
      lifecycle:
        preStop:
          exec:
            command:
            - sh
            - -c
            - |
              echo "Pre stop hook triggered"; sleep 10; echo "Shutdown APIM Server"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop
      livenessProbe:
        failureThreshold: 3
        httpGet:
          path: /services/Version
          port: 9763
          scheme: HTTP
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 1
      name: wso2am-control-plane
      ports:
      - containerPort: 9763
        protocol: TCP
      - containerPort: 9443
        protocol: TCP
      - containerPort: 9711
        protocol: TCP
      - containerPort: 9611
        protocol: TCP
      - containerPort: 5672
        protocol: TCP
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /services/Version
          port: 9763
          scheme: HTTP
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: "3"
          memory: 5Gi
        requests:
          cpu: "2"
          memory: 2Gi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - all
        runAsNonRoot: true
        runAsUser: 10001
      startupProbe:
        exec:
          command:
          - /bin/sh
          - -c
          - timeout 1 bash -c "</dev/tcp/localhost/9443"
        failureThreshold: 3
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 1
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
        name: wso2am-control-plane-conf
        subPath: deployment.toml
      - mountPath: /home/wso2carbon/docker-entrypoint.sh
        name: wso2am-control-plane-entrypoint
        subPath: docker-entrypoint.sh
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
        name: wso2am-control-plane-log4j2
        subPath: log4j2.properties
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
        name: wso2am-conf-admin-settings
        subPath: settings.json
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
        name: wso2am-conf-devportal-settings
        subPath: settings.json
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
        name: wso2am-conf-publisher-settings
        subPath: settings.json
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-jm26t
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-583b68cf-21fl
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: default
    serviceAccountName: default
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - configMap:
        defaultMode: 263
        name: apptest-9eyndrif-acp-conf-1
      name: wso2am-control-plane-conf
    - configMap:
        defaultMode: 263
        name: apptest-9eyndrif-acp-conf-entrypoint
      name: wso2am-control-plane-entrypoint
    - configMap:
        defaultMode: 263
        name: apptest-9eyndrif-acp-conf-log4j2
      name: wso2am-control-plane-log4j2
    - configMap:
        defaultMode: 263
        name: apptest-9eyndrif-acp-conf-admin-settings
      name: wso2am-conf-admin-settings
    - configMap:
        defaultMode: 263
        name: apptest-9eyndrif-acp-conf-devportal-settings
      name: wso2am-conf-devportal-settings
    - configMap:
        defaultMode: 263
        name: apptest-9eyndrif-acp-conf-publisher-settings
      name: wso2am-conf-publisher-settings
    - name: kube-api-access-jm26t
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      message: 'containers with unready status: [wso2am-control-plane]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      message: 'containers with unready status: [wso2am-control-plane]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - containerID: containerd://de0e9d19f9c80780794076d1f609da2e21c8f5d3877c4f01fa911c519c09598c
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
      imageID: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp@sha256:bfb3fd228700cab79b89c8bd38890a1a5ba3fd03bd3f51bb969c07d9b2e9922d
      lastState: {}
      name: wso2am-control-plane
      ready: false
      restartCount: 0
      started: false
      state:
        running:
          startedAt: "2025-12-02T10:38:09Z"
      volumeMounts:
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
        name: wso2am-control-plane-conf
      - mountPath: /home/wso2carbon/docker-entrypoint.sh
        name: wso2am-control-plane-entrypoint
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
        name: wso2am-control-plane-log4j2
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
        name: wso2am-conf-admin-settings
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
        name: wso2am-conf-devportal-settings
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
        name: wso2am-conf-publisher-settings
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-jm26t
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.193
    hostIPs:
    - ip: 10.142.15.193
    phase: Running
    podIP: 10.76.0.29
    podIPs:
    - ip: 10.76.0.29
    qosClass: Burstable
    startTime: "2025-12-02T10:38:08Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      sidecar.istio.io/inject: "false"
    creationTimestamp: "2025-12-02T10:37:36Z"
    generateName: apptest-9eyndrif-deployer-
    labels:
      batch.kubernetes.io/controller-uid: 1863ac4c-a1cc-4d38-a6ab-b9cd38985f00
      batch.kubernetes.io/job-name: apptest-9eyndrif-deployer
      controller-uid: 1863ac4c-a1cc-4d38-a6ab-b9cd38985f00
      job-name: apptest-9eyndrif-deployer
    name: apptest-9eyndrif-deployer-fs226
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: batch/v1
      blockOwnerDeletion: true
      controller: true
      kind: Job
      name: apptest-9eyndrif-deployer
      uid: 1863ac4c-a1cc-4d38-a6ab-b9cd38985f00
    resourceVersion: "1764671894817535005"
    uid: 46073b03-8c1d-4631-835c-dcefd9595100
  spec:
    containers:
    - command:
      - /bin/deploy_with_tests.sh
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
      imagePullPolicy: Always
      name: deployer
      resources:
        requests:
          cpu: 100m
          memory: 100Mi
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /data/values.yaml
        name: config-volume
        readOnly: true
        subPath: values.yaml
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-9p5jm
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Never
    schedulerName: default-scheduler
    securityContext: {}
    serviceAccount: apptest-9eyndrif-deployer-sa
    serviceAccountName: apptest-9eyndrif-deployer-sa
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: config-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-deployer-config
    - name: kube-api-access-9p5jm
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:13Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:37:36Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:12Z"
      reason: PodFailed
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:12Z"
      reason: PodFailed
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:37:36Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - containerID: containerd://75cafead7a2513c3285d618bf41e9e5476619d4f2484d65f1723067ee13137d4
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
      imageID: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer@sha256:90668e1cb44a5c34d95dcd7b8bcfeada69c3a6cef401261f6e27e7cf78079adf
      lastState: {}
      name: deployer
      ready: false
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://75cafead7a2513c3285d618bf41e9e5476619d4f2484d65f1723067ee13137d4
          exitCode: 1
          finishedAt: "2025-12-02T10:38:11Z"
          reason: Error
          startedAt: "2025-12-02T10:37:38Z"
      volumeMounts:
      - mountPath: /data/values.yaml
        name: config-volume
        readOnly: true
        recursiveReadOnly: Disabled
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-9p5jm
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Failed
    podIP: 10.76.1.55
    podIPs:
    - ip: 10.76.1.55
    qosClass: Burstable
    startTime: "2025-12-02T10:37:36Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d
    creationTimestamp: "2025-12-02T10:38:08Z"
    generateName: apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-
    labels:
      app.kubernetes.io/app: adapter
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 68cfd86db5
    name: apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5
      uid: 1776d696-5a2e-4c0d-a317-888fd7dda833
    resourceVersion: "1764671889134975023"
    uid: b6b7be3b-59d5-48b1-a8e4-89b71bc01707
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - adapter
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - env:
      - name: OPERATOR_POD_NAMESPACE
        valueFrom:
          fieldRef:
            apiVersion: v1
            fieldPath: metadata.namespace
      - name: ADAPTER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/adapter.key
      - name: ADAPTER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/adapter.crt
      - name: ADAPTER_SERVER_NAME
        value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: adapter
      ports:
      - containerPort: 18000
        protocol: TCP
      - containerPort: 8765
        protocol: TCP
      - containerPort: 18005
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 200m
          memory: 128Mi
        requests:
          cpu: 50m
          memory: 64Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/adapter.key
        name: adapter-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/adapter.crt
        name: adapter-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: adapter-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/consul
        name: adapter-truststore-consul-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
        subPath: wso2-apim-carbon.pem
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-xr92k
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: adapter-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-adapter-server-cert
    - name: adapter-truststore-consul-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-adapter-truststore-consul-secret
    - configMap:
        defaultMode: 420
        name: apptest-9eyndrif-wso2-apk-log-conf
      name: log-conf-volume
    - emptyDir: {}
      name: router-truststore-secret-volume
    - name: enforcer-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-server-cert
    - name: enforcer-apikey-cert
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
    - name: kube-api-access-xr92k
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [adapter]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [adapter]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
      imageID: ""
      lastState: {}
      name: adapter
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/adapter.key
        name: adapter-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/adapter.crt
        name: adapter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: adapter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/consul
        name: adapter-truststore-consul-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-xr92k
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:38:09Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: b3a8bb587ccf599df39588f11ec45c9cf0e00707f97be595291cb9691c881cc9
    creationTimestamp: "2025-12-02T10:38:09Z"
    generateName: apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c-
    labels:
      app.kubernetes.io/app: commoncontroller
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 97d849d4c
    name: apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c
      uid: 014cb46b-ab71-4c39-8f5e-53fb14ec9839
    resourceVersion: "1764671889359567008"
    uid: 1dc27e85-6818-4ddd-b2a3-33de360c2996
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - common-controller
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - env:
      - name: OPERATOR_POD_NAMESPACE
        valueFrom:
          fieldRef:
            apiVersion: v1
            fieldPath: metadata.namespace
      - name: COMMON_CONTROLLER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/commoncontroller.key
      - name: COMMON_CONTROLLER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/commoncontroller.crt
      - name: COMMON_CONTROLLER_SERVER_NAME
        value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: commoncontroller
      ports:
      - containerPort: 18005
        protocol: TCP
      - containerPort: 18002
        protocol: TCP
      - containerPort: 9543
        protocol: TCP
      - containerPort: 18003
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 200m
          memory: 128Mi
        requests:
          cpu: 50m
          memory: 64Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/commoncontroller.key
        name: common-controller-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/commoncontroller.crt
        name: common-controller-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: common-controller-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /tmp/k8s-webhook-server/serving-certs
        name: adapter-webhook-server-cert
        readOnly: true
      - mountPath: /home/wso2/security/sts/
        name: sts-shared-auth-key
        readOnly: true
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-5wcnw
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: common-controller-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-common-controller-server-cert
    - configMap:
        defaultMode: 420
        name: apptest-9eyndrif-wso2-apk-common-log-conf
      name: log-conf-volume
    - name: adapter-webhook-server-cert
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-webhook-server-cert
    - name: sts-shared-auth-key
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-sts-shared-auth-key
    - name: ratelimiter-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
    - name: kube-api-access-5wcnw
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [commoncontroller]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [commoncontroller]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
      imageID: ""
      lastState: {}
      name: commoncontroller
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/commoncontroller.key
        name: common-controller-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/commoncontroller.crt
        name: common-controller-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: common-controller-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /tmp/k8s-webhook-server/serving-certs
        name: adapter-webhook-server-cert
        readOnly: true
        recursiveReadOnly: Disabled
      - mountPath: /home/wso2/security/sts/
        name: sts-shared-auth-key
        readOnly: true
        recursiveReadOnly: Disabled
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-5wcnw
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:38:09Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: 318c98d870e099004833cb9bcf909cdbc1ac684e2b2782b55a98bf8700d8f05b
    creationTimestamp: "2025-12-02T10:38:08Z"
    generateName: apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-
    labels:
      app.kubernetes.io/app: configdeployer-ds
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 5b859c7798
    name: apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798
      uid: afbbf905-5b50-464c-8e28-6330144100c1
    resourceVersion: "1764671888897935024"
    uid: e24829b5-69e0-4bc6-aaeb-34849c83a26e
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - config-ds
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
      imagePullPolicy: Always
      livenessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 9443
          scheme: HTTPS
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: config-ds
      ports:
      - containerPort: 9443
        protocol: TCP
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 9443
          scheme: HTTPS
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 500m
          memory: 1Gi
        requests:
          cpu: 200m
          memory: 512Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
        name: config-toml-volume
        subPath: Config.toml
      - mountPath: /home/wso2apk/config-deployer/security/config.key
        name: config-ds-tls-volume
        subPath: tls.key
      - mountPath: /home/wso2apk/config-deployer/security/config.pem
        name: config-ds-tls-volume
        subPath: tls.crt
      - mountPath: /home/wso2apk/config-deployer/security/mg.pem
        name: enforcer-jwt-secret-volume
        subPath: mg.pem
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2apk/config-deployer/tmp
        name: config-deployer-temp
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-cbdzs
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - configMap:
        defaultMode: 420
        name: apptest-9eyndrif-wso2-apk-config-ds-configmap
      name: config-toml-volume
    - name: config-ds-tls-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-config-ds-server-cert
    - name: enforcer-jwt-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-keystore-secret
    - emptyDir: {}
      name: tmp
    - emptyDir: {}
      name: config-deployer-temp
    - name: kube-api-access-cbdzs
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      message: 'containers with unready status: [config-ds]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      message: 'containers with unready status: [config-ds]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:08Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
      imageID: ""
      lastState: {}
      name: config-ds
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
        name: config-toml-volume
      - mountPath: /home/wso2apk/config-deployer/security/config.key
        name: config-ds-tls-volume
      - mountPath: /home/wso2apk/config-deployer/security/config.pem
        name: config-ds-tls-volume
      - mountPath: /home/wso2apk/config-deployer/security/mg.pem
        name: enforcer-jwt-secret-volume
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2apk/config-deployer/tmp
        name: config-deployer-temp
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-cbdzs
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:38:08Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d
    creationTimestamp: "2025-12-02T10:38:09Z"
    generateName: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649-
    labels:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 5b449f9649
    name: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649
      uid: 1d1c32a3-2d3f-4b11-b6a2-d8a4b42a1935
    resourceVersion: "1764671890015935008"
    uid: 11f46c15-40d3-490e-873c-5ba195924b35
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - gateway-runtime
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    automountServiceAccountToken: false
    containers:
    - env:
      - name: TOKEN_REVOCATION_ENABLED
        value: "true"
      - name: ADAPTER_HOST_NAME
        value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
      - name: ADAPTER_HOST
        value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
      - name: COMMON_CONTROLLER_HOST_NAME
        value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
      - name: COMMON_CONTROLLER_HOST
        value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
      - name: RATELIMITER_HOST
        value: apptest-9eyndrif-wso2-apk-ratelimiter-service.apptest-9eyndrif.svc
      - name: ENFORCER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/enforcer.key
      - name: ENFORCER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/enforcer.crt
      - name: ENFORCER_SERVER_NAME
        value: apptest-9eyndrif-wso2-apk-enforcer-service.apptest-9eyndrif.svc
      - name: TRUSTED_CA_CERTS_PATH
        value: /home/wso2/security/truststore
      - name: ADAPTER_XDS_PORT
        value: "18000"
      - name: RATELIMITER_PORT
        value: "8091"
      - name: COMMON_CONTROLLER_XDS_PORT
        value: "18002"
      - name: COMMON_CONTROLLER_REST_PORT
        value: "18003"
      - name: ENFORCER_LABEL
        value: wso2-apk-default
      - name: ENFORCER_REGION
        value: UNKNOWN
      - name: XDS_MAX_MSG_SIZE
        value: "4194304"
      - name: XDS_MAX_RETRIES
        value: "3"
      - name: enforcer_admin_pwd
        value: admin
      - name: REDIS_USERNAME
        value: default
      - name: REDIS_PASSWORD
      - name: REDIS_HOST
        value: redis-master
      - name: REDIS_PORT
        value: "6379"
      - name: IS_REDIS_TLS_ENABLED
        value: "false"
      - name: REDIS_REVOKED_TOKENS_CHANNEL
        value: wso2-apk-revoked-tokens-channel
      - name: REDIS_KEY_FILE
        value: /home/wso2/security/truststore/enforcer.key
      - name: REDIS_CERT_FILE
        value: /home/wso2/security/truststore/enforcer.crt
      - name: REDIS_CA_CERT_FILE
        value: /home/wso2/security/truststore/enforcer.crt
      - name: REVOKED_TOKEN_CLEANUP_INTERVAL
        value: "3600"
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: enforcer
      ports:
      - containerPort: 8081
        protocol: TCP
      - containerPort: 9001
        protocol: TCP
      - containerPort: 5006
        protocol: TCP
      - containerPort: 8084
        protocol: TCP
      - containerPort: 9092
        protocol: TCP
      - containerPort: 18002
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 500m
          memory: 512Mi
        requests:
          cpu: 200m
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
        runAsNonRoot: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2/security/keystore/enforcer.key
        name: enforcer-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/enforcer.crt
        name: enforcer-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/apk.crt
        name: enforcer-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/check_health.sh
        name: enforcer-health-check-volume
        subPath: check_health.sh
      - mountPath: /home/wso2/security/keystore/mg.pem
        name: enforcer-jwt-secret-volume
        subPath: mg.pem
      - mountPath: /home/wso2/security/truststore/mg.pem
        name: enforcer-jwt-secret-volume
        subPath: mg.pem
      - mountPath: /home/wso2/security/keystore/mg.key
        name: enforcer-jwt-secret-volume
        subPath: mg.key
      - mountPath: /home/wso2/security/truststore/wso2carbon.pem
        name: enforcer-trusted-certs
        subPath: wso2carbon.pem
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
        subPath: wso2-apim-carbon.pem
      - mountPath: /home/wso2/security/truststore/idp.pem
        name: idp-certificate-secret-volume
        subPath: wso2carbon.pem
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
        subPath: ca.crt
    - env:
      - name: ADAPTER_HOST_NAME
        value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
      - name: ADAPTER_HOST
        value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
      - name: ENFORCER_HOST
        value: 127.0.0.1
      - name: ENFORCER_ANALYTICS_HOST
        value: 127.0.0.1
      - name: ROUTER_ADMIN_HOST
        value: 0.0.0.0
      - name: ROUTER_ADMIN_PORT
        value: "9000"
      - name: ROUTER_PORT
        value: "9095"
      - name: ROUTER_CLUSTER
        value: apk_router_cluster
      - name: ROUTER_LABEL
        value: wso2-apk-default
      - name: ROUTER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/router.key
      - name: ROUTER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/router.crt
      - name: ADAPTER_PORT
        value: "18000"
      - name: ADAPTER_CA_CERT_PATH
        value: /home/wso2/security/truststore/adapter.crt
      - name: ENFORCER_PORT
        value: "8081"
      - name: ENFORCER_ANALYTICS_RECEIVER_PORT
        value: "18090"
      - name: ENFORCER_CA_CERT_PATH
        value: /home/wso2/security/truststore/enforcer.crt
      - name: CONCURRENCY
        value: "2"
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - router_check_health.sh
          - health
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: router
      ports:
      - containerPort: 9095
        protocol: TCP
      - containerPort: 9090
        protocol: TCP
      - containerPort: 9091
        protocol: TCP
      - containerPort: 9000
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - router_check_health.sh
          - health
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: "1"
          memory: 1028Mi
        requests:
          cpu: 200m
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
        runAsNonRoot: true
      startupProbe:
        exec:
          command:
          - sh
          - router_check_health.sh
          - health
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/router.key
        name: router-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/router.crt
        name: router-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
        subPath: ca.crt
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: default
    serviceAccountName: default
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: ratelimiter-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
    - name: enforcer-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-server-cert
    - configMap:
        defaultMode: 420
        name: apptest-9eyndrif-wso2-apk-log-conf
      name: log-conf-volume
    - configMap:
        defaultMode: 420
        name: apptest-9eyndrif-wso2-apk-enforcer-grpc-probe-script-conf
      name: enforcer-health-check-volume
    - name: router-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-gateway-server-cert
    - name: adapter-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-adapter-server-cert
    - name: enforcer-jwt-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-keystore-secret
    - name: enforcer-trusted-certs
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
    - name: enforcer-apikey-cert
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
    - name: idp-certificate-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
    - emptyDir: {}
      name: tmp
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [enforcer router]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [enforcer router]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
      imageID: ""
      lastState: {}
      name: enforcer
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2/security/keystore/enforcer.key
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/enforcer.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/apk.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-keystore-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/check_health.sh
        name: enforcer-health-check-volume
      - mountPath: /home/wso2/security/keystore/mg.pem
        name: enforcer-jwt-secret-volume
      - mountPath: /home/wso2/security/truststore/mg.pem
        name: enforcer-jwt-secret-volume
      - mountPath: /home/wso2/security/keystore/mg.key
        name: enforcer-jwt-secret-volume
      - mountPath: /home/wso2/security/truststore/wso2carbon.pem
        name: enforcer-trusted-certs
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
      - mountPath: /home/wso2/security/truststore/idp.pem
        name: idp-certificate-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
      imageID: ""
      lastState: {}
      name: router
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/router.key
        name: router-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/router.crt
        name: router-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:38:09Z"
- apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: "2025-12-02T10:38:09Z"
    generateName: apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc-
    labels:
      app.kubernetes.io/app: ratelimiter
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 5966c885bc
    name: apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc
      uid: d6883655-9248-4814-961a-9146714ed1bc
    resourceVersion: "1764671889746207010"
    uid: fbfea9ef-4324-4e6f-a8e1-584c52fbe89f
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - rate-limiter
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    automountServiceAccountToken: false
    containers:
    - env:
      - name: HOST
        value: 0.0.0.0
      - name: PORT
        value: "8090"
      - name: USE_STATSD
        value: "false"
      - name: LOG_LEVEL
        value: DEBUG
      - name: LIMIT_RESPONSE_HEADERS_ENABLED
        value: "false"
      - name: REDIS_TYPE
        value: single
      - name: REDIS_SOCKET_TYPE
        value: tcp
      - name: REDIS_URL
        value: redis-master:6379
      - name: REDIS_PIPELINE_WINDOW
        value: 0.2ms
      - name: REDIS_PIPELINE_LIMIT
        value: "0"
      - name: GRPC_HOST
        value: 0.0.0.0
      - name: GRPC_PORT
        value: "8091"
      - name: GRPC_SERVER_USE_TLS
        value: "true"
      - name: GRPC_SERVER_TLS_KEY
        value: /home/wso2/security/keystore/ratelimiter.key
      - name: GRPC_SERVER_TLS_CERT
        value: /home/wso2/security/keystore/ratelimiter.crt
      - name: GRPC_CLIENT_TLS_CACERT
        value: /home/wso2/security/truststore/ratelimiter-ca.crt
      - name: RATELIMITER_LABEL
        value: ratelimiter
      - name: CONFIG_GRPC_XDS_SERVER_URL
        value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc:18005
      - name: CONFIG_GRPC_XDS_SERVER_USE_TLS
        value: "true"
      - name: CONFIG_GRPC_XDS_CLIENT_TLS_KEY
        value: /home/wso2/security/keystore/ratelimiter.key
      - name: CONFIG_GRPC_XDS_CLIENT_TLS_CERT
        value: /home/wso2/security/keystore/ratelimiter.crt
      - name: CONFIG_GRPC_XDS_SERVER_TLS_CACERT
        value: /home/wso2/security/truststore/ratelimiter-ca.crt
      - name: CONFIG_GRPC_XDS_SERVER_TLS_SAN
        value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
      imagePullPolicy: Always
      livenessProbe:
        failureThreshold: 5
        httpGet:
          path: /healthcheck
          port: 8090
          scheme: HTTP
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: ratelimiter
      ports:
      - containerPort: 8090
        protocol: TCP
      - containerPort: 8091
        protocol: TCP
      - containerPort: 6070
        protocol: TCP
      readinessProbe:
        failureThreshold: 5
        httpGet:
          path: /healthcheck
          port: 8090
          scheme: HTTP
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 100m
          memory: 128Mi
        requests:
          cpu: 50m
          memory: 64Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/ratelimiter.key
        name: ratelimiter-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/ratelimiter.crt
        name: ratelimiter-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/adapter.pem
        name: common-controller-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/router.pem
        name: router-truststore-secret-volume
        subPath: tls.crt
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: ratelimiter-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
    - name: common-controller-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-common-controller-server-cert
    - name: router-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-9eyndrif-wso2-apk-gateway-server-cert
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [ratelimiter]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      message: 'containers with unready status: [ratelimiter]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:09Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
      imageID: ""
      lastState: {}
      name: ratelimiter
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/ratelimiter.key
        name: ratelimiter-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/ratelimiter.crt
        name: ratelimiter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter.pem
        name: common-controller-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/router.pem
        name: router-truststore-secret-volume
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:38:09Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/configmap: 2a9ab4a5432825504d910f022638674ce88eaefe9f9f595ad8bc107377d104fb
      checksum/health: aff24913d801436ea469d8d374b2ddb3ec4c43ee7ab24663d5f8ff1a1b6991a9
      checksum/scripts: bdec350b84a1ace7cc118db113a21c9f160bde3425b07714e1c0c1da722621cf
      checksum/secret: 44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a
    creationTimestamp: "2025-12-02T10:38:10Z"
    generateName: redis-master-
    labels:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      apps.kubernetes.io/pod-index: "0"
      controller-revision-hash: redis-master-65d7978ff6
      helm.sh/chart: redis-20.10.0
      statefulset.kubernetes.io/pod-name: redis-master-0
    name: redis-master-0
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: StatefulSet
      name: redis-master
      uid: c007709f-c306-4e31-bc3c-705a8e79cacf
    resourceVersion: "1764671906690015005"
    uid: 3e142798-1e7f-40d8-978a-eb23d1c6ea11
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/component: master
                app.kubernetes.io/instance: apptest-9eyndrif
                app.kubernetes.io/name: redis
            topologyKey: kubernetes.io/hostname
          weight: 1
    automountServiceAccountToken: false
    containers:
    - args:
      - -c
      - /opt/bitnami/scripts/start-scripts/start-master.sh
      command:
      - /bin/bash
      env:
      - name: BITNAMI_DEBUG
        value: "true"
      - name: REDIS_REPLICATION_MODE
        value: master
      - name: ALLOW_EMPTY_PASSWORD
        value: "yes"
      - name: REDIS_TLS_ENABLED
        value: "no"
      - name: REDIS_PORT
        value: "6379"
      image: docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4
      imagePullPolicy: IfNotPresent
      livenessProbe:
        exec:
          command:
          - sh
          - -c
          - /health/ping_liveness_local.sh 5
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 6
      name: redis
      ports:
      - containerPort: 6379
        name: redis
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - -c
          - /health/ping_readiness_local.sh 1
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 2
      resources:
        limits:
          cpu: 150m
          ephemeral-storage: 2Gi
          memory: 192Mi
        requests:
          cpu: 100m
          ephemeral-storage: 50Mi
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
        runAsGroup: 1001
        runAsNonRoot: true
        seLinuxOptions: {}
        seccompProfile:
          type: RuntimeDefault
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /opt/bitnami/scripts/start-scripts
        name: start-scripts
      - mountPath: /health
        name: health
      - mountPath: /data
        name: redis-data
      - mountPath: /opt/bitnami/redis/mounted-etc
        name: config
      - mountPath: /opt/bitnami/redis/etc/
        name: empty-dir
        subPath: app-conf-dir
      - mountPath: /tmp
        name: empty-dir
        subPath: tmp-dir
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    hostname: redis-master-0
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      fsGroup: 1001
      fsGroupChangePolicy: Always
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: redis-master
    serviceAccountName: redis-master
    subdomain: redis-headless
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: redis-data
      persistentVolumeClaim:
        claimName: redis-data-redis-master-0
    - configMap:
        defaultMode: 493
        name: redis-scripts
      name: start-scripts
    - configMap:
        defaultMode: 493
        name: redis-health
      name: health
    - configMap:
        defaultMode: 420
        name: redis-configuration
      name: config
    - emptyDir: {}
      name: empty-dir
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:26Z"
      status: "True"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:14Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:14Z"
      message: 'containers with unready status: [redis]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:14Z"
      message: 'containers with unready status: [redis]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:38:14Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - containerID: containerd://be0cc49e96e8d1ef65b1b1d1bdcaa30876edf8cab3d4a3c8bf5e3d9dd1ba2a62
      image: docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4
      imageID: docker.io/bitnamilegacy/redis@sha256:83d5c765b68bdd01603ea5cbad96abc196e37fb875dc2e9fb8b9bdcce59d13d5
      lastState: {}
      name: redis
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2025-12-02T10:38:26Z"
      volumeMounts:
      - mountPath: /opt/bitnami/scripts/start-scripts
        name: start-scripts
      - mountPath: /health
        name: health
      - mountPath: /data
        name: redis-data
      - mountPath: /opt/bitnami/redis/mounted-etc
        name: config
      - mountPath: /opt/bitnami/redis/etc/
        name: empty-dir
      - mountPath: /tmp
        name: empty-dir
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Running
    podIP: 10.76.1.56
    podIPs:
    - ip: 10.76.1.56
    qosClass: Burstable
    startTime: "2025-12-02T10:38:14Z"
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apim-apk-agent-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"grpc-server","port":18000,"protocol":"TCP"},{"name":"rest-server","port":18001,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"apim-apk-agent"}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apim-apk-agent-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888479263010"
    uid: 0e3887b2-d361-4b8f-88e4-aea75389b245
  spec:
    clusterIP: 34.118.231.230
    clusterIPs:
    - 34.118.231.230
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: grpc-server
      port: 18000
      protocol: TCP
      targetPort: 18000
    - name: rest-server
      port: 18001
      protocol: TCP
      targetPort: 18001
    selector:
      app.kubernetes.io/app: apim-apk-agent
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-acp-1-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"binary","port":9611,"protocol":"TCP"},{"name":"binary-secure","port":9711,"protocol":"TCP"},{"name":"jms-tcp","port":5672,"protocol":"TCP"},{"name":"servlet-https","port":9443,"protocol":"TCP"},{"name":"jwks","port":9763,"protocol":"TCP"}],"selector":{"deployment":"apptest-9eyndrif-acp","node":"apptest-9eyndrif-acp-1"}}}
    creationTimestamp: "2025-12-02T10:38:07Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-acp-1-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671887791311022"
    uid: cc973def-aca7-429a-a5a6-ef8342f7e473
  spec:
    clusterIP: 34.118.238.124
    clusterIPs:
    - 34.118.238.124
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: binary
      port: 9611
      protocol: TCP
      targetPort: 9611
    - name: binary-secure
      port: 9711
      protocol: TCP
      targetPort: 9711
    - name: jms-tcp
      port: 5672
      protocol: TCP
      targetPort: 5672
    - name: servlet-https
      port: 9443
      protocol: TCP
      targetPort: 9443
    - name: jwks
      port: 9763
      protocol: TCP
      targetPort: 9763
    selector:
      deployment: apptest-9eyndrif-acp
      node: apptest-9eyndrif-acp-1
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-acp-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"servlet-http","port":9763,"protocol":"TCP"},{"name":"servlet-https","port":9443,"protocol":"TCP"}],"selector":{"deployment":"apptest-9eyndrif-acp"}}}
    creationTimestamp: "2025-12-02T10:38:07Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-acp-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671887853791002"
    uid: 9ffe20ac-cb7f-44c3-97bd-70113701cbae
  spec:
    clusterIP: 34.118.235.201
    clusterIPs:
    - 34.118.235.201
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: servlet-http
      port: 9763
      protocol: TCP
      targetPort: 9763
    - name: servlet-https
      port: 9443
      protocol: TCP
      targetPort: 9443
    selector:
      deployment: apptest-9eyndrif-acp
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-adapter-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"endpoint1","port":8765,"protocol":"TCP"},{"name":"endpoint2","port":18000,"protocol":"TCP"},{"name":"webhook-server","port":443,"protocol":"TCP","targetPort":9443},{"name":"https-rate-limiter","port":18005,"protocol":"TCP"},{"name":"profile-port","port":6060,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"adapter","app.kubernetes.io/release":"apptest-9eyndrif"}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-adapter-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888139615009"
    uid: 5f6a2938-2619-4f3f-a453-c92595cb7716
  spec:
    clusterIP: 34.118.231.116
    clusterIPs:
    - 34.118.231.116
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: endpoint1
      port: 8765
      protocol: TCP
      targetPort: 8765
    - name: endpoint2
      port: 18000
      protocol: TCP
      targetPort: 18000
    - name: webhook-server
      port: 443
      protocol: TCP
      targetPort: 9443
    - name: https-rate-limiter
      port: 18005
      protocol: TCP
      targetPort: 18005
    - name: profile-port
      port: 6060
      protocol: TCP
      targetPort: 6060
    selector:
      app.kubernetes.io/app: adapter
      app.kubernetes.io/release: apptest-9eyndrif
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-common-controller-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"https-rate-limiter","port":18005,"protocol":"TCP"},{"name":"https-enforcer-xds","port":18002,"protocol":"TCP"},{"name":"webhook-server","port":443,"protocol":"TCP","targetPort":9443},{"name":"https-internal-api","port":18003,"protocol":"TCP"},{"name":"web-server","port":9543,"protocol":"TCP","targetPort":9543}],"selector":{"app.kubernetes.io/app":"commoncontroller","app.kubernetes.io/release":"apptest-9eyndrif"}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-common-controller-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888201583021"
    uid: 05d1b765-b3f8-40f6-8158-153c9171e392
  spec:
    clusterIP: 34.118.228.50
    clusterIPs:
    - 34.118.228.50
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: https-rate-limiter
      port: 18005
      protocol: TCP
      targetPort: 18005
    - name: https-enforcer-xds
      port: 18002
      protocol: TCP
      targetPort: 18002
    - name: webhook-server
      port: 443
      protocol: TCP
      targetPort: 9443
    - name: https-internal-api
      port: 18003
      protocol: TCP
      targetPort: 18003
    - name: web-server
      port: 9543
      protocol: TCP
      targetPort: 9543
    selector:
      app.kubernetes.io/app: commoncontroller
      app.kubernetes.io/release: apptest-9eyndrif
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-config-ds-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"servlet-https","port":9443,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"configdeployer-ds","app.kubernetes.io/release":"apptest-9eyndrif"}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-config-ds-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888056319002"
    uid: 5f433918-579b-4342-be1a-78499bf4f58f
  spec:
    clusterIP: 34.118.231.78
    clusterIPs:
    - 34.118.231.78
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: servlet-https
      port: 9443
      protocol: TCP
      targetPort: 9443
    selector:
      app.kubernetes.io/app: configdeployer-ds
      app.kubernetes.io/release: apptest-9eyndrif
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-enforcer-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"servlet-https","port":9092,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-9eyndrif"}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-enforcer-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888266847019"
    uid: 223b9efc-9182-4933-8fb2-d877551a3486
  spec:
    clusterIP: 34.118.234.35
    clusterIPs:
    - 34.118.234.35
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: servlet-https
      port: 9092
      protocol: TCP
      targetPort: 9092
    selector:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-9eyndrif
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-gateway-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"https-endpoint","port":9095,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-9eyndrif"},"type":"LoadBalancer"}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    finalizers:
    - service.kubernetes.io/load-balancer-cleanup
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-gateway-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671922865471020"
    uid: 8a881af2-ed0e-46ad-9223-f481f9d719df
  spec:
    allocateLoadBalancerNodePorts: true
    clusterIP: 34.118.238.21
    clusterIPs:
    - 34.118.238.21
    externalTrafficPolicy: Cluster
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: https-endpoint
      nodePort: 31590
      port: 9095
      protocol: TCP
      targetPort: 9095
    selector:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-9eyndrif
    sessionAffinity: None
    type: LoadBalancer
  status:
    loadBalancer:
      ingress:
      - ip: 35.229.50.244
        ipMode: VIP
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-ratelimiter-service","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"ports":[{"name":"endpoint1","port":8090,"protocol":"TCP"},{"name":"endpoint2","port":8091,"protocol":"TCP"},{"name":"endpoint3","port":6070,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"ratelimiter","app.kubernetes.io/release":"apptest-9eyndrif"}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-ratelimiter-service
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888416623024"
    uid: ca23a847-48cd-4aa9-a3f5-53a2b7648f84
  spec:
    clusterIP: 34.118.226.187
    clusterIPs:
    - 34.118.226.187
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: endpoint1
      port: 8090
      protocol: TCP
      targetPort: 8090
    - name: endpoint2
      port: 8091
      protocol: TCP
      targetPort: 8091
    - name: endpoint3
      port: 6070
      protocol: TCP
      targetPort: 6070
    selector:
      app.kubernetes.io/app: ratelimiter
      app.kubernetes.io/release: apptest-9eyndrif
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"},"name":"redis-headless","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"clusterIP":"None","ports":[{"name":"tcp-redis","port":6379,"targetPort":"redis"}],"selector":{"app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/name":"redis"},"type":"ClusterIP"}}
    creationTimestamp: "2025-12-02T10:38:07Z"
    labels:
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      helm.sh/chart: redis-20.10.0
    name: redis-headless
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671887896479020"
    uid: d5454689-4bee-48c9-9387-81976b83ceda
  spec:
    clusterIP: None
    clusterIPs:
    - None
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: tcp-redis
      port: 6379
      protocol: TCP
      targetPort: redis
    selector:
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/name: redis
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"},"name":"redis-master","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"internalTrafficPolicy":"Cluster","ports":[{"name":"tcp-redis","nodePort":null,"port":6379,"targetPort":"redis"}],"selector":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/name":"redis"},"sessionAffinity":"None","type":"ClusterIP"}}
    creationTimestamp: "2025-12-02T10:38:07Z"
    labels:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      helm.sh/chart: redis-20.10.0
    name: redis-master
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671887982143011"
    uid: b87874ad-2ce8-46a6-b3c0-9476bfa15e6c
  spec:
    clusterIP: 34.118.238.1
    clusterIPs:
    - 34.118.238.1
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: tcp-redis
      port: 6379
      protocol: TCP
      targetPort: redis
    selector:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/name: redis
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/app":"apim-apk-agent","app.kubernetes.io/name":"apptest-9eyndrif","helm.sh/chart":"apkagent"},"name":"apkagent","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"apim-apk-agent","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/name":"apkagent"}},"template":{"metadata":{"annotations":{"checksum/config":"4318f92538a0228523d71227b6ba9838cd2a6096902dc9a5a99e5dc82946d4fd"},"labels":{"app.kubernetes.io/app":"apim-apk-agent","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/name":"apkagent"}},"spec":{"containers":[{"env":[{"name":"APIM_APK_AGENT_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/apk-agent.key"},{"name":"APIM_APK_AGENT_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/apk-agent.crt"},{"name":"APIM_APK_AGENT_SERVER_NAME","value":"apim-apk-agent-service.apptest-9eyndrif.svc"},{"name":"APIM_APK_AGENT_GRPC_PORT","value":"18000"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"apkagent","ports":[{"containerPort":18000,"name":"grpc-port"},{"containerPort":18001,"name":"rest-port"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"200m","memory":"256Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/security/keystore/apk-agent.key","name":"apk-agent-certificates","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/apk-agent.crt","name":"apk-agent-certificates","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/apk-agent-ca.crt","name":"apk-agent-certificates","subPath":"ca.crt"}]}],"serviceAccountName":"wso2agent-platform","volumes":[{"configMap":{"name":"apptest-9eyndrif-log-conf"},"name":"log-conf-volume"},{"name":"apk-agent-certificates","secret":{"secretName":"apk-agent-server-cert"}}]}}}}
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/app: apim-apk-agent
      app.kubernetes.io/name: apptest-9eyndrif
      helm.sh/chart: apkagent
    name: apkagent
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671890304463012"
    uid: df92aaca-e8e9-4719-9064-ba87a4227810
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: apim-apk-agent
        app.kubernetes.io/instance: apptest-9eyndrif
        app.kubernetes.io/name: apkagent
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: 4318f92538a0228523d71227b6ba9838cd2a6096902dc9a5a99e5dc82946d4fd
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: apim-apk-agent
          app.kubernetes.io/instance: apptest-9eyndrif
          app.kubernetes.io/name: apkagent
      spec:
        containers:
        - env:
          - name: APIM_APK_AGENT_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/apk-agent.key
          - name: APIM_APK_AGENT_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/apk-agent.crt
          - name: APIM_APK_AGENT_SERVER_NAME
            value: apim-apk-agent-service.apptest-9eyndrif.svc
          - name: APIM_APK_AGENT_GRPC_PORT
            value: "18000"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: apkagent
          ports:
          - containerPort: 18000
            name: grpc-port
            protocol: TCP
          - containerPort: 18001
            name: rest-port
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 128Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/keystore/apk-agent.key
            name: apk-agent-certificates
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/apk-agent.crt
            name: apk-agent-certificates
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
            name: apk-agent-certificates
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: wso2agent-platform
        serviceAccountName: wso2agent-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-log-conf
          name: log-conf-volume
        - name: apk-agent-certificates
          secret:
            defaultMode: 420
            secretName: apk-agent-server-cert
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:10Z"
      message: ReplicaSet "apkagent-bdb54d4f9" is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-acp-deployment-1","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"deployment":"apptest-9eyndrif-acp","node":"apptest-9eyndrif-acp-1"}},"strategy":{"type":"Recreate"},"template":{"metadata":{"annotations":{"checksum.am.cp.conf":"29253449acd118148e223f852c8225f78c6024f319555bfa9b3934da7984fdcc","checksum.am.cp.conf.log4j2":"5166ece53af100d4fcaad01e127ffac9213bae9a3aa7f47f5e1eee1459fa3da0","checksum.am.cp.conf.secret":"6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb","cloudmarketplace.googleapis.com/product.metadata":"v1:{\"services\":[{\"service_name\":\"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog\", \"service_level\":\"default\"}]}"},"labels":{"deployment":"apptest-9eyndrif-acp","node":"apptest-9eyndrif-acp-1","product":"apim"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"deployment","operator":"In","values":["apptest-9eyndrif-acp"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":[{"name":"PROFILE_NAME","value":"default"},{"name":"NODE_IP","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"status.podIP"}}},{"name":"JVM_MEM_OPTS","value":"-Xms2048m -Xmx2048m"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5","imagePullPolicy":"Always","lifecycle":{"preStop":{"exec":{"command":["sh","-c","echo \"Pre stop hook triggered\"; sleep 10; echo \"Shutdown APIM Server\"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop\n"]}}},"livenessProbe":{"failureThreshold":3,"httpGet":{"path":"/services/Version","port":9763},"initialDelaySeconds":60,"periodSeconds":10},"name":"wso2am-control-plane","ports":[{"containerPort":9763,"protocol":"TCP"},{"containerPort":9443,"protocol":"TCP"},{"containerPort":9711,"protocol":"TCP"},{"containerPort":9611,"protocol":"TCP"},{"containerPort":5672,"protocol":"TCP"}],"readinessProbe":{"failureThreshold":3,"httpGet":{"path":"/services/Version","port":9763},"initialDelaySeconds":60,"periodSeconds":10},"resources":{"limits":{"cpu":"3000m","memory":"5Gi"},"requests":{"cpu":"2000m","memory":"2Gi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"runAsNonRoot":true,"runAsUser":10001},"startupProbe":{"exec":{"command":["/bin/sh","-c","timeout 1 bash -c \"\u003c/dev/tcp/localhost/9443\""]},"failureThreshold":3,"initialDelaySeconds":60,"periodSeconds":10},"volumeMounts":[{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml","name":"wso2am-control-plane-conf","subPath":"deployment.toml"},{"mountPath":"/home/wso2carbon/docker-entrypoint.sh","name":"wso2am-control-plane-entrypoint","subPath":"docker-entrypoint.sh"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties","name":"wso2am-control-plane-log4j2","subPath":"log4j2.properties"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json","name":"wso2am-conf-admin-settings","subPath":"settings.json"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json","name":"wso2am-conf-devportal-settings","subPath":"settings.json"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json","name":"wso2am-conf-publisher-settings","subPath":"settings.json"}]}],"securityContext":{"seccompProfile":{"type":"RuntimeDefault"}},"volumes":[{"configMap":{"defaultMode":263,"name":"apptest-9eyndrif-acp-conf-1"},"name":"wso2am-control-plane-conf"},{"configMap":{"defaultMode":263,"name":"apptest-9eyndrif-acp-conf-entrypoint"},"name":"wso2am-control-plane-entrypoint"},{"configMap":{"defaultMode":263,"name":"apptest-9eyndrif-acp-conf-log4j2"},"name":"wso2am-control-plane-log4j2"},{"configMap":{"defaultMode":263,"name":"apptest-9eyndrif-acp-conf-admin-settings"},"name":"wso2am-conf-admin-settings"},{"configMap":{"defaultMode":263,"name":"apptest-9eyndrif-acp-conf-devportal-settings"},"name":"wso2am-conf-devportal-settings"},{"configMap":{"defaultMode":263,"name":"apptest-9eyndrif-acp-conf-publisher-settings"},"name":"wso2am-conf-publisher-settings"}]}}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-acp-deployment-1
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888971199014"
    uid: 6dbb970e-9917-4c84-9174-edce77984019
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        deployment: apptest-9eyndrif-acp
        node: apptest-9eyndrif-acp-1
    strategy:
      type: Recreate
    template:
      metadata:
        annotations:
          checksum.am.cp.conf: 29253449acd118148e223f852c8225f78c6024f319555bfa9b3934da7984fdcc
          checksum.am.cp.conf.log4j2: 5166ece53af100d4fcaad01e127ffac9213bae9a3aa7f47f5e1eee1459fa3da0
          checksum.am.cp.conf.secret: 6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb
          cloudmarketplace.googleapis.com/product.metadata: v1:{"services":[{"service_name":"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog",
            "service_level":"default"}]}
        creationTimestamp: null
        labels:
          deployment: apptest-9eyndrif-acp
          node: apptest-9eyndrif-acp-1
          product: apim
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: deployment
                    operator: In
                    values:
                    - apptest-9eyndrif-acp
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: PROFILE_NAME
            value: default
          - name: NODE_IP
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: status.podIP
          - name: JVM_MEM_OPTS
            value: -Xms2048m -Xmx2048m
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
          imagePullPolicy: Always
          lifecycle:
            preStop:
              exec:
                command:
                - sh
                - -c
                - |
                  echo "Pre stop hook triggered"; sleep 10; echo "Shutdown APIM Server"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          name: wso2am-control-plane
          ports:
          - containerPort: 9763
            protocol: TCP
          - containerPort: 9443
            protocol: TCP
          - containerPort: 9711
            protocol: TCP
          - containerPort: 9611
            protocol: TCP
          - containerPort: 5672
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "3"
              memory: 5Gi
            requests:
              cpu: "2"
              memory: 2Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - all
            runAsNonRoot: true
            runAsUser: 10001
          startupProbe:
            exec:
              command:
              - /bin/sh
              - -c
              - timeout 1 bash -c "</dev/tcp/localhost/9443"
            failureThreshold: 3
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
            name: wso2am-control-plane-conf
            subPath: deployment.toml
          - mountPath: /home/wso2carbon/docker-entrypoint.sh
            name: wso2am-control-plane-entrypoint
            subPath: docker-entrypoint.sh
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
            name: wso2am-control-plane-log4j2
            subPath: log4j2.properties
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
            name: wso2am-conf-admin-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
            name: wso2am-conf-devportal-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
            name: wso2am-conf-publisher-settings
            subPath: settings.json
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-1
          name: wso2am-control-plane-conf
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-entrypoint
          name: wso2am-control-plane-entrypoint
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-log4j2
          name: wso2am-control-plane-log4j2
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-admin-settings
          name: wso2am-conf-admin-settings
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-devportal-settings
          name: wso2am-conf-devportal-settings
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-publisher-settings
          name: wso2am-conf-publisher-settings
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:38:08Z"
      lastUpdateTime: "2025-12-02T10:38:08Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:38:08Z"
      lastUpdateTime: "2025-12-02T10:38:08Z"
      message: ReplicaSet "apptest-9eyndrif-acp-deployment-1-69d5775498" is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-adapter-deployment","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"adapter","app.kubernetes.io/release":"apptest-9eyndrif"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d"},"labels":{"app.kubernetes.io/app":"adapter","app.kubernetes.io/release":"apptest-9eyndrif"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["adapter"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":[{"name":"OPERATOR_POD_NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"ADAPTER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/adapter.key"},{"name":"ADAPTER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/adapter.crt"},{"name":"ADAPTER_SERVER_NAME","value":"apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"adapter","ports":[{"containerPort":18000,"protocol":"TCP"},{"containerPort":8765,"protocol":"TCP"},{"containerPort":18005,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"200m","memory":"128Mi"},"requests":{"cpu":"50m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/adapter.key","name":"adapter-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/adapter.crt","name":"adapter-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter-ca.crt","name":"adapter-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/router.crt","name":"router-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/enforcer.crt","name":"enforcer-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/consul","name":"adapter-truststore-consul-secret-volume"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/security/truststore/wso2-apim-carbon.pem","name":"enforcer-apikey-cert","subPath":"wso2-apim-carbon.pem"}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"name":"adapter-keystore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-9eyndrif-wso2-apk-adapter-server-cert"}},{"name":"adapter-truststore-consul-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-adapter-truststore-consul-secret"}},{"configMap":{"name":"apptest-9eyndrif-wso2-apk-log-conf"},"name":"log-conf-volume"},{"name":"router-truststore-secret-volume","secret":null},{"name":"enforcer-truststore-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-server-cert"}},{"name":"enforcer-apikey-cert","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-truststore-secret"}}]}}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-adapter-deployment
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671889180479000"
    uid: 12997ce1-f3bc-4c90-98c8-19a47e15dd6a
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: adapter
        app.kubernetes.io/release: apptest-9eyndrif
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: adapter
          app.kubernetes.io/release: apptest-9eyndrif
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - adapter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: ADAPTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/adapter.key
          - name: ADAPTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/adapter.crt
          - name: ADAPTER_SERVER_NAME
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: adapter
          ports:
          - containerPort: 18000
            protocol: TCP
          - containerPort: 8765
            protocol: TCP
          - containerPort: 18005
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/adapter.key
            name: adapter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/adapter.crt
            name: adapter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: adapter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/consul
            name: adapter-truststore-consul-secret-volume
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: adapter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-adapter-server-cert
        - name: adapter-truststore-consul-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-adapter-truststore-consul-secret
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-log-conf
          name: log-conf-volume
        - emptyDir: {}
          name: router-truststore-secret-volume
        - name: enforcer-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-server-cert
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:38:08Z"
      lastUpdateTime: "2025-12-02T10:38:08Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:38:08Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: ReplicaSet "apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-common-controller-deployment","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"commoncontroller","app.kubernetes.io/release":"apptest-9eyndrif"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"b3a8bb587ccf599df39588f11ec45c9cf0e00707f97be595291cb9691c881cc9"},"labels":{"app.kubernetes.io/app":"commoncontroller","app.kubernetes.io/release":"apptest-9eyndrif"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["common-controller"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":[{"name":"OPERATOR_POD_NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"COMMON_CONTROLLER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/commoncontroller.key"},{"name":"COMMON_CONTROLLER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/commoncontroller.crt"},{"name":"COMMON_CONTROLLER_SERVER_NAME","value":"apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"commoncontroller","ports":[{"containerPort":18005,"protocol":"TCP"},{"containerPort":18002,"protocol":"TCP"},{"containerPort":9543,"protocol":"TCP"},{"containerPort":18003,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"200m","memory":"128Mi"},"requests":{"cpu":"50m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/commoncontroller.key","name":"common-controller-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/commoncontroller.crt","name":"common-controller-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter-ca.crt","name":"common-controller-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ca-ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/tmp/k8s-webhook-server/serving-certs","name":"adapter-webhook-server-cert","readOnly":true},{"mountPath":"/home/wso2/security/sts/","name":"sts-shared-auth-key","readOnly":true}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"name":"common-controller-keystore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-9eyndrif-wso2-apk-common-controller-server-cert"}},{"configMap":{"name":"apptest-9eyndrif-wso2-apk-common-log-conf"},"name":"log-conf-volume"},{"name":"adapter-webhook-server-cert","secret":{"defaultMode":420,"secretName":"apptest-9eyndrif-wso2-apk-webhook-server-cert"}},{"name":"sts-shared-auth-key","secret":{"defaultMode":420,"secretName":"apptest-9eyndrif-wso2-apk-sts-shared-auth-key"}},{"name":"ratelimiter-truststore-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-ratelimiter-server-cert"}}]}}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-common-controller-deployment
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671889439311006"
    uid: 52840176-92e5-49ba-93f9-108faec858b7
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: commoncontroller
        app.kubernetes.io/release: apptest-9eyndrif
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: b3a8bb587ccf599df39588f11ec45c9cf0e00707f97be595291cb9691c881cc9
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: commoncontroller
          app.kubernetes.io/release: apptest-9eyndrif
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - common-controller
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: COMMON_CONTROLLER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/commoncontroller.key
          - name: COMMON_CONTROLLER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/commoncontroller.crt
          - name: COMMON_CONTROLLER_SERVER_NAME
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: commoncontroller
          ports:
          - containerPort: 18005
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          - containerPort: 9543
            protocol: TCP
          - containerPort: 18003
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/commoncontroller.key
            name: common-controller-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/commoncontroller.crt
            name: common-controller-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: common-controller-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /tmp/k8s-webhook-server/serving-certs
            name: adapter-webhook-server-cert
            readOnly: true
          - mountPath: /home/wso2/security/sts/
            name: sts-shared-auth-key
            readOnly: true
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: common-controller-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-common-controller-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-common-log-conf
          name: log-conf-volume
        - name: adapter-webhook-server-cert
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-webhook-server-cert
        - name: sts-shared-auth-key
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-sts-shared-auth-key
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: ReplicaSet "apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-config-ds-deployment","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"configdeployer-ds","app.kubernetes.io/release":"apptest-9eyndrif"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"318c98d870e099004833cb9bcf909cdbc1ac684e2b2782b55a98bf8700d8f05b"},"labels":{"app.kubernetes.io/app":"configdeployer-ds","app.kubernetes.io/release":"apptest-9eyndrif"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["config-ds"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":null,"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5","imagePullPolicy":"Always","livenessProbe":{"httpGet":{"path":"/health","port":9443,"scheme":"HTTPS"},"initialDelaySeconds":20,"periodSeconds":20},"name":"config-ds","ports":[{"containerPort":9443,"protocol":"TCP"}],"readinessProbe":{"httpGet":{"path":"/health","port":9443,"scheme":"HTTPS"},"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"500m","memory":"1024Mi"},"requests":{"cpu":"200m","memory":"512Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2apk/config-deployer/conf/Config.toml","name":"config-toml-volume","subPath":"Config.toml"},{"mountPath":"/home/wso2apk/config-deployer/security/config.key","name":"config-ds-tls-volume","subPath":"tls.key"},{"mountPath":"/home/wso2apk/config-deployer/security/config.pem","name":"config-ds-tls-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2apk/config-deployer/security/mg.pem","name":"enforcer-jwt-secret-volume","subPath":"mg.pem"},{"mountPath":"/tmp","name":"tmp"},{"mountPath":"/home/wso2apk/config-deployer/tmp","name":"config-deployer-temp"}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"configMap":{"name":"apptest-9eyndrif-wso2-apk-config-ds-configmap"},"name":"config-toml-volume"},{"name":"config-ds-tls-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-config-ds-server-cert"}},{"name":"enforcer-jwt-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-keystore-secret"}},{"emptyDir":{},"name":"tmp"},{"emptyDir":{},"name":"config-deployer-temp"}]}}}}
    creationTimestamp: "2025-12-02T10:38:08Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-config-ds-deployment
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671888997823013"
    uid: c7f25acc-7960-4b5f-8817-e6933daeb230
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: configdeployer-ds
        app.kubernetes.io/release: apptest-9eyndrif
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: 318c98d870e099004833cb9bcf909cdbc1ac684e2b2782b55a98bf8700d8f05b
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: configdeployer-ds
          app.kubernetes.io/release: apptest-9eyndrif
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - config-ds
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: config-ds
          ports:
          - containerPort: 9443
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 1Gi
            requests:
              cpu: 200m
              memory: 512Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
            name: config-toml-volume
            subPath: Config.toml
          - mountPath: /home/wso2apk/config-deployer/security/config.key
            name: config-ds-tls-volume
            subPath: tls.key
          - mountPath: /home/wso2apk/config-deployer/security/config.pem
            name: config-ds-tls-volume
            subPath: tls.crt
          - mountPath: /home/wso2apk/config-deployer/security/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2apk/config-deployer/tmp
            name: config-deployer-temp
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-config-ds-configmap
          name: config-toml-volume
        - name: config-ds-tls-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-config-ds-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-keystore-secret
        - emptyDir: {}
          name: tmp
        - emptyDir: {}
          name: config-deployer-temp
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:38:08Z"
      lastUpdateTime: "2025-12-02T10:38:08Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:38:08Z"
      lastUpdateTime: "2025-12-02T10:38:08Z"
      message: ReplicaSet "apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-gateway-runtime-deployment","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-9eyndrif"}},"strategy":{"type":null},"template":{"metadata":{"annotations":{"checksum/config":"a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d"},"labels":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-9eyndrif"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["gateway-runtime"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"automountServiceAccountToken":false,"containers":[{"env":[{"name":"TOKEN_REVOCATION_ENABLED","value":"true"},{"name":"ADAPTER_HOST_NAME","value":"apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc"},{"name":"ADAPTER_HOST","value":"apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc"},{"name":"COMMON_CONTROLLER_HOST_NAME","value":"apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc"},{"name":"COMMON_CONTROLLER_HOST","value":"apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc"},{"name":"RATELIMITER_HOST","value":"apptest-9eyndrif-wso2-apk-ratelimiter-service.apptest-9eyndrif.svc"},{"name":"ENFORCER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/enforcer.key"},{"name":"ENFORCER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/enforcer.crt"},{"name":"ENFORCER_SERVER_NAME","value":"apptest-9eyndrif-wso2-apk-enforcer-service.apptest-9eyndrif.svc"},{"name":"TRUSTED_CA_CERTS_PATH","value":"/home/wso2/security/truststore"},{"name":"ADAPTER_XDS_PORT","value":"18000"},{"name":"RATELIMITER_PORT","value":"8091"},{"name":"COMMON_CONTROLLER_XDS_PORT","value":"18002"},{"name":"COMMON_CONTROLLER_REST_PORT","value":"18003"},{"name":"ENFORCER_LABEL","value":"wso2-apk-default"},{"name":"ENFORCER_REGION","value":"UNKNOWN"},{"name":"XDS_MAX_MSG_SIZE","value":"4194304"},{"name":"XDS_MAX_RETRIES","value":"3"},{"name":"enforcer_admin_pwd","value":"admin"},{"name":"REDIS_USERNAME","value":"default"},{"name":"REDIS_PASSWORD","value":""},{"name":"REDIS_HOST","value":"redis-master"},{"name":"REDIS_PORT","value":"6379"},{"name":"IS_REDIS_TLS_ENABLED","value":"false"},{"name":"REDIS_REVOKED_TOKENS_CHANNEL","value":"wso2-apk-revoked-tokens-channel"},{"name":"REDIS_KEY_FILE","value":"/home/wso2/security/truststore/enforcer.key"},{"name":"REDIS_CERT_FILE","value":"/home/wso2/security/truststore/enforcer.crt"},{"name":"REDIS_CA_CERT_FILE","value":"/home/wso2/security/truststore/enforcer.crt"},{"name":"REVOKED_TOKEN_CLEANUP_INTERVAL","value":"3600"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"enforcer","ports":[{"containerPort":8081,"protocol":"TCP"},{"containerPort":9001,"protocol":"TCP"},{"containerPort":5006,"protocol":"TCP"},{"containerPort":8084,"protocol":"TCP"},{"containerPort":9092,"protocol":"TCP"},{"containerPort":18002,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"200m","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true,"runAsNonRoot":true},"volumeMounts":[{"mountPath":"/tmp","name":"tmp"},{"mountPath":"/home/wso2/security/keystore/enforcer.key","name":"enforcer-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/enforcer.crt","name":"enforcer-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/apk.crt","name":"enforcer-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/enforcer.crt","name":"enforcer-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter.crt","name":"adapter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/router.crt","name":"router-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/check_health.sh","name":"enforcer-health-check-volume","subPath":"check_health.sh"},{"mountPath":"/home/wso2/security/keystore/mg.pem","name":"enforcer-jwt-secret-volume","subPath":"mg.pem"},{"mountPath":"/home/wso2/security/truststore/mg.pem","name":"enforcer-jwt-secret-volume","subPath":"mg.pem"},{"mountPath":"/home/wso2/security/keystore/mg.key","name":"enforcer-jwt-secret-volume","subPath":"mg.key"},{"mountPath":"/home/wso2/security/truststore/wso2carbon.pem","name":"enforcer-trusted-certs","subPath":"wso2carbon.pem"},{"mountPath":"/home/wso2/security/truststore/wso2-apim-carbon.pem","name":"enforcer-apikey-cert","subPath":"wso2-apim-carbon.pem"},{"mountPath":"/home/wso2/security/truststore/idp.pem","name":"idp-certificate-secret-volume","subPath":"wso2carbon.pem"},{"mountPath":"/home/wso2/security/truststore/ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter-ca.crt","name":"ratelimiter-truststore-secret-volume","subPath":"ca.crt"}]},{"env":[{"name":"ADAPTER_HOST_NAME","value":"apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc"},{"name":"ADAPTER_HOST","value":"apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc"},{"name":"ENFORCER_HOST","value":"127.0.0.1"},{"name":"ENFORCER_ANALYTICS_HOST","value":"127.0.0.1"},{"name":"ROUTER_ADMIN_HOST","value":"0.0.0.0"},{"name":"ROUTER_ADMIN_PORT","value":"9000"},{"name":"ROUTER_PORT","value":"9095"},{"name":"ROUTER_CLUSTER","value":"apk_router_cluster"},{"name":"ROUTER_LABEL","value":"wso2-apk-default"},{"name":"ROUTER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/router.key"},{"name":"ROUTER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/router.crt"},{"name":"ADAPTER_PORT","value":"18000"},{"name":"ADAPTER_CA_CERT_PATH","value":"/home/wso2/security/truststore/adapter.crt"},{"name":"ENFORCER_PORT","value":"8081"},{"name":"ENFORCER_ANALYTICS_RECEIVER_PORT","value":"18090"},{"name":"ENFORCER_CA_CERT_PATH","value":"/home/wso2/security/truststore/enforcer.crt"},{"name":"CONCURRENCY","value":"2"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","router_check_health.sh","health"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"router","ports":[{"containerPort":9095,"protocol":"TCP"},{"containerPort":9090,"protocol":"TCP"},{"containerPort":9091,"protocol":"TCP"},{"containerPort":9000,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","router_check_health.sh","health"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"1000m","memory":"1028Mi"},"requests":{"cpu":"200m","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true,"runAsNonRoot":true},"startupProbe":{"exec":{"command":["sh","router_check_health.sh","health"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/router.key","name":"router-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/router.crt","name":"router-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter.crt","name":"adapter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/enforcer.crt","name":"enforcer-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/security/truststore/ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter-ca.crt","name":"ratelimiter-truststore-secret-volume","subPath":"ca.crt"}]}],"securityContext":{"seccompProfile":{"type":"RuntimeDefault"}},"volumes":[{"name":"ratelimiter-truststore-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-ratelimiter-server-cert"}},{"name":"enforcer-keystore-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-server-cert"}},{"configMap":{"name":"apptest-9eyndrif-wso2-apk-log-conf"},"name":"log-conf-volume"},{"configMap":{"name":"apptest-9eyndrif-wso2-apk-enforcer-grpc-probe-script-conf"},"name":"enforcer-health-check-volume"},{"name":"router-keystore-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-gateway-server-cert"}},{"name":"adapter-truststore-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-adapter-server-cert"}},{"name":"enforcer-jwt-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-keystore-secret"}},{"name":"enforcer-trusted-certs","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-truststore-secret"}},{"name":"enforcer-apikey-cert","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-truststore-secret"}},{"name":"idp-certificate-secret-volume","secret":{"secretName":"apptest-9eyndrif-wso2-apk-enforcer-truststore-secret"}},{"emptyDir":{},"name":"tmp"}]}}}}
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671890132255022"
    uid: 878e0199-ec7c-41ea-9df8-e6ec61fbeb8a
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: gateway
        app.kubernetes.io/release: apptest-9eyndrif
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: gateway
          app.kubernetes.io/release: apptest-9eyndrif
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - gateway-runtime
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: TOKEN_REVOCATION_ENABLED
            value: "true"
          - name: ADAPTER_HOST_NAME
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: ADAPTER_HOST
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: COMMON_CONTROLLER_HOST_NAME
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          - name: COMMON_CONTROLLER_HOST
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          - name: RATELIMITER_HOST
            value: apptest-9eyndrif-wso2-apk-ratelimiter-service.apptest-9eyndrif.svc
          - name: ENFORCER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/enforcer.key
          - name: ENFORCER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/enforcer.crt
          - name: ENFORCER_SERVER_NAME
            value: apptest-9eyndrif-wso2-apk-enforcer-service.apptest-9eyndrif.svc
          - name: TRUSTED_CA_CERTS_PATH
            value: /home/wso2/security/truststore
          - name: ADAPTER_XDS_PORT
            value: "18000"
          - name: RATELIMITER_PORT
            value: "8091"
          - name: COMMON_CONTROLLER_XDS_PORT
            value: "18002"
          - name: COMMON_CONTROLLER_REST_PORT
            value: "18003"
          - name: ENFORCER_LABEL
            value: wso2-apk-default
          - name: ENFORCER_REGION
            value: UNKNOWN
          - name: XDS_MAX_MSG_SIZE
            value: "4194304"
          - name: XDS_MAX_RETRIES
            value: "3"
          - name: enforcer_admin_pwd
            value: admin
          - name: REDIS_USERNAME
            value: default
          - name: REDIS_PASSWORD
          - name: REDIS_HOST
            value: redis-master
          - name: REDIS_PORT
            value: "6379"
          - name: IS_REDIS_TLS_ENABLED
            value: "false"
          - name: REDIS_REVOKED_TOKENS_CHANNEL
            value: wso2-apk-revoked-tokens-channel
          - name: REDIS_KEY_FILE
            value: /home/wso2/security/truststore/enforcer.key
          - name: REDIS_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REDIS_CA_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REVOKED_TOKEN_CLEANUP_INTERVAL
            value: "3600"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: enforcer
          ports:
          - containerPort: 8081
            protocol: TCP
          - containerPort: 9001
            protocol: TCP
          - containerPort: 5006
            protocol: TCP
          - containerPort: 8084
            protocol: TCP
          - containerPort: 9092
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 512Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2/security/keystore/enforcer.key
            name: enforcer-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk.crt
            name: enforcer-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/check_health.sh
            name: enforcer-health-check-volume
            subPath: check_health.sh
          - mountPath: /home/wso2/security/keystore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/truststore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/keystore/mg.key
            name: enforcer-jwt-secret-volume
            subPath: mg.key
          - mountPath: /home/wso2/security/truststore/wso2carbon.pem
            name: enforcer-trusted-certs
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
          - mountPath: /home/wso2/security/truststore/idp.pem
            name: idp-certificate-secret-volume
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        - env:
          - name: ADAPTER_HOST_NAME
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: ADAPTER_HOST
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: ENFORCER_HOST
            value: 127.0.0.1
          - name: ENFORCER_ANALYTICS_HOST
            value: 127.0.0.1
          - name: ROUTER_ADMIN_HOST
            value: 0.0.0.0
          - name: ROUTER_ADMIN_PORT
            value: "9000"
          - name: ROUTER_PORT
            value: "9095"
          - name: ROUTER_CLUSTER
            value: apk_router_cluster
          - name: ROUTER_LABEL
            value: wso2-apk-default
          - name: ROUTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/router.key
          - name: ROUTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/router.crt
          - name: ADAPTER_PORT
            value: "18000"
          - name: ADAPTER_CA_CERT_PATH
            value: /home/wso2/security/truststore/adapter.crt
          - name: ENFORCER_PORT
            value: "8081"
          - name: ENFORCER_ANALYTICS_RECEIVER_PORT
            value: "18090"
          - name: ENFORCER_CA_CERT_PATH
            value: /home/wso2/security/truststore/enforcer.crt
          - name: CONCURRENCY
            value: "2"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: router
          ports:
          - containerPort: 9095
            protocol: TCP
          - containerPort: 9090
            protocol: TCP
          - containerPort: 9091
            protocol: TCP
          - containerPort: 9000
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "1"
              memory: 1028Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          startupProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/router.key
            name: router-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
        - name: enforcer-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-log-conf
          name: log-conf-volume
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-enforcer-grpc-probe-script-conf
          name: enforcer-health-check-volume
        - name: router-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-gateway-server-cert
        - name: adapter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-adapter-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-keystore-secret
        - name: enforcer-trusted-certs
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
        - name: idp-certificate-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
        - emptyDir: {}
          name: tmp
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: ReplicaSet "apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif-wso2-apk-ratelimiter-deployment","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"ratelimiter","app.kubernetes.io/release":"apptest-9eyndrif"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"labels":{"app.kubernetes.io/app":"ratelimiter","app.kubernetes.io/release":"apptest-9eyndrif"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["rate-limiter"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"automountServiceAccountToken":false,"containers":[{"env":[{"name":"HOST","value":"0.0.0.0"},{"name":"PORT","value":"8090"},{"name":"USE_STATSD","value":"false"},{"name":"LOG_LEVEL","value":"DEBUG"},{"name":"LIMIT_RESPONSE_HEADERS_ENABLED","value":"false"},{"name":"REDIS_TYPE","value":"single"},{"name":"REDIS_SOCKET_TYPE","value":"tcp"},{"name":"REDIS_URL","value":"redis-master:6379"},{"name":"REDIS_PIPELINE_WINDOW","value":"0.2ms"},{"name":"REDIS_PIPELINE_LIMIT","value":"0"},{"name":"GRPC_HOST","value":"0.0.0.0"},{"name":"GRPC_PORT","value":"8091"},{"name":"GRPC_SERVER_USE_TLS","value":"true"},{"name":"GRPC_SERVER_TLS_KEY","value":"/home/wso2/security/keystore/ratelimiter.key"},{"name":"GRPC_SERVER_TLS_CERT","value":"/home/wso2/security/keystore/ratelimiter.crt"},{"name":"GRPC_CLIENT_TLS_CACERT","value":"/home/wso2/security/truststore/ratelimiter-ca.crt"},{"name":"RATELIMITER_LABEL","value":"ratelimiter"},{"name":"CONFIG_GRPC_XDS_SERVER_URL","value":"apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc:18005"},{"name":"CONFIG_GRPC_XDS_SERVER_USE_TLS","value":"true"},{"name":"CONFIG_GRPC_XDS_CLIENT_TLS_KEY","value":"/home/wso2/security/keystore/ratelimiter.key"},{"name":"CONFIG_GRPC_XDS_CLIENT_TLS_CERT","value":"/home/wso2/security/keystore/ratelimiter.crt"},{"name":"CONFIG_GRPC_XDS_SERVER_TLS_CACERT","value":"/home/wso2/security/truststore/ratelimiter-ca.crt"},{"name":"CONFIG_GRPC_XDS_SERVER_TLS_SAN","value":"apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5","imagePullPolicy":"Always","livenessProbe":{"failureThreshold":5,"httpGet":{"path":"/healthcheck","port":8090,"scheme":"HTTP"},"initialDelaySeconds":20,"periodSeconds":20},"name":"ratelimiter","ports":[{"containerPort":8090,"protocol":"TCP"},{"containerPort":8091,"protocol":"TCP"},{"containerPort":6070,"protocol":"TCP"}],"readinessProbe":{"failureThreshold":5,"httpGet":{"path":"/healthcheck","port":8090,"scheme":"HTTP"},"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"50m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/ratelimiter.key","name":"ratelimiter-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/ratelimiter.crt","name":"ratelimiter-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter-ca.crt","name":"ratelimiter-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/adapter.pem","name":"common-controller-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/router.pem","name":"router-truststore-secret-volume","subPath":"tls.crt"}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"name":"ratelimiter-keystore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-9eyndrif-wso2-apk-ratelimiter-server-cert"}},{"name":"common-controller-truststore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-9eyndrif-wso2-apk-common-controller-server-cert"}},{"name":"router-truststore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-9eyndrif-wso2-apk-gateway-server-cert"}}]}}}}
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif-wso2-apk-ratelimiter-deployment
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671889968143003"
    uid: 1f551e74-6c48-459a-b58d-4eb34c076905
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: ratelimiter
        app.kubernetes.io/release: apptest-9eyndrif
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: ratelimiter
          app.kubernetes.io/release: apptest-9eyndrif
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - rate-limiter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: HOST
            value: 0.0.0.0
          - name: PORT
            value: "8090"
          - name: USE_STATSD
            value: "false"
          - name: LOG_LEVEL
            value: DEBUG
          - name: LIMIT_RESPONSE_HEADERS_ENABLED
            value: "false"
          - name: REDIS_TYPE
            value: single
          - name: REDIS_SOCKET_TYPE
            value: tcp
          - name: REDIS_URL
            value: redis-master:6379
          - name: REDIS_PIPELINE_WINDOW
            value: 0.2ms
          - name: REDIS_PIPELINE_LIMIT
            value: "0"
          - name: GRPC_HOST
            value: 0.0.0.0
          - name: GRPC_PORT
            value: "8091"
          - name: GRPC_SERVER_USE_TLS
            value: "true"
          - name: GRPC_SERVER_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: GRPC_SERVER_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: GRPC_CLIENT_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: RATELIMITER_LABEL
            value: ratelimiter
          - name: CONFIG_GRPC_XDS_SERVER_URL
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc:18005
          - name: CONFIG_GRPC_XDS_SERVER_USE_TLS
            value: "true"
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_SAN
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: ratelimiter
          ports:
          - containerPort: 8090
            protocol: TCP
          - containerPort: 8091
            protocol: TCP
          - containerPort: 6070
            protocol: TCP
          readinessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 100m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/ratelimiter.key
            name: ratelimiter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/ratelimiter.crt
            name: ratelimiter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/adapter.pem
            name: common-controller-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.pem
            name: router-truststore-secret-volume
            subPath: tls.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
        - name: common-controller-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-common-controller-server-cert
        - name: router-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-gateway-server-cert
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:38:09Z"
      lastUpdateTime: "2025-12-02T10:38:09Z"
      message: ReplicaSet "apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/app: apim-apk-agent
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/name: apkagent
      pod-template-hash: bdb54d4f9
    name: apkagent-bdb54d4f9
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apkagent
      uid: df92aaca-e8e9-4719-9064-ba87a4227810
    resourceVersion: "1764671890120399008"
    uid: 34220e23-a412-43b8-872d-c82d9ed6b1a9
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: apim-apk-agent
        app.kubernetes.io/instance: apptest-9eyndrif
        app.kubernetes.io/name: apkagent
        pod-template-hash: bdb54d4f9
    template:
      metadata:
        annotations:
          checksum/config: 4318f92538a0228523d71227b6ba9838cd2a6096902dc9a5a99e5dc82946d4fd
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: apim-apk-agent
          app.kubernetes.io/instance: apptest-9eyndrif
          app.kubernetes.io/name: apkagent
          pod-template-hash: bdb54d4f9
      spec:
        containers:
        - env:
          - name: APIM_APK_AGENT_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/apk-agent.key
          - name: APIM_APK_AGENT_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/apk-agent.crt
          - name: APIM_APK_AGENT_SERVER_NAME
            value: apim-apk-agent-service.apptest-9eyndrif.svc
          - name: APIM_APK_AGENT_GRPC_PORT
            value: "18000"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: apkagent
          ports:
          - containerPort: 18000
            name: grpc-port
            protocol: TCP
          - containerPort: 18001
            name: rest-port
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 128Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/keystore/apk-agent.key
            name: apk-agent-certificates
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/apk-agent.crt
            name: apk-agent-certificates
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
            name: apk-agent-certificates
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: wso2agent-platform
        serviceAccountName: wso2agent-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-log-conf
          name: log-conf-volume
        - name: apk-agent-certificates
          secret:
            defaultMode: 420
            secretName: apk-agent-server-cert
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "1"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:38:08Z"
    generation: 1
    labels:
      deployment: apptest-9eyndrif-acp
      node: apptest-9eyndrif-acp-1
      pod-template-hash: 69d5775498
      product: apim
    name: apptest-9eyndrif-acp-deployment-1-69d5775498
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-9eyndrif-acp-deployment-1
      uid: 6dbb970e-9917-4c84-9174-edce77984019
    resourceVersion: "1764671888920911000"
    uid: f1c3651e-af1f-45de-a430-55e25af651dd
  spec:
    replicas: 1
    selector:
      matchLabels:
        deployment: apptest-9eyndrif-acp
        node: apptest-9eyndrif-acp-1
        pod-template-hash: 69d5775498
    template:
      metadata:
        annotations:
          checksum.am.cp.conf: 29253449acd118148e223f852c8225f78c6024f319555bfa9b3934da7984fdcc
          checksum.am.cp.conf.log4j2: 5166ece53af100d4fcaad01e127ffac9213bae9a3aa7f47f5e1eee1459fa3da0
          checksum.am.cp.conf.secret: 6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb
          cloudmarketplace.googleapis.com/product.metadata: v1:{"services":[{"service_name":"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog",
            "service_level":"default"}]}
        creationTimestamp: null
        labels:
          deployment: apptest-9eyndrif-acp
          node: apptest-9eyndrif-acp-1
          pod-template-hash: 69d5775498
          product: apim
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: deployment
                    operator: In
                    values:
                    - apptest-9eyndrif-acp
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: PROFILE_NAME
            value: default
          - name: NODE_IP
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: status.podIP
          - name: JVM_MEM_OPTS
            value: -Xms2048m -Xmx2048m
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
          imagePullPolicy: Always
          lifecycle:
            preStop:
              exec:
                command:
                - sh
                - -c
                - |
                  echo "Pre stop hook triggered"; sleep 10; echo "Shutdown APIM Server"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          name: wso2am-control-plane
          ports:
          - containerPort: 9763
            protocol: TCP
          - containerPort: 9443
            protocol: TCP
          - containerPort: 9711
            protocol: TCP
          - containerPort: 9611
            protocol: TCP
          - containerPort: 5672
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "3"
              memory: 5Gi
            requests:
              cpu: "2"
              memory: 2Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - all
            runAsNonRoot: true
            runAsUser: 10001
          startupProbe:
            exec:
              command:
              - /bin/sh
              - -c
              - timeout 1 bash -c "</dev/tcp/localhost/9443"
            failureThreshold: 3
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
            name: wso2am-control-plane-conf
            subPath: deployment.toml
          - mountPath: /home/wso2carbon/docker-entrypoint.sh
            name: wso2am-control-plane-entrypoint
            subPath: docker-entrypoint.sh
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
            name: wso2am-control-plane-log4j2
            subPath: log4j2.properties
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
            name: wso2am-conf-admin-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
            name: wso2am-conf-devportal-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
            name: wso2am-conf-publisher-settings
            subPath: settings.json
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-1
          name: wso2am-control-plane-conf
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-entrypoint
          name: wso2am-control-plane-entrypoint
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-log4j2
          name: wso2am-control-plane-log4j2
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-admin-settings
          name: wso2am-conf-admin-settings
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-devportal-settings
          name: wso2am-conf-devportal-settings
        - configMap:
            defaultMode: 263
            name: apptest-9eyndrif-acp-conf-publisher-settings
          name: wso2am-conf-publisher-settings
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:38:08Z"
    generation: 1
    labels:
      app.kubernetes.io/app: adapter
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 68cfd86db5
    name: apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-9eyndrif-wso2-apk-adapter-deployment
      uid: 12997ce1-f3bc-4c90-98c8-19a47e15dd6a
    resourceVersion: "1764671889148175015"
    uid: 1776d696-5a2e-4c0d-a317-888fd7dda833
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: adapter
        app.kubernetes.io/release: apptest-9eyndrif
        pod-template-hash: 68cfd86db5
    template:
      metadata:
        annotations:
          checksum/config: a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: adapter
          app.kubernetes.io/release: apptest-9eyndrif
          pod-template-hash: 68cfd86db5
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - adapter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: ADAPTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/adapter.key
          - name: ADAPTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/adapter.crt
          - name: ADAPTER_SERVER_NAME
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: adapter
          ports:
          - containerPort: 18000
            protocol: TCP
          - containerPort: 8765
            protocol: TCP
          - containerPort: 18005
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/adapter.key
            name: adapter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/adapter.crt
            name: adapter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: adapter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/consul
            name: adapter-truststore-consul-secret-volume
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: adapter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-adapter-server-cert
        - name: adapter-truststore-consul-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-adapter-truststore-consul-secret
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-log-conf
          name: log-conf-volume
        - emptyDir: {}
          name: router-truststore-secret-volume
        - name: enforcer-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-server-cert
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/app: commoncontroller
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 97d849d4c
    name: apptest-9eyndrif-wso2-apk-common-controller-deployment-97d849d4c
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-9eyndrif-wso2-apk-common-controller-deployment
      uid: 52840176-92e5-49ba-93f9-108faec858b7
    resourceVersion: "1764671889380239003"
    uid: 014cb46b-ab71-4c39-8f5e-53fb14ec9839
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: commoncontroller
        app.kubernetes.io/release: apptest-9eyndrif
        pod-template-hash: 97d849d4c
    template:
      metadata:
        annotations:
          checksum/config: b3a8bb587ccf599df39588f11ec45c9cf0e00707f97be595291cb9691c881cc9
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: commoncontroller
          app.kubernetes.io/release: apptest-9eyndrif
          pod-template-hash: 97d849d4c
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - common-controller
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: COMMON_CONTROLLER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/commoncontroller.key
          - name: COMMON_CONTROLLER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/commoncontroller.crt
          - name: COMMON_CONTROLLER_SERVER_NAME
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: commoncontroller
          ports:
          - containerPort: 18005
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          - containerPort: 9543
            protocol: TCP
          - containerPort: 18003
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/commoncontroller.key
            name: common-controller-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/commoncontroller.crt
            name: common-controller-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: common-controller-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /tmp/k8s-webhook-server/serving-certs
            name: adapter-webhook-server-cert
            readOnly: true
          - mountPath: /home/wso2/security/sts/
            name: sts-shared-auth-key
            readOnly: true
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: common-controller-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-common-controller-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-common-log-conf
          name: log-conf-volume
        - name: adapter-webhook-server-cert
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-webhook-server-cert
        - name: sts-shared-auth-key
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-sts-shared-auth-key
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:38:08Z"
    generation: 1
    labels:
      app.kubernetes.io/app: configdeployer-ds
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 5b859c7798
    name: apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-9eyndrif-wso2-apk-config-ds-deployment
      uid: c7f25acc-7960-4b5f-8817-e6933daeb230
    resourceVersion: "1764671888952463024"
    uid: afbbf905-5b50-464c-8e28-6330144100c1
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: configdeployer-ds
        app.kubernetes.io/release: apptest-9eyndrif
        pod-template-hash: 5b859c7798
    template:
      metadata:
        annotations:
          checksum/config: 318c98d870e099004833cb9bcf909cdbc1ac684e2b2782b55a98bf8700d8f05b
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: configdeployer-ds
          app.kubernetes.io/release: apptest-9eyndrif
          pod-template-hash: 5b859c7798
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - config-ds
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: config-ds
          ports:
          - containerPort: 9443
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 1Gi
            requests:
              cpu: 200m
              memory: 512Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
            name: config-toml-volume
            subPath: Config.toml
          - mountPath: /home/wso2apk/config-deployer/security/config.key
            name: config-ds-tls-volume
            subPath: tls.key
          - mountPath: /home/wso2apk/config-deployer/security/config.pem
            name: config-ds-tls-volume
            subPath: tls.crt
          - mountPath: /home/wso2apk/config-deployer/security/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2apk/config-deployer/tmp
            name: config-deployer-temp
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-config-ds-configmap
          name: config-toml-volume
        - name: config-ds-tls-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-config-ds-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-keystore-secret
        - emptyDir: {}
          name: tmp
        - emptyDir: {}
          name: config-deployer-temp
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 5b449f9649
    name: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449f9649
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-9eyndrif-wso2-apk-gateway-runtime-deployment
      uid: 878e0199-ec7c-41ea-9df8-e6ec61fbeb8a
    resourceVersion: "1764671889923775018"
    uid: 1d1c32a3-2d3f-4b11-b6a2-d8a4b42a1935
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: gateway
        app.kubernetes.io/release: apptest-9eyndrif
        pod-template-hash: 5b449f9649
    template:
      metadata:
        annotations:
          checksum/config: a0d4dc8d3c9ccf071716d6fe3555f81d5d6af3550a7b6fc8b92e4851eb34583d
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: gateway
          app.kubernetes.io/release: apptest-9eyndrif
          pod-template-hash: 5b449f9649
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - gateway-runtime
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: TOKEN_REVOCATION_ENABLED
            value: "true"
          - name: ADAPTER_HOST_NAME
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: ADAPTER_HOST
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: COMMON_CONTROLLER_HOST_NAME
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          - name: COMMON_CONTROLLER_HOST
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          - name: RATELIMITER_HOST
            value: apptest-9eyndrif-wso2-apk-ratelimiter-service.apptest-9eyndrif.svc
          - name: ENFORCER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/enforcer.key
          - name: ENFORCER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/enforcer.crt
          - name: ENFORCER_SERVER_NAME
            value: apptest-9eyndrif-wso2-apk-enforcer-service.apptest-9eyndrif.svc
          - name: TRUSTED_CA_CERTS_PATH
            value: /home/wso2/security/truststore
          - name: ADAPTER_XDS_PORT
            value: "18000"
          - name: RATELIMITER_PORT
            value: "8091"
          - name: COMMON_CONTROLLER_XDS_PORT
            value: "18002"
          - name: COMMON_CONTROLLER_REST_PORT
            value: "18003"
          - name: ENFORCER_LABEL
            value: wso2-apk-default
          - name: ENFORCER_REGION
            value: UNKNOWN
          - name: XDS_MAX_MSG_SIZE
            value: "4194304"
          - name: XDS_MAX_RETRIES
            value: "3"
          - name: enforcer_admin_pwd
            value: admin
          - name: REDIS_USERNAME
            value: default
          - name: REDIS_PASSWORD
          - name: REDIS_HOST
            value: redis-master
          - name: REDIS_PORT
            value: "6379"
          - name: IS_REDIS_TLS_ENABLED
            value: "false"
          - name: REDIS_REVOKED_TOKENS_CHANNEL
            value: wso2-apk-revoked-tokens-channel
          - name: REDIS_KEY_FILE
            value: /home/wso2/security/truststore/enforcer.key
          - name: REDIS_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REDIS_CA_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REVOKED_TOKEN_CLEANUP_INTERVAL
            value: "3600"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: enforcer
          ports:
          - containerPort: 8081
            protocol: TCP
          - containerPort: 9001
            protocol: TCP
          - containerPort: 5006
            protocol: TCP
          - containerPort: 8084
            protocol: TCP
          - containerPort: 9092
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 512Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2/security/keystore/enforcer.key
            name: enforcer-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk.crt
            name: enforcer-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/check_health.sh
            name: enforcer-health-check-volume
            subPath: check_health.sh
          - mountPath: /home/wso2/security/keystore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/truststore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/keystore/mg.key
            name: enforcer-jwt-secret-volume
            subPath: mg.key
          - mountPath: /home/wso2/security/truststore/wso2carbon.pem
            name: enforcer-trusted-certs
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
          - mountPath: /home/wso2/security/truststore/idp.pem
            name: idp-certificate-secret-volume
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        - env:
          - name: ADAPTER_HOST_NAME
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: ADAPTER_HOST
            value: apptest-9eyndrif-wso2-apk-adapter-service.apptest-9eyndrif.svc
          - name: ENFORCER_HOST
            value: 127.0.0.1
          - name: ENFORCER_ANALYTICS_HOST
            value: 127.0.0.1
          - name: ROUTER_ADMIN_HOST
            value: 0.0.0.0
          - name: ROUTER_ADMIN_PORT
            value: "9000"
          - name: ROUTER_PORT
            value: "9095"
          - name: ROUTER_CLUSTER
            value: apk_router_cluster
          - name: ROUTER_LABEL
            value: wso2-apk-default
          - name: ROUTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/router.key
          - name: ROUTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/router.crt
          - name: ADAPTER_PORT
            value: "18000"
          - name: ADAPTER_CA_CERT_PATH
            value: /home/wso2/security/truststore/adapter.crt
          - name: ENFORCER_PORT
            value: "8081"
          - name: ENFORCER_ANALYTICS_RECEIVER_PORT
            value: "18090"
          - name: ENFORCER_CA_CERT_PATH
            value: /home/wso2/security/truststore/enforcer.crt
          - name: CONCURRENCY
            value: "2"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: router
          ports:
          - containerPort: 9095
            protocol: TCP
          - containerPort: 9090
            protocol: TCP
          - containerPort: 9091
            protocol: TCP
          - containerPort: 9000
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "1"
              memory: 1028Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          startupProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/router.key
            name: router-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
        - name: enforcer-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-log-conf
          name: log-conf-volume
        - configMap:
            defaultMode: 420
            name: apptest-9eyndrif-wso2-apk-enforcer-grpc-probe-script-conf
          name: enforcer-health-check-volume
        - name: router-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-gateway-server-cert
        - name: adapter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-adapter-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-keystore-secret
        - name: enforcer-trusted-certs
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
        - name: idp-certificate-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-enforcer-truststore-secret
        - emptyDir: {}
          name: tmp
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/app: ratelimiter
      app.kubernetes.io/release: apptest-9eyndrif
      pod-template-hash: 5966c885bc
    name: apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bc
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-9eyndrif-wso2-apk-ratelimiter-deployment
      uid: 1f551e74-6c48-459a-b58d-4eb34c076905
    resourceVersion: "1764671889847311013"
    uid: d6883655-9248-4814-961a-9146714ed1bc
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: ratelimiter
        app.kubernetes.io/release: apptest-9eyndrif
        pod-template-hash: 5966c885bc
    template:
      metadata:
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: ratelimiter
          app.kubernetes.io/release: apptest-9eyndrif
          pod-template-hash: 5966c885bc
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - rate-limiter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: HOST
            value: 0.0.0.0
          - name: PORT
            value: "8090"
          - name: USE_STATSD
            value: "false"
          - name: LOG_LEVEL
            value: DEBUG
          - name: LIMIT_RESPONSE_HEADERS_ENABLED
            value: "false"
          - name: REDIS_TYPE
            value: single
          - name: REDIS_SOCKET_TYPE
            value: tcp
          - name: REDIS_URL
            value: redis-master:6379
          - name: REDIS_PIPELINE_WINDOW
            value: 0.2ms
          - name: REDIS_PIPELINE_LIMIT
            value: "0"
          - name: GRPC_HOST
            value: 0.0.0.0
          - name: GRPC_PORT
            value: "8091"
          - name: GRPC_SERVER_USE_TLS
            value: "true"
          - name: GRPC_SERVER_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: GRPC_SERVER_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: GRPC_CLIENT_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: RATELIMITER_LABEL
            value: ratelimiter
          - name: CONFIG_GRPC_XDS_SERVER_URL
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc:18005
          - name: CONFIG_GRPC_XDS_SERVER_USE_TLS
            value: "true"
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_SAN
            value: apptest-9eyndrif-wso2-apk-common-controller-service.apptest-9eyndrif.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: ratelimiter
          ports:
          - containerPort: 8090
            protocol: TCP
          - containerPort: 8091
            protocol: TCP
          - containerPort: 6070
            protocol: TCP
          readinessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 100m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/ratelimiter.key
            name: ratelimiter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/ratelimiter.crt
            name: ratelimiter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/adapter.pem
            name: common-controller-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.pem
            name: router-truststore-secret-volume
            subPath: tls.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-ratelimiter-server-cert
        - name: common-controller-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-common-controller-server-cert
        - name: router-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-wso2-apk-gateway-server-cert
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: StatefulSet
  metadata:
    annotations:
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"},"name":"redis-master","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"replicas":1,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/name":"redis"}},"serviceName":"redis-headless","template":{"metadata":{"annotations":{"checksum/configmap":"2a9ab4a5432825504d910f022638674ce88eaefe9f9f595ad8bc107377d104fb","checksum/health":"aff24913d801436ea469d8d374b2ddb3ec4c43ee7ab24663d5f8ff1a1b6991a9","checksum/scripts":"bdec350b84a1ace7cc118db113a21c9f160bde3425b07714e1c0c1da722621cf","checksum/secret":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a"},"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"}},"spec":{"affinity":{"nodeAffinity":null,"podAffinity":null,"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/name":"redis"}},"topologyKey":"kubernetes.io/hostname"},"weight":1}]}},"automountServiceAccountToken":false,"containers":[{"args":["-c","/opt/bitnami/scripts/start-scripts/start-master.sh"],"command":["/bin/bash"],"env":[{"name":"BITNAMI_DEBUG","value":"true"},{"name":"REDIS_REPLICATION_MODE","value":"master"},{"name":"ALLOW_EMPTY_PASSWORD","value":"yes"},{"name":"REDIS_TLS_ENABLED","value":"no"},{"name":"REDIS_PORT","value":"6379"}],"image":"docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["sh","-c","/health/ping_liveness_local.sh 5"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":5,"successThreshold":1,"timeoutSeconds":6},"name":"redis","ports":[{"containerPort":6379,"name":"redis"}],"readinessProbe":{"exec":{"command":["sh","-c","/health/ping_readiness_local.sh 1"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":5,"successThreshold":1,"timeoutSeconds":2},"resources":{"limits":{"cpu":"150m","ephemeral-storage":"2Gi","memory":"192Mi"},"requests":{"cpu":"100m","ephemeral-storage":"50Mi","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true,"runAsGroup":1001,"runAsNonRoot":true,"seLinuxOptions":{},"seccompProfile":{"type":"RuntimeDefault"}},"volumeMounts":[{"mountPath":"/opt/bitnami/scripts/start-scripts","name":"start-scripts"},{"mountPath":"/health","name":"health"},{"mountPath":"/data","name":"redis-data"},{"mountPath":"/opt/bitnami/redis/mounted-etc","name":"config"},{"mountPath":"/opt/bitnami/redis/etc/","name":"empty-dir","subPath":"app-conf-dir"},{"mountPath":"/tmp","name":"empty-dir","subPath":"tmp-dir"}]}],"enableServiceLinks":true,"securityContext":{"fsGroup":1001,"fsGroupChangePolicy":"Always","runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"},"supplementalGroups":[],"sysctls":[]},"serviceAccountName":"redis-master","terminationGracePeriodSeconds":30,"volumes":[{"configMap":{"defaultMode":493,"name":"redis-scripts"},"name":"start-scripts"},{"configMap":{"defaultMode":493,"name":"redis-health"},"name":"health"},{"configMap":{"name":"redis-configuration"},"name":"config"},{"emptyDir":{},"name":"empty-dir"}]}},"updateStrategy":{"type":"RollingUpdate"},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-9eyndrif","app.kubernetes.io/name":"redis"},"name":"redis-data"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"8Gi"}}}}]}}
    creationTimestamp: "2025-12-02T10:38:09Z"
    generation: 1
    labels:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-9eyndrif
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      helm.sh/chart: redis-20.10.0
    name: redis-master
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671890493263020"
    uid: c007709f-c306-4e31-bc3c-705a8e79cacf
  spec:
    persistentVolumeClaimRetentionPolicy:
      whenDeleted: Retain
      whenScaled: Retain
    podManagementPolicy: OrderedReady
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/component: master
        app.kubernetes.io/instance: apptest-9eyndrif
        app.kubernetes.io/name: redis
    serviceName: redis-headless
    template:
      metadata:
        annotations:
          checksum/configmap: 2a9ab4a5432825504d910f022638674ce88eaefe9f9f595ad8bc107377d104fb
          checksum/health: aff24913d801436ea469d8d374b2ddb3ec4c43ee7ab24663d5f8ff1a1b6991a9
          checksum/scripts: bdec350b84a1ace7cc118db113a21c9f160bde3425b07714e1c0c1da722621cf
          checksum/secret: 44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a
        creationTimestamp: null
        labels:
          app.kubernetes.io/component: master
          app.kubernetes.io/instance: apptest-9eyndrif
          app.kubernetes.io/managed-by: Helm
          app.kubernetes.io/name: redis
          app.kubernetes.io/version: 7.4.2
          helm.sh/chart: redis-20.10.0
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/component: master
                    app.kubernetes.io/instance: apptest-9eyndrif
                    app.kubernetes.io/name: redis
                topologyKey: kubernetes.io/hostname
              weight: 1
        automountServiceAccountToken: false
        containers:
        - args:
          - -c
          - /opt/bitnami/scripts/start-scripts/start-master.sh
          command:
          - /bin/bash
          env:
          - name: BITNAMI_DEBUG
            value: "true"
          - name: REDIS_REPLICATION_MODE
            value: master
          - name: ALLOW_EMPTY_PASSWORD
            value: "yes"
          - name: REDIS_TLS_ENABLED
            value: "no"
          - name: REDIS_PORT
            value: "6379"
          image: docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4
          imagePullPolicy: IfNotPresent
          livenessProbe:
            exec:
              command:
              - sh
              - -c
              - /health/ping_liveness_local.sh 5
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 6
          name: redis
          ports:
          - containerPort: 6379
            name: redis
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - -c
              - /health/ping_readiness_local.sh 1
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 2
          resources:
            limits:
              cpu: 150m
              ephemeral-storage: 2Gi
              memory: 192Mi
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /opt/bitnami/scripts/start-scripts
            name: start-scripts
          - mountPath: /health
            name: health
          - mountPath: /data
            name: redis-data
          - mountPath: /opt/bitnami/redis/mounted-etc
            name: config
          - mountPath: /opt/bitnami/redis/etc/
            name: empty-dir
            subPath: app-conf-dir
          - mountPath: /tmp
            name: empty-dir
            subPath: tmp-dir
        dnsPolicy: ClusterFirst
        enableServiceLinks: true
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          fsGroup: 1001
          fsGroupChangePolicy: Always
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: redis-master
        serviceAccountName: redis-master
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 493
            name: redis-scripts
          name: start-scripts
        - configMap:
            defaultMode: 493
            name: redis-health
          name: health
        - configMap:
            defaultMode: 420
            name: redis-configuration
          name: config
        - emptyDir: {}
          name: empty-dir
    updateStrategy:
      type: RollingUpdate
    volumeClaimTemplates:
    - apiVersion: v1
      kind: PersistentVolumeClaim
      metadata:
        creationTimestamp: null
        labels:
          app.kubernetes.io/component: master
          app.kubernetes.io/instance: apptest-9eyndrif
          app.kubernetes.io/name: redis
        name: redis-data
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 8Gi
        volumeMode: Filesystem
      status:
        phase: Pending
  status:
    availableReplicas: 0
    collisionCount: 0
    currentReplicas: 1
    currentRevision: redis-master-65d7978ff6
    observedGeneration: 1
    replicas: 1
    updateRevision: redis-master-65d7978ff6
    updatedReplicas: 1
- apiVersion: batch/v1
  kind: Job
  metadata:
    annotations:
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"batch/v1","kind":"Job","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"deployer.marketplace.cloud.google.com","app.kubernetes.io/name":"apptest-9eyndrif","marketplace.cloud.google.com/deployer":"Main"},"name":"apptest-9eyndrif-deployer","namespace":"apptest-9eyndrif","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-9eyndrif","uid":"2221911f-59d8-47f1-9f44-962d1d6fc80f"}]},"spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"spec":{"containers":[{"command":["/bin/deploy_with_tests.sh"],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5","imagePullPolicy":"Always","name":"deployer","resources":{"requests":{"cpu":"100m","memory":"100Mi"}},"volumeMounts":[{"mountPath":"/data/values.yaml","name":"config-volume","readOnly":true,"subPath":"values.yaml"}]}],"restartPolicy":"Never","serviceAccountName":"apptest-9eyndrif-deployer-sa","volumes":[{"name":"config-volume","secret":{"secretName":"apptest-9eyndrif-deployer-config"}}]}}}}
    creationTimestamp: "2025-12-02T10:37:36Z"
    generation: 1
    labels:
      app.kubernetes.io/component: deployer.marketplace.cloud.google.com
      app.kubernetes.io/name: apptest-9eyndrif
      marketplace.cloud.google.com/deployer: Main
    name: apptest-9eyndrif-deployer
    namespace: apptest-9eyndrif
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-9eyndrif
      uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
    resourceVersion: "1764671894842415003"
    uid: 1863ac4c-a1cc-4d38-a6ab-b9cd38985f00
  spec:
    backoffLimit: 0
    completionMode: NonIndexed
    completions: 1
    manualSelector: false
    parallelism: 1
    podReplacementPolicy: TerminatingOrFailed
    selector:
      matchLabels:
        batch.kubernetes.io/controller-uid: 1863ac4c-a1cc-4d38-a6ab-b9cd38985f00
    suspend: false
    template:
      metadata:
        annotations:
          sidecar.istio.io/inject: "false"
        creationTimestamp: null
        labels:
          batch.kubernetes.io/controller-uid: 1863ac4c-a1cc-4d38-a6ab-b9cd38985f00
          batch.kubernetes.io/job-name: apptest-9eyndrif-deployer
          controller-uid: 1863ac4c-a1cc-4d38-a6ab-b9cd38985f00
          job-name: apptest-9eyndrif-deployer
      spec:
        containers:
        - command:
          - /bin/deploy_with_tests.sh
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
          imagePullPolicy: Always
          name: deployer
          resources:
            requests:
              cpu: 100m
              memory: 100Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /data/values.yaml
            name: config-volume
            readOnly: true
            subPath: values.yaml
        dnsPolicy: ClusterFirst
        restartPolicy: Never
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: apptest-9eyndrif-deployer-sa
        serviceAccountName: apptest-9eyndrif-deployer-sa
        terminationGracePeriodSeconds: 30
        volumes:
        - name: config-volume
          secret:
            defaultMode: 420
            secretName: apptest-9eyndrif-deployer-config
  status:
    conditions:
    - lastProbeTime: "2025-12-02T10:38:14Z"
      lastTransitionTime: "2025-12-02T10:38:14Z"
      message: Job has reached the specified backoff limit
      reason: BackoffLimitExceeded
      status: "True"
      type: FailureTarget
    - lastProbeTime: "2025-12-02T10:38:14Z"
      lastTransitionTime: "2025-12-02T10:38:14Z"
      message: Job has reached the specified backoff limit
      reason: BackoffLimitExceeded
      status: "True"
      type: Failed
    failed: 1
    ready: 0
    startTime: "2025-12-02T10:37:36Z"
    terminating: 0
    uncountedTerminatedPods: {}
- apiVersion: app.k8s.io/v1beta1
  kind: Application
  metadata:
    annotations:
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"app.k8s.io/v1beta1","kind":"Application","metadata":{"annotations":{"kubernetes-engine.cloud.google.com/icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==","marketplace.cloud.google.com/deploy-info":"{\"partner_id\": \"wso2-marketplace-public\", \"product_id\": \"wso2-apim-kubernetes\", \"partner_name\": \"WSO2\"}"},"labels":{"app.kubernetes.io/name":"apptest-9eyndrif"},"name":"apptest-9eyndrif","namespace":"apptest-9eyndrif"},"spec":{"componentKinds":[{"group":"apps/v1","kind":"Deployment"},{"group":"apps/v1","kind":"StatefulSet"},{"group":"v1","kind":"Service"},{"group":"v1","kind":"ConfigMap"},{"group":"v1","kind":"Secret"}],"descriptor":{"description":"WSO2 API Manager provides a complete platform for building, managing, and scaling APIs.","links":[{"description":"User Guide: Getting Started","url":"https://apim.docs.wso2.com/"},{"description":"WSO2 API Manager Documentation","url":"https://apim.docs.wso2.com/en/latest/"}],"maintainers":[{"name":"WSO2","url":"https://wso2.com"}],"notes":"WSO2 API Manager has been deployed. Access the management console and API gateway according to your ingress configuration.","type":"WSO2 API Manager","version":"4.5.0"},"selector":{"matchLabels":{"app.kubernetes.io/name":"apptest-9eyndrif"}}}}
      kubernetes-engine.cloud.google.com/icon: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==
      marketplace.cloud.google.com/deploy-info: '{"partner_id": "wso2-marketplace-public",
        "product_id": "wso2-apim-kubernetes", "partner_name": "WSO2"}'
    creationTimestamp: "2025-12-02T10:37:08Z"
    generation: 3
    labels:
      app.kubernetes.io/name: apptest-9eyndrif
    name: apptest-9eyndrif
    namespace: apptest-9eyndrif
    resourceVersion: "1764671891672367021"
    uid: 2221911f-59d8-47f1-9f44-962d1d6fc80f
  spec:
    assemblyPhase: Failed
    componentKinds:
    - group: apps/v1
      kind: Deployment
    - group: apps/v1
      kind: StatefulSet
    - group: v1
      kind: Service
    - group: v1
      kind: ConfigMap
    - group: v1
      kind: Secret
    descriptor:
      description: WSO2 API Manager provides a complete platform for building, managing,
        and scaling APIs.
      links:
      - description: 'User Guide: Getting Started'
        url: https://apim.docs.wso2.com/
      - description: WSO2 API Manager Documentation
        url: https://apim.docs.wso2.com/en/latest/
      maintainers:
      - name: WSO2
        url: https://wso2.com
      notes: WSO2 API Manager has been deployed. Access the management console and
        API gateway according to your ingress configuration.
      type: WSO2 API Manager
      version: 4.5.0
    selector:
      matchLabels:
        app.kubernetes.io/name: apptest-9eyndrif
kind: List
metadata:
  resourceVersion: ""
Using /opt/kubectl/1.31/kubectl (server=1.32)
namespace "apptest-9eyndrif" deleted
=== ERROR SUMMARY ===
ERROR Deployer failed

Error events found in namespace "apptest-9eyndrif"
LAST SEEN   TYPE      REASON                 OBJECT                                                                MESSAGE
3s          Warning   FailedMount            pod/apkagent-bdb54d4f9-sx2cs                                          MountVolume.SetUp failed for volume "apk-agent-certificates" : secret "apk-agent-server-cert" not found
14s         Warning   BackoffLimitExceeded   job/apptest-9eyndrif-deployer                                         Job has reached the specified backoff limit
4s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8     MountVolume.SetUp failed for volume "adapter-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-adapter-server-cert" not found
4s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-adapter-deployment-68cfd86db5-r5hj8     MountVolume.SetUp failed for volume "enforcer-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-enforcer-server-cert" not found
2s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s   MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
18s         Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s   MountVolume.SetUp failed for volume "sts-shared-auth-key" : failed to sync secret cache: timed out waiting for the condition
18s         Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s   MountVolume.SetUp failed for volume "log-conf-volume" : failed to sync configmap cache: timed out waiting for the condition
18s         Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s   MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
18s         Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s   MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : failed to sync secret cache: timed out waiting for the condition
2s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s   MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : secret "apptest-9eyndrif-wso2-apk-webhook-server-cert" not found
2s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-common-controller-deployment-97db9n6s   MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-common-controller-server-cert" not found
4s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-config-ds-deployment-5b859c7798-rskf4   MountVolume.SetUp failed for volume "config-ds-tls-volume" : secret "apptest-9eyndrif-wso2-apk-config-ds-server-cert" not found
3s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw   MountVolume.SetUp failed for volume "router-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-gateway-server-cert" not found
3s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw   MountVolume.SetUp failed for volume "adapter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-adapter-server-cert" not found
3s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw   MountVolume.SetUp failed for volume "enforcer-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-enforcer-server-cert" not found
2s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw   MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
18s         Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-gateway-runtime-deployment-5b449tmqpw   MountVolume.SetUp failed for volume "enforcer-health-check-volume" : failed to sync configmap cache: timed out waiting for the condition
3s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd   MountVolume.SetUp failed for volume "router-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-gateway-server-cert" not found
2s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd   MountVolume.SetUp failed for volume "ratelimiter-keystore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-ratelimiter-server-cert" not found
2s          Warning   FailedMount            pod/apptest-9eyndrif-wso2-apk-ratelimiter-deployment-5966c885bz97nd   MountVolume.SetUp failed for volume "common-controller-truststore-secret-volume" : secret "apptest-9eyndrif-wso2-apk-common-controller-server-cert" not found
=====================

=== VERIFICATION STATUS ===
FAILED
===========================
