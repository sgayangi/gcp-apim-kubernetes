WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
Successfully copied 16.4kB to /data/schema.yaml
e1f509724e5927dc836e14b87874d9e5451f563bd4f227f8084a9be7d0a8f55c
INFO Parameters: {
  "name": "apptest-5mjr3ks3",
  "namespace": "apptest-5mjr3ks3"
}
INFO Creates namespace "apptest-5mjr3ks3"
Using /opt/kubectl/1.31/kubectl (server=1.32)
namespace/apptest-5mjr3ks3 created
INFO Initializes the deployer container which will deploy all the application components
WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
Successfully copied 16.4kB to /data/schema.yaml
fe91d1a939a616baad249b0a7575d018a4482f1b270f12f2e699483b5dd7cd4c
INFO: /data/schema.yaml:
x-google-marketplace:
  schemaVersion: v2
  applicationApiVersion: v1beta1
  publishedVersion: "4.5.0"
  publishedVersionMetadata:
    releaseNote: >-
      Initial release of WSO2 APIM Kubernetes deployment with support for
      API Manager Control Plane (ACP), API Platform for Kubernetes (APK),
      and APK Agent integration on Google Cloud Platform.
    releaseTypes:
      - Feature
    recommended: false

  clusterConstraints:
    resources:
      - replicas: 1
        requests:
          cpu: 500m
          memory: 1Gi
    k8sVersion: ">=1.24.0"

  images:
    wso2am-acp:
      properties:
        wso2amAcpImage:
          type: FULL
    apk-config-deployer-service:
      properties:
        configDeployerImage:
          type: FULL
    apk-adapter:
      properties:
        adapterImage:
          type: FULL
    apk-common-controller:
      properties:
        commonControllerImage:
          type: FULL
    apk-ratelimiter:
      properties:
        ratelimiterImage:
          type: FULL
    apk-router:
      properties:
        routerImage:
          type: FULL
    apk-enforcer:
      properties:
        enforcerImage:
          type: FULL
    apim-apk-agent:
      properties:
        apimApkAgentImage:
          type: FULL

  deployerServiceAccount:
    description: >
      Deployer service account for installing WSO2 APIM APK, including CRDs, RBAC resources, and cluster-wide configurations.
    roles:
      - type: ClusterRole
        rulesType: CUSTOM
        rules:
          - apiGroups: ["apiextensions.k8s.io"]
            resources: ["customresourcedefinitions"]
            verbs: ["*"]
          - apiGroups: ["rbac.authorization.k8s.io"]
            resources:
              ["clusterroles", "clusterrolebindings", "roles", "rolebindings"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: [""]
            resources:
              [
                "services",
                "configmaps",
                "secrets",
                "serviceaccounts",
                "persistentvolumeclaims",
                "pods",
                "namespaces",
              ]
            verbs: ["get", "list", "watch", "update", "delete", "create"]
          - apiGroups: ["apps"]
            resources: ["deployments", "statefulsets", "replicasets"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["batch"]
            resources: ["jobs"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["networking.k8s.io"]
            resources: ["ingresses", "networkpolicies"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["policy"]
            resources: ["podsecuritypolicies"]
            verbs:
              [
                "get",
                "list",
                "watch",
                "create",
                "update",
                "patch",
                "delete",
                "use",
              ]
          - apiGroups: ["admissionregistration.k8s.io"]
            resources:
              [
                "mutatingwebhookconfigurations",
                "validatingwebhookconfigurations",
              ]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["cert-manager.io"]
            resources: ["certificates", "issuers", "clusterissuers"]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["coordination.k8s.io"]
            resources: ["leases"]
            verbs:
              ["get", "list", "watch", "update", "patch", "create", "delete"]
          - apiGroups: ["gateway.networking.k8s.io"]
            resources:
              [
                "httproutes",
                "gateways",
                "gatewayclasses",
                "grpcroutes",
                "httproutes/status",
                "gateways/status",
                "gatewayclasses/status",
              ]
            verbs:
              ["get", "list", "watch", "create", "update", "patch", "delete"]
          - apiGroups: ["dp.wso2.com"]
            resources: ["*"]
            verbs: ["*"]
          - apiGroups: ["cp.wso2.com"]
            resources: ["*"]
            verbs: ["*"]

properties:
  controller.serviceAccount:
    type: string
    x-google-marketplace:
      type: SERVICE_ACCOUNT
      serviceAccount:
        description: Service account for API controller
        roles:
          - type: ClusterRole
            rulesType: CUSTOM
            rules:
              - apiGroups: ["apiextensions.k8s.io"]
                resources: ["customresourcedefinitions"]
                verbs: ["*"]
              - apiGroups: ["rbac.authorization.k8s.io"]
                resources:
                  [
                    "clusterroles",
                    "clusterrolebindings",
                    "roles",
                    "rolebindings",
                  ]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: [""]
                resources:
                  [
                    "services",
                    "configmaps",
                    "secrets",
                    "serviceaccounts",
                    "persistentvolumeclaims",
                    "pods",
                    "namespaces",
                  ]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["apps"]
                resources: ["deployments", "statefulsets", "replicasets"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["batch"]
                resources: ["jobs"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["networking.k8s.io"]
                resources: ["ingresses", "networkpolicies"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["policy"]
                resources: ["podsecuritypolicies"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                    "use",
                  ]
              - apiGroups: ["admissionregistration.k8s.io"]
                resources:
                  [
                    "mutatingwebhookconfigurations",
                    "validatingwebhookconfigurations",
                  ]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["cert-manager.io"]
                resources: ["certificates", "issuers", "clusterissuers"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "create",
                    "update",
                    "patch",
                    "delete",
                  ]
              - apiGroups: ["gateway.networking.k8s.io"]
                resources: ["httproutes", "gateways", "gatewayclasses"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["gateway.networking.k8s.io"]
                resources: ["gateways/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apis"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apis/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apis/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["authentications"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["authentications/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["authentications/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backends"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backends/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backends/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apipolicies"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apipolicies/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["apipolicies/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["interceptorservices"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["interceptorservices/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["interceptorservices/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["scopes"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["scopes/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["scopes/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["ratelimitpolicies"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["ratelimitpolicies/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["ratelimitpolicies/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["coordination.k8s.io"]
                resources: ["leases"]
                verbs:
                  [
                    "get",
                    "list",
                    "watch",
                    "update",
                    "patch",
                    "create",
                    "delete",
                  ]
              - apiGroups: ["dp.wso2.com"]
                resources: ["tokenissuers"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["tokenissuers/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["tokenissuers/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backendjwts"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backendjwts/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["backendjwts/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["gqlroutes"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["gqlroutes/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["gqlroutes/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["aiproviders"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["aiproviders/status"]
                verbs: ["get", "patch", "update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["aiproviders/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["airatelimitpolicies"]
                verbs: ["get", "list", "watch", "update", "delete", "create"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["airatelimitpolicies/finalizers"]
                verbs: ["update"]
              - apiGroups: ["dp.wso2.com"]
                resources: ["airatelimitpolicies/status"]
                verbs: ["get", "patch", "update"]
  name:
    type: string
    x-google-marketplace:
      type: NAME
    title: Application name
    description: The name of the application instance

  namespace:
    type: string
    x-google-marketplace:
      type: NAMESPACE
    title: Namespace
    description: The Kubernetes namespace where the application will be deployed

required:
  - name
  - namespace
Using /opt/kubectl/1.31/kubectl (server=1.32)
Using /opt/kubectl/1.31/kubectl (server=1.32)
application.app.k8s.io/apptest-5mjr3ks3 created
Using /opt/kubectl/1.31/kubectl (server=1.32)
Using /opt/kubectl/1.31/kubectl (server=1.32)
serviceaccount/apptest-5mjr3ks3-deployer-sa created
Using /opt/kubectl/1.31/kubectl (server=1.32)
INFO Application 'apptest-5mjr3ks3' owns 'ServiceAccount/apptest-5mjr3ks3-controller-serviceaccount'
INFO Application 'apptest-5mjr3ks3' does not own cluster-scoped 'ClusterRole/apptest-5mjr3ks3:apptest-5mjr3ks3:controller.serviceAccount-r0'
INFO Application 'apptest-5mjr3ks3' does not own cluster-scoped 'ClusterRoleBinding/apptest-5mjr3ks3:apptest-5mjr3ks3:controller.serviceAccount-rb0'
INFO Application 'apptest-5mjr3ks3' owns 'ServiceAccount/apptest-5mjr3ks3-deployer-sa'
INFO Application 'apptest-5mjr3ks3' owns 'Secret/apptest-5mjr3ks3-deployer-config'
INFO Application 'apptest-5mjr3ks3' owns 'Job/apptest-5mjr3ks3-deployer'
INFO Application 'apptest-5mjr3ks3' owns 'RoleBinding/apptest-5mjr3ks3-deployer-rb'
INFO Application 'apptest-5mjr3ks3' does not own cluster-scoped 'ClusterRole/apptest-5mjr3ks3:apptest-5mjr3ks3:deployer-cr0'
INFO Application 'apptest-5mjr3ks3' does not own cluster-scoped 'ClusterRoleBinding/apptest-5mjr3ks3:apptest-5mjr3ks3:deployer-crb0'
INFO: Applying the following manifests:
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app.kubernetes.io/component: auto-provisioned.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    marketplace.cloud.google.com/auto-provisioned-for-property: controller.serviceAccount
  name: apptest-5mjr3ks3-controller-serviceaccount
  namespace: apptest-5mjr3ks3
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-5mjr3ks3
    uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/component: auto-provisioned.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    app.kubernetes.io/namespace: apptest-5mjr3ks3
    marketplace.cloud.google.com/auto-provisioned-for-property: controller.serviceAccount
  name: apptest-5mjr3ks3:apptest-5mjr3ks3:controller.serviceAccount-r0
rules:
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  verbs:
  - '*'
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - clusterrolebindings
  - roles
  - rolebindings
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ''
  resources:
  - services
  - configmaps
  - secrets
  - serviceaccounts
  - persistentvolumeclaims
  - pods
  - namespaces
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - apps
  resources:
  - deployments
  - statefulsets
  - replicasets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - batch
  resources:
  - jobs
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  - networkpolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - policy
  resources:
  - podsecuritypolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
  - use
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - cert-manager.io
  resources:
  - certificates
  - issuers
  - clusterissuers
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - gateway.networking.k8s.io
  resources:
  - httproutes
  - gateways
  - gatewayclasses
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - gateway.networking.k8s.io
  resources:
  - gateways/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apis
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - apis/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apis/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - authentications
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - authentications/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - authentications/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backends
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - backends/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backends/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apipolicies
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - apipolicies/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - apipolicies/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - interceptorservices
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - interceptorservices/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - interceptorservices/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - scopes
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - scopes/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - scopes/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - ratelimitpolicies
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - ratelimitpolicies/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - ratelimitpolicies/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - update
  - patch
  - create
  - delete
- apiGroups:
  - dp.wso2.com
  resources:
  - tokenissuers
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - tokenissuers/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - tokenissuers/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backendjwts
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - backendjwts/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - backendjwts/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - gqlroutes
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - gqlroutes/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - gqlroutes/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - aiproviders
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - aiproviders/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - aiproviders/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - airatelimitpolicies
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - dp.wso2.com
  resources:
  - airatelimitpolicies/finalizers
  verbs:
  - update
- apiGroups:
  - dp.wso2.com
  resources:
  - airatelimitpolicies/status
  verbs:
  - get
  - patch
  - update
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/component: auto-provisioned.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    marketplace.cloud.google.com/auto-provisioned-for-property: controller.serviceAccount
  name: apptest-5mjr3ks3:apptest-5mjr3ks3:controller.serviceAccount-rb0
  namespace: apptest-5mjr3ks3
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: apptest-5mjr3ks3:apptest-5mjr3ks3:controller.serviceAccount-r0
subjects:
- kind: ServiceAccount
  name: apptest-5mjr3ks3-controller-serviceaccount
  namespace: apptest-5mjr3ks3
---
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app.kubernetes.io/component: deployer.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-5mjr3ks3-deployer-sa
  namespace: apptest-5mjr3ks3
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-5mjr3ks3
    uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    app.kubernetes.io/component: deployer.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-5mjr3ks3-deployer-config
  namespace: apptest-5mjr3ks3
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-5mjr3ks3
    uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
stringData:
  values.yaml: '__image_repo_prefix__: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace

    controller.serviceAccount: apptest-5mjr3ks3-controller-serviceaccount

    name: apptest-5mjr3ks3

    namespace: apptest-5mjr3ks3

    '
type: Opaque
---
apiVersion: batch/v1
kind: Job
metadata:
  labels:
    app.kubernetes.io/component: deployer.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    marketplace.cloud.google.com/deployer: Main
  name: apptest-5mjr3ks3-deployer
  namespace: apptest-5mjr3ks3
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-5mjr3ks3
    uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
spec:
  backoffLimit: 0
  template:
    metadata:
      annotations:
        sidecar.istio.io/inject: 'false'
    spec:
      containers:
      - command:
        - /bin/deploy_with_tests.sh
        image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
        imagePullPolicy: Always
        name: deployer
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
        volumeMounts:
        - mountPath: /data/values.yaml
          name: config-volume
          readOnly: true
          subPath: values.yaml
      restartPolicy: Never
      serviceAccountName: apptest-5mjr3ks3-deployer-sa
      volumes:
      - name: config-volume
        secret:
          secretName: apptest-5mjr3ks3-deployer-config
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    app.kubernetes.io/component: deployer-rbac.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-5mjr3ks3-deployer-rb
  namespace: apptest-5mjr3ks3
  ownerReferences:
  - apiVersion: app.k8s.io/v1beta1
    blockOwnerDeletion: true
    kind: Application
    name: apptest-5mjr3ks3
    uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: apptest-5mjr3ks3-deployer-sa
  namespace: apptest-5mjr3ks3
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/component: deployer-rbac.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    app.kubernetes.io/namespace: apptest-5mjr3ks3
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-5mjr3ks3:apptest-5mjr3ks3:deployer-cr0
rules:
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  verbs:
  - '*'
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - clusterrolebindings
  - roles
  - rolebindings
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ''
  resources:
  - services
  - configmaps
  - secrets
  - serviceaccounts
  - persistentvolumeclaims
  - pods
  - namespaces
  verbs:
  - get
  - list
  - watch
  - update
  - delete
  - create
- apiGroups:
  - apps
  resources:
  - deployments
  - statefulsets
  - replicasets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - batch
  resources:
  - jobs
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  - networkpolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - policy
  resources:
  - podsecuritypolicies
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
  - use
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - mutatingwebhookconfigurations
  - validatingwebhookconfigurations
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - cert-manager.io
  resources:
  - certificates
  - issuers
  - clusterissuers
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - update
  - patch
  - create
  - delete
- apiGroups:
  - gateway.networking.k8s.io
  resources:
  - httproutes
  - gateways
  - gatewayclasses
  - grpcroutes
  - httproutes/status
  - gateways/status
  - gatewayclasses/status
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - dp.wso2.com
  resources:
  - '*'
  verbs:
  - '*'
- apiGroups:
  - cp.wso2.com
  resources:
  - '*'
  verbs:
  - '*'
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/component: deployer-rbac.marketplace.cloud.google.com
    app.kubernetes.io/name: apptest-5mjr3ks3
    app.kubernetes.io/namespace: apptest-5mjr3ks3
    marketplace.cloud.google.com/deployer: Dependent
  name: apptest-5mjr3ks3:apptest-5mjr3ks3:deployer-crb0
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: apptest-5mjr3ks3:apptest-5mjr3ks3:deployer-cr0
subjects:
- kind: ServiceAccount
  name: apptest-5mjr3ks3-deployer-sa
  namespace: apptest-5mjr3ks3
Using /opt/kubectl/1.31/kubectl (server=1.32)
serviceaccount/apptest-5mjr3ks3-controller-serviceaccount created
clusterrole.rbac.authorization.k8s.io/apptest-5mjr3ks3:apptest-5mjr3ks3:controller.serviceAccount-r0 created
clusterrolebinding.rbac.authorization.k8s.io/apptest-5mjr3ks3:apptest-5mjr3ks3:controller.serviceAccount-rb0 created
serviceaccount/apptest-5mjr3ks3-deployer-sa configured
secret/apptest-5mjr3ks3-deployer-config created
job.batch/apptest-5mjr3ks3-deployer created
rolebinding.rbac.authorization.k8s.io/apptest-5mjr3ks3-deployer-rb created
clusterrole.rbac.authorization.k8s.io/apptest-5mjr3ks3:apptest-5mjr3ks3:deployer-cr0 created
clusterrolebinding.rbac.authorization.k8s.io/apptest-5mjr3ks3:apptest-5mjr3ks3:deployer-crb0 created
INFO wait for the deployer to succeed
Using /opt/kubectl/1.31/kubectl (server=1.32)
Elapsed 4sUsing /opt/kubectl/1.31/kubectl (server=1.32)
Elapsed 11sUsing /opt/kubectl/1.31/kubectl (server=1.32)
ERROR Deployer failed
INFO cleaning all resources.
INFO Collecting events for namespace "apptest-5mjr3ks3"
Using /opt/kubectl/1.31/kubectl (server=1.32)
LAST SEEN   TYPE      REASON                  OBJECT                                                                         MESSAGE
9s          Normal    Scheduled               pod/apkagent-d87b99c4b-qxj9j                                                   Successfully assigned apptest-5mjr3ks3/apkagent-d87b99c4b-qxj9j to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
8s          Warning   FailedMount             pod/apkagent-d87b99c4b-qxj9j                                                   MountVolume.SetUp failed for volume "log-conf-volume" : failed to sync configmap cache: timed out waiting for the condition
8s          Warning   FailedMount             pod/apkagent-d87b99c4b-qxj9j                                                   MountVolume.SetUp failed for volume "apk-agent-certificates" : failed to sync secret cache: timed out waiting for the condition
0s          Warning   FailedMount             pod/apkagent-d87b99c4b-qxj9j                                                   MountVolume.SetUp failed for volume "apk-agent-certificates" : secret "apk-agent-server-cert" not found
9s          Normal    SuccessfulCreate        replicaset/apkagent-d87b99c4b                                                  Created pod: apkagent-d87b99c4b-qxj9j
10s         Normal    ScalingReplicaSet       deployment/apkagent                                                            Scaled up replica set apkagent-d87b99c4b from 0 to 1
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf to gke-wso2-apim-gke-test-cpu-pool-583b68cf-21fl
10s         Normal    Pulling                 pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5"
10s         Normal    Pulled                  pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5" in 485ms (485ms including waiting). Image size: 1220921489 bytes.
10s         Normal    Created                 pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Created container: wso2am-control-plane
10s         Normal    Started                 pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Started container wso2am-control-plane
11s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-acp-deployment-1-6b454874d                         Created pod: apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-acp-deployment-1                                   Scaled up replica set apptest-5mjr3ks3-acp-deployment-1-6b454874d from 0 to 1
13s         Normal    NoPods                  poddisruptionbudget/apptest-5mjr3ks3-acp-pdb                                   No matching pods found
24s         Normal    Scheduled               pod/apptest-5mjr3ks3-deployer-22htk                                            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-deployer-22htk to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
24s         Normal    Pulling                 pod/apptest-5mjr3ks3-deployer-22htk                                            Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5"
22s         Normal    Pulled                  pod/apptest-5mjr3ks3-deployer-22htk                                            Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5" in 1.497s (1.497s including waiting). Image size: 130854140 bytes.
22s         Normal    Created                 pod/apptest-5mjr3ks3-deployer-22htk                                            Created container: deployer
22s         Normal    Started                 pod/apptest-5mjr3ks3-deployer-22htk                                            Started container deployer
24s         Normal    SuccessfulCreate        job/apptest-5mjr3ks3-deployer                                                  Created pod: apptest-5mjr3ks3-deployer-22htk
5s          Warning   BackoffLimitExceeded    job/apptest-5mjr3ks3-deployer                                                  Job has reached the specified backoff limit
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "enforcer-truststore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "log-conf-volume" : failed to sync configmap cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "adapter-truststore-consul-secret-volume" : failed to sync secret cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "enforcer-apikey-cert" : failed to sync secret cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "adapter-keystore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "enforcer-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-enforcer-server-cert" not found
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "adapter-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-adapter-server-cert" not found
11s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf             Created pod: apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-adapter-deployment                        Scaled up replica set apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf from 0 to 1
10s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f   Created pod: apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : secret "apptest-5mjr3ks3-wso2-apk-webhook-server-cert" not found
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert" not found
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-common-controller-server-cert" not found
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-common-controller-deployment              Scaled up replica set apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f from 0 to 1
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
3s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q            MountVolume.SetUp failed for volume "config-ds-tls-volume" : secret "apptest-5mjr3ks3-wso2-apk-config-ds-server-cert" not found
11s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88           Created pod: apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-config-ds-deployment                      Scaled up replica set apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88 from 0 to 1
10s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf     Created pod: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk
9s          Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "enforcer-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-enforcer-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "adapter-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-adapter-server-cert" not found
8s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "router-keystore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "router-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-gateway-server-cert" not found
10s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment                Scaled up replica set apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf from 0 to 1
11s         Normal    EnsuringLoadBalancer    service/apptest-5mjr3ks3-wso2-apk-gateway-service                              Ensuring load balancer
9s          Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            MountVolume.SetUp failed for volume "ratelimiter-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            MountVolume.SetUp failed for volume "common-controller-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-common-controller-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            MountVolume.SetUp failed for volume "router-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-gateway-server-cert" not found
9s          Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc         Created pod: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz
10s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment                    Scaled up replica set apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc from 0 to 1
9s          Normal    WaitForFirstConsumer    persistentvolumeclaim/redis-data-redis-master-0                                waiting for first consumer to be created before binding
9s          Normal    ExternalProvisioning    persistentvolumeclaim/redis-data-redis-master-0                                Waiting for a volume to be created either by the external provisioner 'pd.csi.storage.gke.io' or manually by the system administrator. If volume creation is delayed, please verify that the provisioner is running and correctly registered.
9s          Normal    Provisioning            persistentvolumeclaim/redis-data-redis-master-0                                External provisioner is provisioning volume for claim "apptest-5mjr3ks3/redis-data-redis-master-0"
5s          Normal    ProvisioningSucceeded   persistentvolumeclaim/redis-data-redis-master-0                                Successfully provisioned volume pvc-32511a51-8cdb-4a64-9a7b-7f1ee5422886
4s          Normal    Scheduled               pod/redis-master-0                                                             Successfully assigned apptest-5mjr3ks3/redis-master-0 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
13s         Normal    NoPods                  poddisruptionbudget/redis-master                                               No matching pods found
9s          Normal    SuccessfulCreate        statefulset/redis-master                                                       create Claim redis-data-redis-master-0 Pod redis-master-0 in StatefulSet redis-master success
9s          Normal    SuccessfulCreate        statefulset/redis-master                                                       create Pod redis-master-0 in StatefulSet redis-master successful
LAST SEEN   TYPE      REASON                  OBJECT                                                                         MESSAGE
9s          Normal    Scheduled               pod/apkagent-d87b99c4b-qxj9j                                                   Successfully assigned apptest-5mjr3ks3/apkagent-d87b99c4b-qxj9j to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
8s          Warning   FailedMount             pod/apkagent-d87b99c4b-qxj9j                                                   MountVolume.SetUp failed for volume "log-conf-volume" : failed to sync configmap cache: timed out waiting for the condition
8s          Warning   FailedMount             pod/apkagent-d87b99c4b-qxj9j                                                   MountVolume.SetUp failed for volume "apk-agent-certificates" : failed to sync secret cache: timed out waiting for the condition
0s          Warning   FailedMount             pod/apkagent-d87b99c4b-qxj9j                                                   MountVolume.SetUp failed for volume "apk-agent-certificates" : secret "apk-agent-server-cert" not found
9s          Normal    SuccessfulCreate        replicaset/apkagent-d87b99c4b                                                  Created pod: apkagent-d87b99c4b-qxj9j
10s         Normal    ScalingReplicaSet       deployment/apkagent                                                            Scaled up replica set apkagent-d87b99c4b from 0 to 1
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf to gke-wso2-apim-gke-test-cpu-pool-583b68cf-21fl
10s         Normal    Pulling                 pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5"
10s         Normal    Pulled                  pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5" in 485ms (485ms including waiting). Image size: 1220921489 bytes.
10s         Normal    Created                 pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Created container: wso2am-control-plane
10s         Normal    Started                 pod/apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf                          Started container wso2am-control-plane
11s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-acp-deployment-1-6b454874d                         Created pod: apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-acp-deployment-1                                   Scaled up replica set apptest-5mjr3ks3-acp-deployment-1-6b454874d from 0 to 1
13s         Normal    NoPods                  poddisruptionbudget/apptest-5mjr3ks3-acp-pdb                                   No matching pods found
24s         Normal    Scheduled               pod/apptest-5mjr3ks3-deployer-22htk                                            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-deployer-22htk to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
24s         Normal    Pulling                 pod/apptest-5mjr3ks3-deployer-22htk                                            Pulling image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5"
22s         Normal    Pulled                  pod/apptest-5mjr3ks3-deployer-22htk                                            Successfully pulled image "us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5" in 1.497s (1.497s including waiting). Image size: 130854140 bytes.
22s         Normal    Created                 pod/apptest-5mjr3ks3-deployer-22htk                                            Created container: deployer
22s         Normal    Started                 pod/apptest-5mjr3ks3-deployer-22htk                                            Started container deployer
24s         Normal    SuccessfulCreate        job/apptest-5mjr3ks3-deployer                                                  Created pod: apptest-5mjr3ks3-deployer-22htk
5s          Warning   BackoffLimitExceeded    job/apptest-5mjr3ks3-deployer                                                  Job has reached the specified backoff limit
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "enforcer-truststore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "log-conf-volume" : failed to sync configmap cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "adapter-truststore-consul-secret-volume" : failed to sync secret cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "enforcer-apikey-cert" : failed to sync secret cache: timed out waiting for the condition
9s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "adapter-keystore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "enforcer-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-enforcer-server-cert" not found
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9              MountVolume.SetUp failed for volume "adapter-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-adapter-server-cert" not found
11s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf             Created pod: apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-adapter-deployment                        Scaled up replica set apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf from 0 to 1
10s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f   Created pod: apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            MountVolume.SetUp failed for volume "adapter-webhook-server-cert" : secret "apptest-5mjr3ks3-wso2-apk-webhook-server-cert" not found
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert" not found
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt            MountVolume.SetUp failed for volume "common-controller-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-common-controller-server-cert" not found
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-common-controller-deployment              Scaled up replica set apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f from 0 to 1
10s         Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
3s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q            MountVolume.SetUp failed for volume "config-ds-tls-volume" : secret "apptest-5mjr3ks3-wso2-apk-config-ds-server-cert" not found
11s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88           Created pod: apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q
11s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-config-ds-deployment                      Scaled up replica set apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88 from 0 to 1
10s         Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf     Created pod: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk
9s          Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
2s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "ratelimiter-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "enforcer-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-enforcer-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "adapter-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-adapter-server-cert" not found
8s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "router-keystore-secret-volume" : failed to sync secret cache: timed out waiting for the condition
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk            MountVolume.SetUp failed for volume "router-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-gateway-server-cert" not found
10s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment                Scaled up replica set apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf from 0 to 1
11s         Normal    EnsuringLoadBalancer    service/apptest-5mjr3ks3-wso2-apk-gateway-service                              Ensuring load balancer
9s          Normal    Scheduled               pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            Successfully assigned apptest-5mjr3ks3/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            MountVolume.SetUp failed for volume "ratelimiter-keystore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            MountVolume.SetUp failed for volume "common-controller-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-common-controller-server-cert" not found
1s          Warning   FailedMount             pod/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz            MountVolume.SetUp failed for volume "router-truststore-secret-volume" : secret "apptest-5mjr3ks3-wso2-apk-gateway-server-cert" not found
9s          Normal    SuccessfulCreate        replicaset/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc         Created pod: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz
10s         Normal    ScalingReplicaSet       deployment/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment                    Scaled up replica set apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc from 0 to 1
9s          Normal    WaitForFirstConsumer    persistentvolumeclaim/redis-data-redis-master-0                                waiting for first consumer to be created before binding
9s          Normal    ExternalProvisioning    persistentvolumeclaim/redis-data-redis-master-0                                Waiting for a volume to be created either by the external provisioner 'pd.csi.storage.gke.io' or manually by the system administrator. If volume creation is delayed, please verify that the provisioner is running and correctly registered.
9s          Normal    Provisioning            persistentvolumeclaim/redis-data-redis-master-0                                External provisioner is provisioning volume for claim "apptest-5mjr3ks3/redis-data-redis-master-0"
5s          Normal    ProvisioningSucceeded   persistentvolumeclaim/redis-data-redis-master-0                                Successfully provisioned volume pvc-32511a51-8cdb-4a64-9a7b-7f1ee5422886
4s          Normal    Scheduled               pod/redis-master-0                                                             Successfully assigned apptest-5mjr3ks3/redis-master-0 to gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
13s         Normal    NoPods                  poddisruptionbudget/redis-master                                               No matching pods found
9s          Normal    SuccessfulCreate        statefulset/redis-master                                                       create Claim redis-data-redis-master-0 Pod redis-master-0 in StatefulSet redis-master success
9s          Normal    SuccessfulCreate        statefulset/redis-master                                                       create Pod redis-master-0 in StatefulSet redis-master successful
Using /opt/kubectl/1.31/kubectl (server=1.32)
INFO Collecting logs for deployer
Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + trap handle_failure EXIT
DEPLOYER + test_schema=/data-test/schema.yaml
DEPLOYER + overlay_test_schema.py --test_schema /data-test/schema.yaml --original_schema /data/schema.yaml --output /data/schema.yaml
DEPLOYER + awk '{print "SMOKE_TEST "$0}'
DEPLOYER ++ /bin/print_config.py --xtype NAME --values_mode raw
DEPLOYER + NAME=apptest-5mjr3ks3
DEPLOYER ++ /bin/print_config.py --xtype NAMESPACE --values_mode raw
DEPLOYER Deploying application "apptest-5mjr3ks3" in test mode
DEPLOYER + NAMESPACE=apptest-5mjr3ks3
DEPLOYER + export NAME
DEPLOYER + export NAMESPACE
DEPLOYER + echo 'Deploying application "apptest-5mjr3ks3" in test mode'
DEPLOYER ++ kubectl get applications.app.k8s.io/apptest-5mjr3ks3 --namespace=apptest-5mjr3ks3 '--output=jsonpath={.metadata.uid}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + app_uid=a82f27f1-84ff-4545-9bdb-186e532a17aa
DEPLOYER ++ kubectl get applications.app.k8s.io/apptest-5mjr3ks3 --namespace=apptest-5mjr3ks3 '--output=jsonpath={.apiVersion}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + app_api_version=app.k8s.io/v1beta1
DEPLOYER ++ kubectl get namespaces/apptest-5mjr3ks3 '--output=jsonpath={.metadata.uid}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER + namespace_uid=18f89eb9-7f9b-4df9-abca-3ee9f9e6d627
DEPLOYER + /bin/expand_config.py --values_mode raw --app_uid a82f27f1-84ff-4545-9bdb-186e532a17aa
DEPLOYER + create_manifests.sh --mode=test
DEPLOYER + for i in "$@"
DEPLOYER + case $i in
DEPLOYER + mode=test
DEPLOYER + shift
DEPLOYER + [[ -z apptest-5mjr3ks3 ]]
DEPLOYER + [[ -z apptest-5mjr3ks3 ]]
DEPLOYER + echo 'Creating the manifests for the kubernetes resources that build the application "apptest-5mjr3ks3"'
DEPLOYER + data_dir=/data
DEPLOYER + manifest_dir=/data/manifest-expanded
DEPLOYER + mkdir -p /data/manifest-expanded
DEPLOYER Creating the manifests for the kubernetes resources that build the application "apptest-5mjr3ks3"
DEPLOYER + [[ test = \t\e\s\t ]]
DEPLOYER + test_data_dir=/data-test
DEPLOYER + mkdir -p /data-test
DEPLOYER + extract_manifest /data
DEPLOYER + data=/data
DEPLOYER + extracted=/data/extracted
DEPLOYER + data_chart=/data/chart
DEPLOYER + mkdir -p /data/extracted
DEPLOYER + [[ -d /data/chart ]]
DEPLOYER ++ find /data/chart -maxdepth 1 -type f -name '*.tar.gz'
DEPLOYER + for chart in $(find "$data_chart" -maxdepth 1 -type f -name "*.tar.gz")
DEPLOYER ++ basename /data/chart/chart.tar.gz
DEPLOYER ++ sed 's/.tar.gz$//'
DEPLOYER + chart_manifest_file=chart
DEPLOYER + mkdir /data/extracted/chart
DEPLOYER + tar xfC /data/chart/chart.tar.gz /data/extracted/chart
DEPLOYER + [[ test = \t\e\s\t ]]
DEPLOYER + extract_manifest /data-test
DEPLOYER + data=/data-test
DEPLOYER + extracted=/data-test/extracted
DEPLOYER + data_chart=/data-test/chart
DEPLOYER + mkdir -p /data-test/extracted
DEPLOYER + [[ -d /data-test/chart ]]
DEPLOYER ++ find /data-test/chart -maxdepth 1 -type f -name '*.tar.gz'
DEPLOYER + [[ ! -e /data/extracted ]]
DEPLOYER + overlay_test_files.py --manifest /data/extracted --test_manifest /data-test/extracted
DEPLOYER + awk '{print "SMOKE_TEST "$0}'
DEPLOYER + echo '=== values.yaml ==='
DEPLOYER + /bin/print_config.py --output=yaml
DEPLOYER === values.yaml ===
DEPLOYER adapterImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5.0
DEPLOYER apimApkAgentImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5.0
DEPLOYER commonControllerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5.0
DEPLOYER configDeployerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5.0
DEPLOYER controller:
DEPLOYER   serviceAccount: apptest-5mjr3ks3-controller-serviceaccount
DEPLOYER enforcerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5.0
DEPLOYER name: apptest-5mjr3ks3
DEPLOYER namespace: apptest-5mjr3ks3
DEPLOYER ratelimiterImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5.0
DEPLOYER routerImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5.0
DEPLOYER wso2amAcpImage: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5.0
DEPLOYER + echo ===================
DEPLOYER ===================
DEPLOYER + for chart in "$data_dir/extracted"/*
DEPLOYER ++ basename /data/extracted/chart
DEPLOYER ++ sed 's/.tar.gz$//'
DEPLOYER + chart_manifest_file=chart.yaml
DEPLOYER + helm template apptest-5mjr3ks3 /data/extracted/chart/chart --namespace=apptest-5mjr3ks3 --values=/dev/fd/63
DEPLOYER ++ /bin/print_config.py --output=yaml
DEPLOYER coalesce.go:298: warning: cannot overwrite table with non table for wso2-apim.acp.wso2.deployment.image (map[digest: imagePullPolicy:Always registry: repository:])
DEPLOYER coalesce.go:298: warning: cannot overwrite table with non table for wso2-apim.acp.wso2.deployment.image (map[digest: imagePullPolicy:Always registry: repository:])
DEPLOYER coalesce.go:298: warning: cannot overwrite table with non table for wso2-apim.acp.wso2.deployment.image (map[digest: imagePullPolicy:Always registry: repository:])
DEPLOYER + [[ test != \t\e\s\t ]]
DEPLOYER + process_helm_hooks.py --deploy_tests --manifest /data/manifest-expanded/chart.yaml
DEPLOYER INFO Reading /data/manifest-expanded/chart.yaml
DEPLOYER + ensure_k8s_apps_labels.py --manifest /data/manifest-expanded/chart.yaml --appname apptest-5mjr3ks3
DEPLOYER INFO Reading /data/manifest-expanded/chart.yaml
DEPLOYER + /bin/set_ownership.py --app_name apptest-5mjr3ks3 --app_uid a82f27f1-84ff-4545-9bdb-186e532a17aa --app_api_version app.k8s.io/v1beta1 --namespace apptest-5mjr3ks3 --namespace_uid 18f89eb9-7f9b-4df9-abca-3ee9f9e6d627 --manifests /data/manifest-expanded --dest /data/resources.yaml
DEPLOYER INFO Reading /data/manifest-expanded/chart.yaml
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apk-root-certificate'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apptest-5mjr3ks3-wso2-apk-adapter-truststore-consul-secret'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apptest-5mjr3ks3-wso2-apk-sts-shared-auth-key'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apptest-5mjr3ks3-wso2-apk-token'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apim-apk-issuer-cert'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/apk-agent-root-certificate'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Secret/agent-account-secret-token'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-acp-conf-1'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-acp-conf-entrypoint'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-acp-conf-log4j2'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-acp-conf-admin-settings'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-acp-conf-devportal-settings'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-acp-conf-publisher-settings'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/redis-configuration'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/redis-health'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/redis-scripts'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-config-ds-configmap'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-deployer-api-definition'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-generator-api-definition'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-adapter-grpc-probe-script-conf'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-notification-api-definition'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-common-controller-grpc-probe-script-conf'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-common-log-conf'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-enforcer-grpc-probe-script-conf'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-wso2-apk-log-conf'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'ConfigMap/apptest-5mjr3ks3-log-conf'
DEPLOYER INFO Namespace 'apptest-5mjr3ks3' owns 'ClusterRole/wso2apk-role'
DEPLOYER INFO Namespace 'apptest-5mjr3ks3' owns 'ClusterRole/wso2agent-role'
DEPLOYER INFO Namespace 'apptest-5mjr3ks3' owns 'ClusterRoleBinding/apptest-5mjr3ks3-wso2-apk-role-binding'
DEPLOYER INFO Namespace 'apptest-5mjr3ks3' owns 'ClusterRoleBinding/agent-cluster-role-binding'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-acp-1-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-acp-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/redis-headless'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/redis-master'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-wso2-apk-config-ds-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-wso2-apk-adapter-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-wso2-apk-common-controller-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-wso2-apk-enforcer-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-wso2-apk-gateway-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apptest-5mjr3ks3-wso2-apk-ratelimiter-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Service/apim-apk-agent-service'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Deployment/apptest-5mjr3ks3-acp-deployment-1'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Deployment/apptest-5mjr3ks3-wso2-apk-config-ds-deployment'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Deployment/apptest-5mjr3ks3-wso2-apk-adapter-deployment'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Deployment/apptest-5mjr3ks3-wso2-apk-common-controller-deployment'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Deployment/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Deployment/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'Deployment/apkagent'
DEPLOYER INFO Application 'apptest-5mjr3ks3' owns 'StatefulSet/redis-master'
DEPLOYER + validate_app_resource.py --manifests /data/resources.yaml
DEPLOYER INFO Reading /data/resources.yaml
DEPLOYER + separate_tester_resources.py --app_uid a82f27f1-84ff-4545-9bdb-186e532a17aa --app_name apptest-5mjr3ks3 --app_api_version app.k8s.io/v1beta1 --manifests /data/resources.yaml --out_manifests /data/resources.yaml --out_test_manifests /data/tester.yaml
DEPLOYER INFO Reading /data/resources.yaml
DEPLOYER INFO Prod resource: NetworkPolicy/redis
DEPLOYER INFO Prod resource: PodDisruptionBudget/apptest-5mjr3ks3-acp-pdb
DEPLOYER INFO Prod resource: PodDisruptionBudget/redis-master
DEPLOYER INFO Prod resource: ServiceAccount/redis-master
DEPLOYER INFO Prod resource: ServiceAccount/wso2apk-platform
DEPLOYER INFO Prod resource: ServiceAccount/wso2agent-platform
DEPLOYER INFO Prod resource: Secret/apk-root-certificate
DEPLOYER INFO Prod resource: Secret/apptest-5mjr3ks3-wso2-apk-adapter-truststore-consul-secret
DEPLOYER INFO Prod resource: Secret/apptest-5mjr3ks3-wso2-apk-sts-shared-auth-key
DEPLOYER INFO Prod resource: Secret/apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret
DEPLOYER INFO Prod resource: Secret/apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
DEPLOYER INFO Prod resource: Secret/apptest-5mjr3ks3-wso2-apk-token
DEPLOYER INFO Prod resource: Secret/apim-apk-issuer-cert
DEPLOYER INFO Prod resource: Secret/apk-agent-root-certificate
DEPLOYER INFO Prod resource: Secret/agent-account-secret-token
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-acp-conf-1
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-acp-conf-entrypoint
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-acp-conf-log4j2
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-acp-conf-admin-settings
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-acp-conf-devportal-settings
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-acp-conf-publisher-settings
DEPLOYER INFO Prod resource: ConfigMap/redis-configuration
DEPLOYER INFO Prod resource: ConfigMap/redis-health
DEPLOYER INFO Prod resource: ConfigMap/redis-scripts
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-config-ds-configmap
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-deployer-api-definition
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-generator-api-definition
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-adapter-grpc-probe-script-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-notification-api-definition
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-common-controller-grpc-probe-script-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-common-log-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-enforcer-grpc-probe-script-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-wso2-apk-log-conf
DEPLOYER INFO Prod resource: ConfigMap/apptest-5mjr3ks3-log-conf
DEPLOYER INFO Prod resource: ClusterRole/wso2apk-role
DEPLOYER INFO Prod resource: ClusterRole/wso2agent-role
DEPLOYER INFO Prod resource: ClusterRoleBinding/apptest-5mjr3ks3-wso2-apk-role-binding
DEPLOYER INFO Prod resource: ClusterRoleBinding/agent-cluster-role-binding
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-acp-1-service
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-acp-service
DEPLOYER INFO Prod resource: Service/redis-headless
DEPLOYER INFO Prod resource: Service/redis-master
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-wso2-apk-config-ds-service
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-wso2-apk-adapter-service
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-wso2-apk-common-controller-service
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-wso2-apk-enforcer-service
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-wso2-apk-gateway-service
DEPLOYER INFO Prod resource: Service/apptest-5mjr3ks3-wso2-apk-ratelimiter-service
DEPLOYER INFO Prod resource: Service/apim-apk-agent-service
DEPLOYER INFO Prod resource: Deployment/apptest-5mjr3ks3-acp-deployment-1
DEPLOYER INFO Prod resource: Deployment/apptest-5mjr3ks3-wso2-apk-config-ds-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-5mjr3ks3-wso2-apk-adapter-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-5mjr3ks3-wso2-apk-common-controller-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment
DEPLOYER INFO Prod resource: Deployment/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment
DEPLOYER INFO Prod resource: Deployment/apkagent
DEPLOYER INFO Prod resource: StatefulSet/redis-master
DEPLOYER INFO Prod resource: Ingress/apptest-5mjr3ks3-acp-ingress
DEPLOYER INFO Prod resource: AIProvider/ai-provider-azure-ai
DEPLOYER INFO Prod resource: AIProvider/ai-provider-mistral-ai
DEPLOYER INFO Prod resource: AIProvider/ai-provider-open-ai
DEPLOYER INFO Prod resource: API/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-deployer-api
DEPLOYER INFO Prod resource: API/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-generator-api
DEPLOYER INFO Prod resource: API/apptest-5mjr3ks3-wso2-apk-wso2-apk-notification-api
DEPLOYER INFO Prod resource: APIPolicy/apptest-5mjr3ks3-wso2-apk-config-api-api-policy
DEPLOYER INFO Prod resource: Application/apptest-5mjr3ks3
DEPLOYER INFO Prod resource: Authentication/apptest-5mjr3ks3-wso2-apk-configurator-api-no-authentication-policy
DEPLOYER INFO Prod resource: Authentication/apptest-5mjr3ks3-wso2-apk-notification-api-no-authentication-policy
DEPLOYER INFO Prod resource: Backend/apptest-5mjr3ks3-wso2-apk-config-deployer-ds-backend
DEPLOYER INFO Prod resource: Backend/apptest-5mjr3ks3-wso2-apk-config-generator-backend
DEPLOYER INFO Prod resource: Backend/apptest-5mjr3ks3-wso2-apk-notification-api-backend
DEPLOYER INFO Prod resource: BackendJWT/apptest-5mjr3ks3-wso2-apk-config-api-backendjwt
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-adapter-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-common-controller-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-config-ds-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-enforcer-server-cert
DEPLOYER INFO Prod resource: Certificate/envoy-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-gateway-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-gw-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-idp-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-localhost-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-runtime-ds-server-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-system-api-listener-cert
DEPLOYER INFO Prod resource: Certificate/apptest-5mjr3ks3-wso2-apk-webhook-server-cert
DEPLOYER INFO Prod resource: Certificate/apim-apk-agent-server-cert
DEPLOYER INFO Prod resource: ClusterIssuer/apptest-5mjr3ks3-wso2-apk-selfsigned-issuer
DEPLOYER INFO Prod resource: ClusterIssuer/apk-agent-selfsigned-issuer
DEPLOYER INFO Prod resource: Gateway/wso2-apk-default
DEPLOYER INFO Prod resource: GatewayClass/wso2-apk-default
DEPLOYER INFO Prod resource: HTTPRoute/apptest-5mjr3ks3-wso2-apk-config-api-route
DEPLOYER INFO Prod resource: HTTPRoute/apptest-5mjr3ks3-wso2-apk-config-deploy-api-route
DEPLOYER INFO Prod resource: HTTPRoute/apptest-5mjr3ks3-wso2-apk-notification-api-route
DEPLOYER INFO Prod resource: Scope/apptest-5mjr3ks3-wso2-apk-api-create-scope
DEPLOYER INFO Prod resource: TokenIssuer/apptest-5mjr3ks3-wso2-apk-default-jwt-issuer
DEPLOYER INFO Prod resource: TokenIssuer/apptest-5mjr3ks3-wso2-apk-idp-jwt-issuer
DEPLOYER + kubectl apply --namespace=apptest-5mjr3ks3 --filename=/data/resources.yaml
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER networkpolicy.networking.k8s.io/redis created
DEPLOYER poddisruptionbudget.policy/apptest-5mjr3ks3-acp-pdb created
DEPLOYER poddisruptionbudget.policy/redis-master created
DEPLOYER serviceaccount/redis-master created
DEPLOYER serviceaccount/wso2apk-platform created
DEPLOYER serviceaccount/wso2agent-platform created
DEPLOYER secret/apk-root-certificate created
DEPLOYER secret/apptest-5mjr3ks3-wso2-apk-adapter-truststore-consul-secret created
DEPLOYER secret/apptest-5mjr3ks3-wso2-apk-sts-shared-auth-key created
DEPLOYER secret/apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret created
DEPLOYER secret/apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret created
DEPLOYER secret/apptest-5mjr3ks3-wso2-apk-token created
DEPLOYER secret/apim-apk-issuer-cert created
DEPLOYER secret/apk-agent-root-certificate created
DEPLOYER secret/agent-account-secret-token created
DEPLOYER configmap/apptest-5mjr3ks3-acp-conf-1 created
DEPLOYER configmap/apptest-5mjr3ks3-acp-conf-entrypoint created
DEPLOYER configmap/apptest-5mjr3ks3-acp-conf-log4j2 created
DEPLOYER configmap/apptest-5mjr3ks3-acp-conf-admin-settings created
DEPLOYER configmap/apptest-5mjr3ks3-acp-conf-devportal-settings created
DEPLOYER configmap/apptest-5mjr3ks3-acp-conf-publisher-settings created
DEPLOYER configmap/redis-configuration created
DEPLOYER configmap/redis-health created
DEPLOYER configmap/redis-scripts created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-config-ds-configmap created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-deployer-api-definition created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-wso2-apk-config-generator-api-definition created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-adapter-grpc-probe-script-conf created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-notification-api-definition created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-common-controller-grpc-probe-script-conf created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-common-log-conf created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-enforcer-grpc-probe-script-conf created
DEPLOYER configmap/apptest-5mjr3ks3-wso2-apk-log-conf created
DEPLOYER configmap/apptest-5mjr3ks3-log-conf created
DEPLOYER clusterrole.rbac.authorization.k8s.io/wso2apk-role created
DEPLOYER clusterrole.rbac.authorization.k8s.io/wso2agent-role created
DEPLOYER clusterrolebinding.rbac.authorization.k8s.io/apptest-5mjr3ks3-wso2-apk-role-binding created
DEPLOYER clusterrolebinding.rbac.authorization.k8s.io/agent-cluster-role-binding created
DEPLOYER service/apptest-5mjr3ks3-acp-1-service created
DEPLOYER service/apptest-5mjr3ks3-acp-service created
DEPLOYER service/redis-headless created
DEPLOYER service/redis-master created
DEPLOYER service/apptest-5mjr3ks3-wso2-apk-config-ds-service created
DEPLOYER service/apptest-5mjr3ks3-wso2-apk-adapter-service created
DEPLOYER service/apptest-5mjr3ks3-wso2-apk-common-controller-service created
DEPLOYER service/apptest-5mjr3ks3-wso2-apk-enforcer-service created
DEPLOYER service/apptest-5mjr3ks3-wso2-apk-gateway-service created
DEPLOYER service/apptest-5mjr3ks3-wso2-apk-ratelimiter-service created
DEPLOYER service/apim-apk-agent-service created
DEPLOYER deployment.apps/apptest-5mjr3ks3-acp-deployment-1 created
DEPLOYER deployment.apps/apptest-5mjr3ks3-wso2-apk-config-ds-deployment created
DEPLOYER deployment.apps/apptest-5mjr3ks3-wso2-apk-adapter-deployment created
DEPLOYER deployment.apps/apptest-5mjr3ks3-wso2-apk-common-controller-deployment created
DEPLOYER deployment.apps/apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment created
DEPLOYER deployment.apps/apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment created
DEPLOYER deployment.apps/apkagent created
DEPLOYER statefulset.apps/redis-master created
DEPLOYER ingress.networking.k8s.io/apptest-5mjr3ks3-acp-ingress created
DEPLOYER aiprovider.dp.wso2.com/ai-provider-azure-ai created
DEPLOYER aiprovider.dp.wso2.com/ai-provider-mistral-ai created
DEPLOYER aiprovider.dp.wso2.com/ai-provider-open-ai created
DEPLOYER application.app.k8s.io/apptest-5mjr3ks3 configured
DEPLOYER backend.dp.wso2.com/apptest-5mjr3ks3-wso2-apk-config-deployer-ds-backend created
DEPLOYER backend.dp.wso2.com/apptest-5mjr3ks3-wso2-apk-config-generator-backend created
DEPLOYER backend.dp.wso2.com/apptest-5mjr3ks3-wso2-apk-notification-api-backend created
DEPLOYER backendjwt.dp.wso2.com/apptest-5mjr3ks3-wso2-apk-config-api-backendjwt created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-adapter-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-common-controller-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-config-ds-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-enforcer-server-cert created
DEPLOYER certificate.cert-manager.io/envoy-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-gateway-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-gw-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-idp-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-localhost-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-runtime-ds-server-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-system-api-listener-cert created
DEPLOYER certificate.cert-manager.io/apptest-5mjr3ks3-wso2-apk-webhook-server-cert created
DEPLOYER certificate.cert-manager.io/apim-apk-agent-server-cert created
DEPLOYER clusterissuer.cert-manager.io/apptest-5mjr3ks3-wso2-apk-selfsigned-issuer created
DEPLOYER clusterissuer.cert-manager.io/apk-agent-selfsigned-issuer configured
DEPLOYER gateway.gateway.networking.k8s.io/wso2-apk-default created
DEPLOYER gatewayclass.gateway.networking.k8s.io/wso2-apk-default configured
DEPLOYER httproute.gateway.networking.k8s.io/apptest-5mjr3ks3-wso2-apk-config-api-route created
DEPLOYER httproute.gateway.networking.k8s.io/apptest-5mjr3ks3-wso2-apk-config-deploy-api-route created
DEPLOYER httproute.gateway.networking.k8s.io/apptest-5mjr3ks3-wso2-apk-notification-api-route created
DEPLOYER scope.dp.wso2.com/apptest-5mjr3ks3-wso2-apk-api-create-scope created
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-wso2-apk-config-deployer-api" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "API" in version "dp.wso2.com/v1alpha3"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-wso2-apk-config-generator-api" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "API" in version "dp.wso2.com/v1alpha3"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-wso2-apk-notification-api" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "API" in version "dp.wso2.com/v1alpha3"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-config-api-api-policy" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "APIPolicy" in version "dp.wso2.com/v1alpha4"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-configurator-api-no-authentication-policy" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "Authentication" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-notification-api-no-authentication-policy" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "Authentication" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-default-jwt-issuer" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "TokenIssuer" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER resource mapping not found for name: "apptest-5mjr3ks3-wso2-apk-idp-jwt-issuer" namespace: "apptest-5mjr3ks3" from "/data/resources.yaml": no matches for kind "TokenIssuer" in version "dp.wso2.com/v1alpha2"
DEPLOYER ensure CRDs are installed first
DEPLOYER + handle_failure
DEPLOYER + code=1
DEPLOYER + [[ -z apptest-5mjr3ks3 ]]
DEPLOYER + [[ -z apptest-5mjr3ks3 ]]
DEPLOYER + patch_assembly_phase.sh --status=Failed
DEPLOYER + for i in "$@"
DEPLOYER + case $i in
DEPLOYER + status=Failed
DEPLOYER + shift
DEPLOYER + [[ -z Failed ]]
DEPLOYER + [[ Failed =~ ^(Pending|Success|Failed)$ ]]
DEPLOYER + [[ -z apptest-5mjr3ks3 ]]
DEPLOYER + [[ -z apptest-5mjr3ks3 ]]
DEPLOYER + echo 'Marking deployment of application "apptest-5mjr3ks3" as "Failed".'
DEPLOYER Marking deployment of application "apptest-5mjr3ks3" as "Failed".
DEPLOYER + [[ Failed == \S\u\c\c\e\s\s ]]
DEPLOYER + kubectl patch applications.app.k8s.io/apptest-5mjr3ks3 --output=json --namespace=apptest-5mjr3ks3 --type=merge --patch '{"spec": {"assemblyPhase": "Failed"}}'
DEPLOYER Using /opt/kubectl/1.31/kubectl (server=1.32)
DEPLOYER {
DEPLOYER     "apiVersion": "app.k8s.io/v1beta1",
DEPLOYER     "kind": "Application",
DEPLOYER     "metadata": {
DEPLOYER         "annotations": {
DEPLOYER             "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"app.k8s.io/v1beta1\",\"kind\":\"Application\",\"metadata\":{\"annotations\":{\"kubernetes-engine.cloud.google.com/icon\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==\",\"marketplace.cloud.google.com/deploy-info\":\"{\\\"partner_id\\\": \\\"wso2-marketplace-public\\\", \\\"product_id\\\": \\\"wso2-apim-kubernetes\\\", \\\"partner_name\\\": \\\"WSO2\\\"}\"},\"labels\":{\"app.kubernetes.io/name\":\"apptest-5mjr3ks3\"},\"name\":\"apptest-5mjr3ks3\",\"namespace\":\"apptest-5mjr3ks3\"},\"spec\":{\"componentKinds\":[{\"group\":\"apps/v1\",\"kind\":\"Deployment\"},{\"group\":\"apps/v1\",\"kind\":\"StatefulSet\"},{\"group\":\"v1\",\"kind\":\"Service\"},{\"group\":\"v1\",\"kind\":\"ConfigMap\"},{\"group\":\"v1\",\"kind\":\"Secret\"}],\"descriptor\":{\"description\":\"WSO2 API Manager provides a complete platform for building, managing, and scaling APIs.\",\"links\":[{\"description\":\"User Guide: Getting Started\",\"url\":\"https://apim.docs.wso2.com/\"},{\"description\":\"WSO2 API Manager Documentation\",\"url\":\"https://apim.docs.wso2.com/en/latest/\"}],\"maintainers\":[{\"name\":\"WSO2\",\"url\":\"https://wso2.com\"}],\"notes\":\"WSO2 API Manager has been deployed. Access the management console and API gateway according to your ingress configuration.\",\"type\":\"WSO2 API Manager\",\"version\":\"4.5.0\"},\"selector\":{\"matchLabels\":{\"app.kubernetes.io/name\":\"apptest-5mjr3ks3\"}}}}\n",
DEPLOYER             "kubernetes-engine.cloud.google.com/icon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==",
DEPLOYER             "marketplace.cloud.google.com/deploy-info": "{\"partner_id\": \"wso2-marketplace-public\", \"product_id\": \"wso2-apim-kubernetes\", \"partner_name\": \"WSO2\"}"
DEPLOYER         },
DEPLOYER         "creationTimestamp": "2025-12-02T09:59:38Z",
DEPLOYER         "generation": 3,
DEPLOYER         "labels": {
DEPLOYER             "app.kubernetes.io/name": "apptest-5mjr3ks3"
DEPLOYER         },
DEPLOYER         "name": "apptest-5mjr3ks3",
DEPLOYER         "namespace": "apptest-5mjr3ks3",
DEPLOYER         "resourceVersion": "1764669623078671015",
DEPLOYER         "uid": "a82f27f1-84ff-4545-9bdb-186e532a17aa"
DEPLOYER     },
DEPLOYER     "spec": {
DEPLOYER         "assemblyPhase": "Failed",
DEPLOYER         "componentKinds": [
DEPLOYER             {
DEPLOYER                 "group": "apps/v1",
DEPLOYER                 "kind": "Deployment"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "apps/v1",
DEPLOYER                 "kind": "StatefulSet"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "v1",
DEPLOYER                 "kind": "Service"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "v1",
DEPLOYER                 "kind": "ConfigMap"
DEPLOYER             },
DEPLOYER             {
DEPLOYER                 "group": "v1",
DEPLOYER                 "kind": "Secret"
DEPLOYER             }
DEPLOYER         ],
DEPLOYER         "descriptor": {
DEPLOYER             "description": "WSO2 API Manager provides a complete platform for building, managing, and scaling APIs.",
DEPLOYER             "links": [
DEPLOYER                 {
DEPLOYER                     "description": "User Guide: Getting Started",
DEPLOYER                     "url": "https://apim.docs.wso2.com/"
DEPLOYER                 },
DEPLOYER                 {
DEPLOYER                     "description": "WSO2 API Manager Documentation",
DEPLOYER                     "url": "https://apim.docs.wso2.com/en/latest/"
DEPLOYER                 }
DEPLOYER             ],
DEPLOYER             "maintainers": [
DEPLOYER                 {
DEPLOYER                     "name": "WSO2",
DEPLOYER                     "url": "https://wso2.com"
DEPLOYER                 }
DEPLOYER             ],
DEPLOYER             "notes": "WSO2 API Manager has been deployed. Access the management console and API gateway according to your ingress configuration.",
DEPLOYER             "type": "WSO2 API Manager",
DEPLOYER             "version": "4.5.0"
DEPLOYER         },
DEPLOYER         "selector": {
DEPLOYER             "matchLabels": {
DEPLOYER                 "app.kubernetes.io/name": "apptest-5mjr3ks3"
DEPLOYER             }
DEPLOYER         }
DEPLOYER     }
DEPLOYER }
DEPLOYER + exit 1
Using /opt/kubectl/1.31/kubectl (server=1.32)
INFO Deleting namespace "apptest-5mjr3ks3"
Using /opt/kubectl/1.31/kubectl (server=1.32)
apiVersion: v1
items:
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: 2ba2373d663e022dd6b9f785c468c2338f5268d014367d07c7dd51b56b292c56
    creationTimestamp: "2025-12-02T10:00:21Z"
    generateName: apkagent-d87b99c4b-
    labels:
      app.kubernetes.io/app: apim-apk-agent
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/name: apkagent
      pod-template-hash: d87b99c4b
    name: apkagent-d87b99c4b-qxj9j
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apkagent-d87b99c4b
      uid: 437c958c-7f4e-4ffe-b7b9-73d8231b82ee
    resourceVersion: "1764669621366687017"
    uid: 35affb95-053c-4479-aefe-5c5fba88f1b8
  spec:
    containers:
    - env:
      - name: APIM_APK_AGENT_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/apk-agent.key
      - name: APIM_APK_AGENT_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/apk-agent.crt
      - name: APIM_APK_AGENT_SERVER_NAME
        value: apim-apk-agent-service.apptest-5mjr3ks3.svc
      - name: APIM_APK_AGENT_GRPC_PORT
        value: "18000"
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: apkagent
      ports:
      - containerPort: 18000
        name: grpc-port
        protocol: TCP
      - containerPort: 18001
        name: rest-port
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 200m
          memory: 256Mi
        requests:
          cpu: 100m
          memory: 128Mi
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/keystore/apk-agent.key
        name: apk-agent-certificates
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/apk-agent.crt
        name: apk-agent-certificates
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
        name: apk-agent-certificates
        subPath: ca.crt
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-htvlp
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext: {}
    serviceAccount: wso2agent-platform
    serviceAccountName: wso2agent-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - configMap:
        defaultMode: 420
        name: apptest-5mjr3ks3-log-conf
      name: log-conf-volume
    - name: apk-agent-certificates
      secret:
        defaultMode: 420
        secretName: apk-agent-server-cert
    - name: kube-api-access-htvlp
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      message: 'containers with unready status: [apkagent]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      message: 'containers with unready status: [apkagent]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
      imageID: ""
      lastState: {}
      name: apkagent
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/keystore/apk-agent.key
        name: apk-agent-certificates
      - mountPath: /home/wso2/security/keystore/apk-agent.crt
        name: apk-agent-certificates
      - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
        name: apk-agent-certificates
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-htvlp
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:00:21Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum.am.cp.conf: 3c9fe9d247bdc96a200d01118ebc7771717a59c7b92804d7ca581c7ea3f1c0c9
      checksum.am.cp.conf.log4j2: b169d29942d91253307e36ddf7ff2beff66ef1a9dbff1093ed922a9cbe720867
      checksum.am.cp.conf.secret: 6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb
      cloudmarketplace.googleapis.com/product.metadata: v1:{"services":[{"service_name":"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog",
        "service_level":"default"}]}
    creationTimestamp: "2025-12-02T10:00:19Z"
    generateName: apptest-5mjr3ks3-acp-deployment-1-6b454874d-
    labels:
      deployment: apptest-5mjr3ks3-acp
      node: apptest-5mjr3ks3-acp-1
      pod-template-hash: 6b454874d
      product: apim
    name: apptest-5mjr3ks3-acp-deployment-1-6b454874d-qxzkf
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-5mjr3ks3-acp-deployment-1-6b454874d
      uid: b55dd6b5-d713-4823-93ae-6a1133a25804
    resourceVersion: "1764669621642447012"
    uid: 079323b4-7bfd-48aa-931f-4a6f39451393
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: deployment
                operator: In
                values:
                - apptest-5mjr3ks3-acp
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - env:
      - name: PROFILE_NAME
        value: default
      - name: NODE_IP
        valueFrom:
          fieldRef:
            apiVersion: v1
            fieldPath: status.podIP
      - name: JVM_MEM_OPTS
        value: -Xms2048m -Xmx2048m
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
      imagePullPolicy: Always
      lifecycle:
        preStop:
          exec:
            command:
            - sh
            - -c
            - |
              echo "Pre stop hook triggered"; sleep 10; echo "Shutdown APIM Server"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop
      livenessProbe:
        failureThreshold: 3
        httpGet:
          path: /services/Version
          port: 9763
          scheme: HTTP
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 1
      name: wso2am-control-plane
      ports:
      - containerPort: 9763
        protocol: TCP
      - containerPort: 9443
        protocol: TCP
      - containerPort: 9711
        protocol: TCP
      - containerPort: 9611
        protocol: TCP
      - containerPort: 5672
        protocol: TCP
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /services/Version
          port: 9763
          scheme: HTTP
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: "3"
          memory: 5Gi
        requests:
          cpu: "2"
          memory: 2Gi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - all
        runAsNonRoot: true
        runAsUser: 10001
      startupProbe:
        exec:
          command:
          - /bin/sh
          - -c
          - timeout 1 bash -c "</dev/tcp/localhost/9443"
        failureThreshold: 3
        initialDelaySeconds: 60
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 1
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
        name: wso2am-control-plane-conf
        subPath: deployment.toml
      - mountPath: /home/wso2carbon/docker-entrypoint.sh
        name: wso2am-control-plane-entrypoint
        subPath: docker-entrypoint.sh
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
        name: wso2am-control-plane-log4j2
        subPath: log4j2.properties
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
        name: wso2am-conf-admin-settings
        subPath: settings.json
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
        name: wso2am-conf-devportal-settings
        subPath: settings.json
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
        name: wso2am-conf-publisher-settings
        subPath: settings.json
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-6d9ns
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-583b68cf-21fl
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: default
    serviceAccountName: default
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - configMap:
        defaultMode: 263
        name: apptest-5mjr3ks3-acp-conf-1
      name: wso2am-control-plane-conf
    - configMap:
        defaultMode: 263
        name: apptest-5mjr3ks3-acp-conf-entrypoint
      name: wso2am-control-plane-entrypoint
    - configMap:
        defaultMode: 263
        name: apptest-5mjr3ks3-acp-conf-log4j2
      name: wso2am-control-plane-log4j2
    - configMap:
        defaultMode: 263
        name: apptest-5mjr3ks3-acp-conf-admin-settings
      name: wso2am-conf-admin-settings
    - configMap:
        defaultMode: 263
        name: apptest-5mjr3ks3-acp-conf-devportal-settings
      name: wso2am-conf-devportal-settings
    - configMap:
        defaultMode: 263
        name: apptest-5mjr3ks3-acp-conf-publisher-settings
      name: wso2am-conf-publisher-settings
    - name: kube-api-access-6d9ns
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      status: "True"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      message: 'containers with unready status: [wso2am-control-plane]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      message: 'containers with unready status: [wso2am-control-plane]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - containerID: containerd://ec21394c96acfc987eac190420554eb8aa388d426e773a9b7a08b07fed93dae8
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
      imageID: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp@sha256:bfb3fd228700cab79b89c8bd38890a1a5ba3fd03bd3f51bb969c07d9b2e9922d
      lastState: {}
      name: wso2am-control-plane
      ready: false
      restartCount: 0
      started: false
      state:
        running:
          startedAt: "2025-12-02T10:00:20Z"
      volumeMounts:
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
        name: wso2am-control-plane-conf
      - mountPath: /home/wso2carbon/docker-entrypoint.sh
        name: wso2am-control-plane-entrypoint
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
        name: wso2am-control-plane-log4j2
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
        name: wso2am-conf-admin-settings
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
        name: wso2am-conf-devportal-settings
      - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
        name: wso2am-conf-publisher-settings
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-6d9ns
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.193
    hostIPs:
    - ip: 10.142.15.193
    phase: Running
    podIP: 10.76.0.26
    podIPs:
    - ip: 10.76.0.26
    qosClass: Burstable
    startTime: "2025-12-02T10:00:19Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      sidecar.istio.io/inject: "false"
    creationTimestamp: "2025-12-02T10:00:06Z"
    generateName: apptest-5mjr3ks3-deployer-
    labels:
      batch.kubernetes.io/controller-uid: c2884b93-60a4-4f34-89eb-0b91a926dea3
      batch.kubernetes.io/job-name: apptest-5mjr3ks3-deployer
      controller-uid: c2884b93-60a4-4f34-89eb-0b91a926dea3
      job-name: apptest-5mjr3ks3-deployer
    name: apptest-5mjr3ks3-deployer-22htk
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: batch/v1
      blockOwnerDeletion: true
      controller: true
      kind: Job
      name: apptest-5mjr3ks3-deployer
      uid: c2884b93-60a4-4f34-89eb-0b91a926dea3
    resourceVersion: "1764669625938591014"
    uid: 7e4f704a-3b5b-403e-92fe-e2e1d22e5ffa
  spec:
    containers:
    - command:
      - /bin/deploy_with_tests.sh
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
      imagePullPolicy: Always
      name: deployer
      resources:
        requests:
          cpu: 100m
          memory: 100Mi
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /data/values.yaml
        name: config-volume
        readOnly: true
        subPath: values.yaml
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-94fgr
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Never
    schedulerName: default-scheduler
    securityContext: {}
    serviceAccount: apptest-5mjr3ks3-deployer-sa
    serviceAccountName: apptest-5mjr3ks3-deployer-sa
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: config-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-deployer-config
    - name: kube-api-access-94fgr
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:24Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:06Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:23Z"
      reason: PodFailed
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:23Z"
      reason: PodFailed
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:06Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - containerID: containerd://ba48edfa856d84b7c7d34bf0bcbecc0184c3713bdb9ce9071cb6225e9b2c3fa5
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
      imageID: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer@sha256:a29bfae4764f13f42e07756c0889a67f8b0690afb413170188553db978db1bc4
      lastState: {}
      name: deployer
      ready: false
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://ba48edfa856d84b7c7d34bf0bcbecc0184c3713bdb9ce9071cb6225e9b2c3fa5
          exitCode: 1
          finishedAt: "2025-12-02T10:00:23Z"
          reason: Error
          startedAt: "2025-12-02T10:00:08Z"
      volumeMounts:
      - mountPath: /data/values.yaml
        name: config-volume
        readOnly: true
        recursiveReadOnly: Disabled
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-94fgr
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Failed
    podIP: 10.76.1.49
    podIPs:
    - ip: 10.76.1.49
    qosClass: Burstable
    startTime: "2025-12-02T10:00:06Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: 2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071
    creationTimestamp: "2025-12-02T10:00:19Z"
    generateName: apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-
    labels:
      app.kubernetes.io/app: adapter
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 6fd65c85bf
    name: apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf-wtzc9
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf
      uid: 7df12cb0-2363-4fb7-aa3c-1a15cc848206
    resourceVersion: "1764669620156607017"
    uid: 1d4cb4f2-c0ad-491c-b00c-eb581e687327
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - adapter
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - env:
      - name: OPERATOR_POD_NAMESPACE
        valueFrom:
          fieldRef:
            apiVersion: v1
            fieldPath: metadata.namespace
      - name: ADAPTER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/adapter.key
      - name: ADAPTER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/adapter.crt
      - name: ADAPTER_SERVER_NAME
        value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: adapter
      ports:
      - containerPort: 18000
        protocol: TCP
      - containerPort: 8765
        protocol: TCP
      - containerPort: 18005
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 200m
          memory: 128Mi
        requests:
          cpu: 50m
          memory: 64Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/adapter.key
        name: adapter-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/adapter.crt
        name: adapter-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: adapter-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/consul
        name: adapter-truststore-consul-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
        subPath: wso2-apim-carbon.pem
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-x7dpd
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: adapter-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-adapter-server-cert
    - name: adapter-truststore-consul-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-adapter-truststore-consul-secret
    - configMap:
        defaultMode: 420
        name: apptest-5mjr3ks3-wso2-apk-log-conf
      name: log-conf-volume
    - emptyDir: {}
      name: router-truststore-secret-volume
    - name: enforcer-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-server-cert
    - name: enforcer-apikey-cert
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
    - name: kube-api-access-x7dpd
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      message: 'containers with unready status: [adapter]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      message: 'containers with unready status: [adapter]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
      imageID: ""
      lastState: {}
      name: adapter
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/adapter.key
        name: adapter-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/adapter.crt
        name: adapter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: adapter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/consul
        name: adapter-truststore-consul-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-x7dpd
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:00:20Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: d7d9729495b578eaf450051044ddec481fee416a5d3f02f513cba4114f89a214
    creationTimestamp: "2025-12-02T10:00:20Z"
    generateName: apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f-
    labels:
      app.kubernetes.io/app: commoncontroller
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 745d86d97f
    name: apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745q8wbt
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f
      uid: 3924638e-e6f8-48db-99c2-eab337b3643d
    resourceVersion: "1764669620510495024"
    uid: 2a7831c6-8c29-4dfc-84e2-8d472f5973dd
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - common-controller
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - env:
      - name: OPERATOR_POD_NAMESPACE
        valueFrom:
          fieldRef:
            apiVersion: v1
            fieldPath: metadata.namespace
      - name: COMMON_CONTROLLER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/commoncontroller.key
      - name: COMMON_CONTROLLER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/commoncontroller.crt
      - name: COMMON_CONTROLLER_SERVER_NAME
        value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: commoncontroller
      ports:
      - containerPort: 18005
        protocol: TCP
      - containerPort: 18002
        protocol: TCP
      - containerPort: 9543
        protocol: TCP
      - containerPort: 18003
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 200m
          memory: 128Mi
        requests:
          cpu: 50m
          memory: 64Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/commoncontroller.key
        name: common-controller-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/commoncontroller.crt
        name: common-controller-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: common-controller-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /tmp/k8s-webhook-server/serving-certs
        name: adapter-webhook-server-cert
        readOnly: true
      - mountPath: /home/wso2/security/sts/
        name: sts-shared-auth-key
        readOnly: true
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-7xmgp
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: common-controller-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-common-controller-server-cert
    - configMap:
        defaultMode: 420
        name: apptest-5mjr3ks3-wso2-apk-common-log-conf
      name: log-conf-volume
    - name: adapter-webhook-server-cert
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-webhook-server-cert
    - name: sts-shared-auth-key
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-sts-shared-auth-key
    - name: ratelimiter-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
    - name: kube-api-access-7xmgp
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      message: 'containers with unready status: [commoncontroller]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      message: 'containers with unready status: [commoncontroller]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
      imageID: ""
      lastState: {}
      name: commoncontroller
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/commoncontroller.key
        name: common-controller-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/commoncontroller.crt
        name: common-controller-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter-ca.crt
        name: common-controller-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /tmp/k8s-webhook-server/serving-certs
        name: adapter-webhook-server-cert
        readOnly: true
        recursiveReadOnly: Disabled
      - mountPath: /home/wso2/security/sts/
        name: sts-shared-auth-key
        readOnly: true
        recursiveReadOnly: Disabled
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-7xmgp
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:00:20Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: fa9ec7acc06aa71ba3625b1baaf7e57e76a4068ecd8afe614b7aa597e33e0985
    creationTimestamp: "2025-12-02T10:00:19Z"
    generateName: apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-
    labels:
      app.kubernetes.io/app: configdeployer-ds
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 5777f5cb88
    name: apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88-pkm9q
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88
      uid: 496e3435-eae3-42ef-9286-a7b808d350db
    resourceVersion: "1764669619875983000"
    uid: 63189543-d984-4b90-a29f-78934a5b3cc6
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - config-ds
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    containers:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
      imagePullPolicy: Always
      livenessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 9443
          scheme: HTTPS
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: config-ds
      ports:
      - containerPort: 9443
        protocol: TCP
      readinessProbe:
        failureThreshold: 3
        httpGet:
          path: /health
          port: 9443
          scheme: HTTPS
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 500m
          memory: 1Gi
        requests:
          cpu: 200m
          memory: 512Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
        name: config-toml-volume
        subPath: Config.toml
      - mountPath: /home/wso2apk/config-deployer/security/config.key
        name: config-ds-tls-volume
        subPath: tls.key
      - mountPath: /home/wso2apk/config-deployer/security/config.pem
        name: config-ds-tls-volume
        subPath: tls.crt
      - mountPath: /home/wso2apk/config-deployer/security/mg.pem
        name: enforcer-jwt-secret-volume
        subPath: mg.pem
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2apk/config-deployer/tmp
        name: config-deployer-temp
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-jfhv2
        readOnly: true
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - configMap:
        defaultMode: 420
        name: apptest-5mjr3ks3-wso2-apk-config-ds-configmap
      name: config-toml-volume
    - name: config-ds-tls-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-config-ds-server-cert
    - name: enforcer-jwt-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret
    - emptyDir: {}
      name: tmp
    - emptyDir: {}
      name: config-deployer-temp
    - name: kube-api-access-jfhv2
      projected:
        defaultMode: 420
        sources:
        - serviceAccountToken:
            expirationSeconds: 3607
            path: token
        - configMap:
            items:
            - key: ca.crt
              path: ca.crt
            name: kube-root-ca.crt
        - downwardAPI:
            items:
            - fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
              path: namespace
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      message: 'containers with unready status: [config-ds]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      message: 'containers with unready status: [config-ds]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:19Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
      imageID: ""
      lastState: {}
      name: config-ds
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
        name: config-toml-volume
      - mountPath: /home/wso2apk/config-deployer/security/config.key
        name: config-ds-tls-volume
      - mountPath: /home/wso2apk/config-deployer/security/config.pem
        name: config-ds-tls-volume
      - mountPath: /home/wso2apk/config-deployer/security/mg.pem
        name: enforcer-jwt-secret-volume
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2apk/config-deployer/tmp
        name: config-deployer-temp
      - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
        name: kube-api-access-jfhv2
        readOnly: true
        recursiveReadOnly: Disabled
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:00:19Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/config: 2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071
    creationTimestamp: "2025-12-02T10:00:20Z"
    generateName: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf-
    labels:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 6f78cc4ccf
    name: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cxtbjk
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf
      uid: 28f11ca0-3ddc-4ce3-8bac-61489fe88aaf
    resourceVersion: "1764669620990351000"
    uid: 8a1e5b84-7b96-42f1-a757-5b525aa07220
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - gateway-runtime
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    automountServiceAccountToken: false
    containers:
    - env:
      - name: TOKEN_REVOCATION_ENABLED
        value: "true"
      - name: ADAPTER_HOST_NAME
        value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
      - name: ADAPTER_HOST
        value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
      - name: COMMON_CONTROLLER_HOST_NAME
        value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
      - name: COMMON_CONTROLLER_HOST
        value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
      - name: RATELIMITER_HOST
        value: apptest-5mjr3ks3-wso2-apk-ratelimiter-service.apptest-5mjr3ks3.svc
      - name: ENFORCER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/enforcer.key
      - name: ENFORCER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/enforcer.crt
      - name: ENFORCER_SERVER_NAME
        value: apptest-5mjr3ks3-wso2-apk-enforcer-service.apptest-5mjr3ks3.svc
      - name: TRUSTED_CA_CERTS_PATH
        value: /home/wso2/security/truststore
      - name: ADAPTER_XDS_PORT
        value: "18000"
      - name: RATELIMITER_PORT
        value: "8091"
      - name: COMMON_CONTROLLER_XDS_PORT
        value: "18002"
      - name: COMMON_CONTROLLER_REST_PORT
        value: "18003"
      - name: ENFORCER_LABEL
        value: wso2-apk-default
      - name: ENFORCER_REGION
        value: UNKNOWN
      - name: XDS_MAX_MSG_SIZE
        value: "4194304"
      - name: XDS_MAX_RETRIES
        value: "3"
      - name: enforcer_admin_pwd
        value: admin
      - name: REDIS_USERNAME
        value: default
      - name: REDIS_PASSWORD
      - name: REDIS_HOST
        value: redis-master
      - name: REDIS_PORT
        value: "6379"
      - name: IS_REDIS_TLS_ENABLED
        value: "false"
      - name: REDIS_REVOKED_TOKENS_CHANNEL
        value: wso2-apk-revoked-tokens-channel
      - name: REDIS_KEY_FILE
        value: /home/wso2/security/truststore/enforcer.key
      - name: REDIS_CERT_FILE
        value: /home/wso2/security/truststore/enforcer.crt
      - name: REDIS_CA_CERT_FILE
        value: /home/wso2/security/truststore/enforcer.crt
      - name: REVOKED_TOKEN_CLEANUP_INTERVAL
        value: "3600"
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: enforcer
      ports:
      - containerPort: 8081
        protocol: TCP
      - containerPort: 9001
        protocol: TCP
      - containerPort: 5006
        protocol: TCP
      - containerPort: 8084
        protocol: TCP
      - containerPort: 9092
        protocol: TCP
      - containerPort: 18002
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - check_health.sh
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 500m
          memory: 512Mi
        requests:
          cpu: 200m
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
        runAsNonRoot: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2/security/keystore/enforcer.key
        name: enforcer-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/enforcer.crt
        name: enforcer-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/apk.crt
        name: enforcer-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/check_health.sh
        name: enforcer-health-check-volume
        subPath: check_health.sh
      - mountPath: /home/wso2/security/keystore/mg.pem
        name: enforcer-jwt-secret-volume
        subPath: mg.pem
      - mountPath: /home/wso2/security/truststore/mg.pem
        name: enforcer-jwt-secret-volume
        subPath: mg.pem
      - mountPath: /home/wso2/security/keystore/mg.key
        name: enforcer-jwt-secret-volume
        subPath: mg.key
      - mountPath: /home/wso2/security/truststore/wso2carbon.pem
        name: enforcer-trusted-certs
        subPath: wso2carbon.pem
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
        subPath: wso2-apim-carbon.pem
      - mountPath: /home/wso2/security/truststore/idp.pem
        name: idp-certificate-secret-volume
        subPath: wso2carbon.pem
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
        subPath: ca.crt
    - env:
      - name: ADAPTER_HOST_NAME
        value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
      - name: ADAPTER_HOST
        value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
      - name: ENFORCER_HOST
        value: 127.0.0.1
      - name: ENFORCER_ANALYTICS_HOST
        value: 127.0.0.1
      - name: ROUTER_ADMIN_HOST
        value: 0.0.0.0
      - name: ROUTER_ADMIN_PORT
        value: "9000"
      - name: ROUTER_PORT
        value: "9095"
      - name: ROUTER_CLUSTER
        value: apk_router_cluster
      - name: ROUTER_LABEL
        value: wso2-apk-default
      - name: ROUTER_PRIVATE_KEY_PATH
        value: /home/wso2/security/keystore/router.key
      - name: ROUTER_PUBLIC_CERT_PATH
        value: /home/wso2/security/keystore/router.crt
      - name: ADAPTER_PORT
        value: "18000"
      - name: ADAPTER_CA_CERT_PATH
        value: /home/wso2/security/truststore/adapter.crt
      - name: ENFORCER_PORT
        value: "8081"
      - name: ENFORCER_ANALYTICS_RECEIVER_PORT
        value: "18090"
      - name: ENFORCER_CA_CERT_PATH
        value: /home/wso2/security/truststore/enforcer.crt
      - name: CONCURRENCY
        value: "2"
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
      imagePullPolicy: Always
      livenessProbe:
        exec:
          command:
          - sh
          - router_check_health.sh
          - health
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: router
      ports:
      - containerPort: 9095
        protocol: TCP
      - containerPort: 9090
        protocol: TCP
      - containerPort: 9091
        protocol: TCP
      - containerPort: 9000
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - router_check_health.sh
          - health
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: "1"
          memory: 1028Mi
        requests:
          cpu: 200m
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
        runAsNonRoot: true
      startupProbe:
        exec:
          command:
          - sh
          - router_check_health.sh
          - health
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/router.key
        name: router-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/router.crt
        name: router-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
        subPath: ca.crt
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: default
    serviceAccountName: default
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: ratelimiter-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
    - name: enforcer-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-server-cert
    - configMap:
        defaultMode: 420
        name: apptest-5mjr3ks3-wso2-apk-log-conf
      name: log-conf-volume
    - configMap:
        defaultMode: 420
        name: apptest-5mjr3ks3-wso2-apk-enforcer-grpc-probe-script-conf
      name: enforcer-health-check-volume
    - name: router-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-gateway-server-cert
    - name: adapter-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-adapter-server-cert
    - name: enforcer-jwt-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret
    - name: enforcer-trusted-certs
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
    - name: enforcer-apikey-cert
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
    - name: idp-certificate-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
    - emptyDir: {}
      name: tmp
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      message: 'containers with unready status: [enforcer router]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      message: 'containers with unready status: [enforcer router]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:20Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
      imageID: ""
      lastState: {}
      name: enforcer
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /tmp
        name: tmp
      - mountPath: /home/wso2/security/keystore/enforcer.key
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/enforcer.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/apk.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/router.crt
        name: router-keystore-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/check_health.sh
        name: enforcer-health-check-volume
      - mountPath: /home/wso2/security/keystore/mg.pem
        name: enforcer-jwt-secret-volume
      - mountPath: /home/wso2/security/truststore/mg.pem
        name: enforcer-jwt-secret-volume
      - mountPath: /home/wso2/security/keystore/mg.key
        name: enforcer-jwt-secret-volume
      - mountPath: /home/wso2/security/truststore/wso2carbon.pem
        name: enforcer-trusted-certs
      - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
        name: enforcer-apikey-cert
      - mountPath: /home/wso2/security/truststore/idp.pem
        name: idp-certificate-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
      imageID: ""
      lastState: {}
      name: router
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/router.key
        name: router-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/router.crt
        name: router-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter.crt
        name: adapter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/enforcer.crt
        name: enforcer-keystore-secret-volume
      - mountPath: /home/wso2/conf/
        name: log-conf-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter.crt
        name: ratelimiter-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-truststore-secret-volume
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:00:20Z"
- apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: "2025-12-02T10:00:20Z"
    generateName: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc-
    labels:
      app.kubernetes.io/app: ratelimiter
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 7c67b45dbc
    name: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45db9vwnz
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: ReplicaSet
      name: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc
      uid: fa2cc910-3e09-417d-81a8-ffc3a6415569
    resourceVersion: "1764669621272879004"
    uid: ade8984f-1282-4644-a9bd-545dc8361c72
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchExpressions:
              - key: app.kubernetes.io/app
                operator: In
                values:
                - rate-limiter
            topologyKey: topology.kubernetes.io/zone
          weight: 100
    automountServiceAccountToken: false
    containers:
    - env:
      - name: HOST
        value: 0.0.0.0
      - name: PORT
        value: "8090"
      - name: USE_STATSD
        value: "false"
      - name: LOG_LEVEL
        value: DEBUG
      - name: LIMIT_RESPONSE_HEADERS_ENABLED
        value: "false"
      - name: REDIS_TYPE
        value: single
      - name: REDIS_SOCKET_TYPE
        value: tcp
      - name: REDIS_URL
        value: redis-master:6379
      - name: REDIS_PIPELINE_WINDOW
        value: 0.2ms
      - name: REDIS_PIPELINE_LIMIT
        value: "0"
      - name: GRPC_HOST
        value: 0.0.0.0
      - name: GRPC_PORT
        value: "8091"
      - name: GRPC_SERVER_USE_TLS
        value: "true"
      - name: GRPC_SERVER_TLS_KEY
        value: /home/wso2/security/keystore/ratelimiter.key
      - name: GRPC_SERVER_TLS_CERT
        value: /home/wso2/security/keystore/ratelimiter.crt
      - name: GRPC_CLIENT_TLS_CACERT
        value: /home/wso2/security/truststore/ratelimiter-ca.crt
      - name: RATELIMITER_LABEL
        value: ratelimiter
      - name: CONFIG_GRPC_XDS_SERVER_URL
        value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc:18005
      - name: CONFIG_GRPC_XDS_SERVER_USE_TLS
        value: "true"
      - name: CONFIG_GRPC_XDS_CLIENT_TLS_KEY
        value: /home/wso2/security/keystore/ratelimiter.key
      - name: CONFIG_GRPC_XDS_CLIENT_TLS_CERT
        value: /home/wso2/security/keystore/ratelimiter.crt
      - name: CONFIG_GRPC_XDS_SERVER_TLS_CACERT
        value: /home/wso2/security/truststore/ratelimiter-ca.crt
      - name: CONFIG_GRPC_XDS_SERVER_TLS_SAN
        value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
      image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
      imagePullPolicy: Always
      livenessProbe:
        failureThreshold: 5
        httpGet:
          path: /healthcheck
          port: 8090
          scheme: HTTP
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      name: ratelimiter
      ports:
      - containerPort: 8090
        protocol: TCP
      - containerPort: 8091
        protocol: TCP
      - containerPort: 6070
        protocol: TCP
      readinessProbe:
        failureThreshold: 5
        httpGet:
          path: /healthcheck
          port: 8090
          scheme: HTTP
        initialDelaySeconds: 20
        periodSeconds: 20
        successThreshold: 1
        timeoutSeconds: 1
      resources:
        limits:
          cpu: 100m
          memory: 128Mi
        requests:
          cpu: 50m
          memory: 64Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/ratelimiter.key
        name: ratelimiter-keystore-secret-volume
        subPath: tls.key
      - mountPath: /home/wso2/security/keystore/ratelimiter.crt
        name: ratelimiter-keystore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-keystore-secret-volume
        subPath: ca.crt
      - mountPath: /home/wso2/security/truststore/adapter.pem
        name: common-controller-truststore-secret-volume
        subPath: tls.crt
      - mountPath: /home/wso2/security/truststore/router.pem
        name: router-truststore-secret-volume
        subPath: tls.crt
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: wso2apk-platform
    serviceAccountName: wso2apk-platform
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: ratelimiter-keystore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
    - name: common-controller-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-common-controller-server-cert
    - name: router-truststore-secret-volume
      secret:
        defaultMode: 420
        secretName: apptest-5mjr3ks3-wso2-apk-gateway-server-cert
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      status: "False"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      message: 'containers with unready status: [ratelimiter]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      message: 'containers with unready status: [ratelimiter]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:21Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
      imageID: ""
      lastState: {}
      name: ratelimiter
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: ContainerCreating
      volumeMounts:
      - mountPath: /home/wso2/security/keystore/ratelimiter.key
        name: ratelimiter-keystore-secret-volume
      - mountPath: /home/wso2/security/keystore/ratelimiter.crt
        name: ratelimiter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
        name: ratelimiter-keystore-secret-volume
      - mountPath: /home/wso2/security/truststore/adapter.pem
        name: common-controller-truststore-secret-volume
      - mountPath: /home/wso2/security/truststore/router.pem
        name: router-truststore-secret-volume
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Pending
    qosClass: Burstable
    startTime: "2025-12-02T10:00:21Z"
- apiVersion: v1
  kind: Pod
  metadata:
    annotations:
      checksum/configmap: 2a9ab4a5432825504d910f022638674ce88eaefe9f9f595ad8bc107377d104fb
      checksum/health: aff24913d801436ea469d8d374b2ddb3ec4c43ee7ab24663d5f8ff1a1b6991a9
      checksum/scripts: bdec350b84a1ace7cc118db113a21c9f160bde3425b07714e1c0c1da722621cf
      checksum/secret: 44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a
    creationTimestamp: "2025-12-02T10:00:21Z"
    generateName: redis-master-
    labels:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      apps.kubernetes.io/pod-index: "0"
      controller-revision-hash: redis-master-c4bd6cbb8
      helm.sh/chart: redis-20.10.0
      statefulset.kubernetes.io/pod-name: redis-master-0
    name: redis-master-0
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: StatefulSet
      name: redis-master
      uid: 3fd64999-f757-4f09-97fd-d5b0bed8f363
    resourceVersion: "1764669635886607012"
    uid: 29737555-928a-4dbf-8348-23a0a793d9f4
  spec:
    affinity:
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
        - podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/component: master
                app.kubernetes.io/instance: apptest-5mjr3ks3
                app.kubernetes.io/name: redis
            topologyKey: kubernetes.io/hostname
          weight: 1
    automountServiceAccountToken: false
    containers:
    - args:
      - -c
      - /opt/bitnami/scripts/start-scripts/start-master.sh
      command:
      - /bin/bash
      env:
      - name: BITNAMI_DEBUG
        value: "true"
      - name: REDIS_REPLICATION_MODE
        value: master
      - name: ALLOW_EMPTY_PASSWORD
        value: "yes"
      - name: REDIS_TLS_ENABLED
        value: "no"
      - name: REDIS_PORT
        value: "6379"
      image: docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4
      imagePullPolicy: IfNotPresent
      livenessProbe:
        exec:
          command:
          - sh
          - -c
          - /health/ping_liveness_local.sh 5
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 6
      name: redis
      ports:
      - containerPort: 6379
        name: redis
        protocol: TCP
      readinessProbe:
        exec:
          command:
          - sh
          - -c
          - /health/ping_readiness_local.sh 1
        failureThreshold: 5
        initialDelaySeconds: 20
        periodSeconds: 5
        successThreshold: 1
        timeoutSeconds: 2
      resources:
        limits:
          cpu: 150m
          ephemeral-storage: 2Gi
          memory: 192Mi
        requests:
          cpu: 100m
          ephemeral-storage: 50Mi
          memory: 128Mi
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
        runAsGroup: 1001
        runAsNonRoot: true
        seLinuxOptions: {}
        seccompProfile:
          type: RuntimeDefault
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
      - mountPath: /opt/bitnami/scripts/start-scripts
        name: start-scripts
      - mountPath: /health
        name: health
      - mountPath: /data
        name: redis-data
      - mountPath: /opt/bitnami/redis/mounted-etc
        name: config
      - mountPath: /opt/bitnami/redis/etc/
        name: empty-dir
        subPath: app-conf-dir
      - mountPath: /tmp
        name: empty-dir
        subPath: tmp-dir
    dnsPolicy: ClusterFirst
    enableServiceLinks: true
    hostname: redis-master-0
    nodeName: gke-wso2-apim-gke-test-cpu-pool-370e02e4-tdv6
    preemptionPolicy: PreemptLowerPriority
    priority: 0
    restartPolicy: Always
    schedulerName: default-scheduler
    securityContext:
      fsGroup: 1001
      fsGroupChangePolicy: Always
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
    serviceAccount: redis-master
    serviceAccountName: redis-master
    subdomain: redis-headless
    terminationGracePeriodSeconds: 30
    tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
    volumes:
    - name: redis-data
      persistentVolumeClaim:
        claimName: redis-data-redis-master-0
    - configMap:
        defaultMode: 493
        name: redis-scripts
      name: start-scripts
    - configMap:
        defaultMode: 493
        name: redis-health
      name: health
    - configMap:
        defaultMode: 420
        name: redis-configuration
      name: config
    - emptyDir: {}
      name: empty-dir
  status:
    conditions:
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:35Z"
      status: "True"
      type: PodReadyToStartContainers
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:25Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:25Z"
      message: 'containers with unready status: [redis]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:25Z"
      message: 'containers with unready status: [redis]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2025-12-02T10:00:25Z"
      status: "True"
      type: PodScheduled
    containerStatuses:
    - containerID: containerd://9ca34c7767c28e7f138b6fb6e66c3e016e168d30f294fa9d329015f465e92e63
      image: docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4
      imageID: docker.io/bitnamilegacy/redis@sha256:83d5c765b68bdd01603ea5cbad96abc196e37fb875dc2e9fb8b9bdcce59d13d5
      lastState: {}
      name: redis
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2025-12-02T10:00:35Z"
      volumeMounts:
      - mountPath: /opt/bitnami/scripts/start-scripts
        name: start-scripts
      - mountPath: /health
        name: health
      - mountPath: /data
        name: redis-data
      - mountPath: /opt/bitnami/redis/mounted-etc
        name: config
      - mountPath: /opt/bitnami/redis/etc/
        name: empty-dir
      - mountPath: /tmp
        name: empty-dir
    hostIP: 10.142.15.194
    hostIPs:
    - ip: 10.142.15.194
    phase: Running
    podIP: 10.76.1.50
    podIPs:
    - ip: 10.76.1.50
    qosClass: Burstable
    startTime: "2025-12-02T10:00:25Z"
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apim-apk-agent-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"grpc-server","port":18000,"protocol":"TCP"},{"name":"rest-server","port":18001,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"apim-apk-agent"}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apim-apk-agent-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619370047021"
    uid: 5ff83d28-9beb-4422-9486-9e192018f14c
  spec:
    clusterIP: 34.118.226.182
    clusterIPs:
    - 34.118.226.182
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: grpc-server
      port: 18000
      protocol: TCP
      targetPort: 18000
    - name: rest-server
      port: 18001
      protocol: TCP
      targetPort: 18001
    selector:
      app.kubernetes.io/app: apim-apk-agent
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-acp-1-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"binary","port":9611,"protocol":"TCP"},{"name":"binary-secure","port":9711,"protocol":"TCP"},{"name":"jms-tcp","port":5672,"protocol":"TCP"},{"name":"servlet-https","port":9443,"protocol":"TCP"},{"name":"jwks","port":9763,"protocol":"TCP"}],"selector":{"deployment":"apptest-5mjr3ks3-acp","node":"apptest-5mjr3ks3-acp-1"}}}
    creationTimestamp: "2025-12-02T10:00:18Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-acp-1-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669618730703011"
    uid: 183d53e2-adbb-42d3-8b6e-795b01b4bf94
  spec:
    clusterIP: 34.118.225.42
    clusterIPs:
    - 34.118.225.42
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: binary
      port: 9611
      protocol: TCP
      targetPort: 9611
    - name: binary-secure
      port: 9711
      protocol: TCP
      targetPort: 9711
    - name: jms-tcp
      port: 5672
      protocol: TCP
      targetPort: 5672
    - name: servlet-https
      port: 9443
      protocol: TCP
      targetPort: 9443
    - name: jwks
      port: 9763
      protocol: TCP
      targetPort: 9763
    selector:
      deployment: apptest-5mjr3ks3-acp
      node: apptest-5mjr3ks3-acp-1
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-acp-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"servlet-http","port":9763,"protocol":"TCP"},{"name":"servlet-https","port":9443,"protocol":"TCP"}],"selector":{"deployment":"apptest-5mjr3ks3-acp"}}}
    creationTimestamp: "2025-12-02T10:00:18Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-acp-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669618790863016"
    uid: 3438e4e4-4102-42be-b7ad-51835caaf33b
  spec:
    clusterIP: 34.118.227.203
    clusterIPs:
    - 34.118.227.203
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: servlet-http
      port: 9763
      protocol: TCP
      targetPort: 9763
    - name: servlet-https
      port: 9443
      protocol: TCP
      targetPort: 9443
    selector:
      deployment: apptest-5mjr3ks3-acp
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-adapter-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"endpoint1","port":8765,"protocol":"TCP"},{"name":"endpoint2","port":18000,"protocol":"TCP"},{"name":"webhook-server","port":443,"protocol":"TCP","targetPort":9443},{"name":"https-rate-limiter","port":18005,"protocol":"TCP"},{"name":"profile-port","port":6060,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"adapter","app.kubernetes.io/release":"apptest-5mjr3ks3"}}}
    creationTimestamp: "2025-12-02T10:00:18Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-adapter-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619019055011"
    uid: d84eadd0-4020-40c6-bf41-9667bb697087
  spec:
    clusterIP: 34.118.226.187
    clusterIPs:
    - 34.118.226.187
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: endpoint1
      port: 8765
      protocol: TCP
      targetPort: 8765
    - name: endpoint2
      port: 18000
      protocol: TCP
      targetPort: 18000
    - name: webhook-server
      port: 443
      protocol: TCP
      targetPort: 9443
    - name: https-rate-limiter
      port: 18005
      protocol: TCP
      targetPort: 18005
    - name: profile-port
      port: 6060
      protocol: TCP
      targetPort: 6060
    selector:
      app.kubernetes.io/app: adapter
      app.kubernetes.io/release: apptest-5mjr3ks3
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-common-controller-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"https-rate-limiter","port":18005,"protocol":"TCP"},{"name":"https-enforcer-xds","port":18002,"protocol":"TCP"},{"name":"webhook-server","port":443,"protocol":"TCP","targetPort":9443},{"name":"https-internal-api","port":18003,"protocol":"TCP"},{"name":"web-server","port":9543,"protocol":"TCP","targetPort":9543}],"selector":{"app.kubernetes.io/app":"commoncontroller","app.kubernetes.io/release":"apptest-5mjr3ks3"}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-common-controller-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619095167007"
    uid: 39350837-b180-420e-b0de-a6412d2a9f5c
  spec:
    clusterIP: 34.118.236.174
    clusterIPs:
    - 34.118.236.174
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: https-rate-limiter
      port: 18005
      protocol: TCP
      targetPort: 18005
    - name: https-enforcer-xds
      port: 18002
      protocol: TCP
      targetPort: 18002
    - name: webhook-server
      port: 443
      protocol: TCP
      targetPort: 9443
    - name: https-internal-api
      port: 18003
      protocol: TCP
      targetPort: 18003
    - name: web-server
      port: 9543
      protocol: TCP
      targetPort: 9543
    selector:
      app.kubernetes.io/app: commoncontroller
      app.kubernetes.io/release: apptest-5mjr3ks3
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-config-ds-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"servlet-https","port":9443,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"configdeployer-ds","app.kubernetes.io/release":"apptest-5mjr3ks3"}}}
    creationTimestamp: "2025-12-02T10:00:18Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-config-ds-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669618969887000"
    uid: ddedac67-0dce-4544-a93c-8d886ec378b2
  spec:
    clusterIP: 34.118.235.120
    clusterIPs:
    - 34.118.235.120
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: servlet-https
      port: 9443
      protocol: TCP
      targetPort: 9443
    selector:
      app.kubernetes.io/app: configdeployer-ds
      app.kubernetes.io/release: apptest-5mjr3ks3
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-enforcer-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"servlet-https","port":9092,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-5mjr3ks3"}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-enforcer-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619162191017"
    uid: 75af389d-0750-4d22-871a-4b84baf008a5
  spec:
    clusterIP: 34.118.236.222
    clusterIPs:
    - 34.118.236.222
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: servlet-https
      port: 9092
      protocol: TCP
      targetPort: 9092
    selector:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-5mjr3ks3
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-gateway-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"https-endpoint","port":9095,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-5mjr3ks3"},"type":"LoadBalancer"}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    finalizers:
    - service.kubernetes.io/load-balancer-cleanup
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-gateway-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619282991005"
    uid: d14be46c-8518-429d-b5c7-26d15ff9444d
  spec:
    allocateLoadBalancerNodePorts: true
    clusterIP: 34.118.229.211
    clusterIPs:
    - 34.118.229.211
    externalTrafficPolicy: Cluster
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: https-endpoint
      nodePort: 32210
      port: 9095
      protocol: TCP
      targetPort: 9095
    selector:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-5mjr3ks3
    sessionAffinity: None
    type: LoadBalancer
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-ratelimiter-service","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"ports":[{"name":"endpoint1","port":8090,"protocol":"TCP"},{"name":"endpoint2","port":8091,"protocol":"TCP"},{"name":"endpoint3","port":6070,"protocol":"TCP"}],"selector":{"app.kubernetes.io/app":"ratelimiter","app.kubernetes.io/release":"apptest-5mjr3ks3"}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-ratelimiter-service
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619311775007"
    uid: 3abb0ec5-54e8-4c01-89a9-f18187dbe1c5
  spec:
    clusterIP: 34.118.230.92
    clusterIPs:
    - 34.118.230.92
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: endpoint1
      port: 8090
      protocol: TCP
      targetPort: 8090
    - name: endpoint2
      port: 8091
      protocol: TCP
      targetPort: 8091
    - name: endpoint3
      port: 6070
      protocol: TCP
      targetPort: 6070
    selector:
      app.kubernetes.io/app: ratelimiter
      app.kubernetes.io/release: apptest-5mjr3ks3
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"},"name":"redis-headless","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"clusterIP":"None","ports":[{"name":"tcp-redis","port":6379,"targetPort":"redis"}],"selector":{"app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/name":"redis"},"type":"ClusterIP"}}
    creationTimestamp: "2025-12-02T10:00:18Z"
    labels:
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      helm.sh/chart: redis-20.10.0
    name: redis-headless
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669618843263000"
    uid: 81f4aa72-b769-4787-bd28-8cbc1be6126a
  spec:
    clusterIP: None
    clusterIPs:
    - None
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: tcp-redis
      port: 6379
      protocol: TCP
      targetPort: redis
    selector:
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/name: redis
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: v1
  kind: Service
  metadata:
    annotations:
      cloud.google.com/neg: '{"ingress":true}'
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"v1","kind":"Service","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"},"name":"redis-master","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"internalTrafficPolicy":"Cluster","ports":[{"name":"tcp-redis","nodePort":null,"port":6379,"targetPort":"redis"}],"selector":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/name":"redis"},"sessionAffinity":"None","type":"ClusterIP"}}
    creationTimestamp: "2025-12-02T10:00:18Z"
    labels:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      helm.sh/chart: redis-20.10.0
    name: redis-master
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669618910383000"
    uid: 55264e36-49a2-44ef-921a-3398a4ed6ce4
  spec:
    clusterIP: 34.118.231.124
    clusterIPs:
    - 34.118.231.124
    internalTrafficPolicy: Cluster
    ipFamilies:
    - IPv4
    ipFamilyPolicy: SingleStack
    ports:
    - name: tcp-redis
      port: 6379
      protocol: TCP
      targetPort: redis
    selector:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/name: redis
    sessionAffinity: None
    type: ClusterIP
  status:
    loadBalancer: {}
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/app":"apim-apk-agent","app.kubernetes.io/name":"apptest-5mjr3ks3","helm.sh/chart":"apkagent"},"name":"apkagent","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"apim-apk-agent","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/name":"apkagent"}},"template":{"metadata":{"annotations":{"checksum/config":"2ba2373d663e022dd6b9f785c468c2338f5268d014367d07c7dd51b56b292c56"},"labels":{"app.kubernetes.io/app":"apim-apk-agent","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/name":"apkagent"}},"spec":{"containers":[{"env":[{"name":"APIM_APK_AGENT_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/apk-agent.key"},{"name":"APIM_APK_AGENT_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/apk-agent.crt"},{"name":"APIM_APK_AGENT_SERVER_NAME","value":"apim-apk-agent-service.apptest-5mjr3ks3.svc"},{"name":"APIM_APK_AGENT_GRPC_PORT","value":"18000"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"apkagent","ports":[{"containerPort":18000,"name":"grpc-port"},{"containerPort":18001,"name":"rest-port"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"200m","memory":"256Mi"},"requests":{"cpu":"100m","memory":"128Mi"}},"volumeMounts":[{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/security/keystore/apk-agent.key","name":"apk-agent-certificates","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/apk-agent.crt","name":"apk-agent-certificates","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/apk-agent-ca.crt","name":"apk-agent-certificates","subPath":"ca.crt"}]}],"serviceAccountName":"wso2agent-platform","volumes":[{"configMap":{"name":"apptest-5mjr3ks3-log-conf"},"name":"log-conf-volume"},{"name":"apk-agent-certificates","secret":{"secretName":"apk-agent-server-cert"}}]}}}}
    creationTimestamp: "2025-12-02T10:00:20Z"
    generation: 1
    labels:
      app.kubernetes.io/app: apim-apk-agent
      app.kubernetes.io/name: apptest-5mjr3ks3
      helm.sh/chart: apkagent
    name: apkagent
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669621381871008"
    uid: e573d158-8e95-4cb4-827e-a79fa656d5e1
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: apim-apk-agent
        app.kubernetes.io/instance: apptest-5mjr3ks3
        app.kubernetes.io/name: apkagent
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: 2ba2373d663e022dd6b9f785c468c2338f5268d014367d07c7dd51b56b292c56
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: apim-apk-agent
          app.kubernetes.io/instance: apptest-5mjr3ks3
          app.kubernetes.io/name: apkagent
      spec:
        containers:
        - env:
          - name: APIM_APK_AGENT_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/apk-agent.key
          - name: APIM_APK_AGENT_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/apk-agent.crt
          - name: APIM_APK_AGENT_SERVER_NAME
            value: apim-apk-agent-service.apptest-5mjr3ks3.svc
          - name: APIM_APK_AGENT_GRPC_PORT
            value: "18000"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: apkagent
          ports:
          - containerPort: 18000
            name: grpc-port
            protocol: TCP
          - containerPort: 18001
            name: rest-port
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 128Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/keystore/apk-agent.key
            name: apk-agent-certificates
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/apk-agent.crt
            name: apk-agent-certificates
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
            name: apk-agent-certificates
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: wso2agent-platform
        serviceAccountName: wso2agent-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-log-conf
          name: log-conf-volume
        - name: apk-agent-certificates
          secret:
            defaultMode: 420
            secretName: apk-agent-server-cert
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:00:21Z"
      lastUpdateTime: "2025-12-02T10:00:21Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:00:20Z"
      lastUpdateTime: "2025-12-02T10:00:21Z"
      message: ReplicaSet "apkagent-d87b99c4b" is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-acp-deployment-1","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"deployment":"apptest-5mjr3ks3-acp","node":"apptest-5mjr3ks3-acp-1"}},"strategy":{"type":"Recreate"},"template":{"metadata":{"annotations":{"checksum.am.cp.conf":"3c9fe9d247bdc96a200d01118ebc7771717a59c7b92804d7ca581c7ea3f1c0c9","checksum.am.cp.conf.log4j2":"b169d29942d91253307e36ddf7ff2beff66ef1a9dbff1093ed922a9cbe720867","checksum.am.cp.conf.secret":"6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb","cloudmarketplace.googleapis.com/product.metadata":"v1:{\"services\":[{\"service_name\":\"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog\", \"service_level\":\"default\"}]}"},"labels":{"deployment":"apptest-5mjr3ks3-acp","node":"apptest-5mjr3ks3-acp-1","product":"apim"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"deployment","operator":"In","values":["apptest-5mjr3ks3-acp"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":[{"name":"PROFILE_NAME","value":"default"},{"name":"NODE_IP","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"status.podIP"}}},{"name":"JVM_MEM_OPTS","value":"-Xms2048m -Xmx2048m"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5","imagePullPolicy":"Always","lifecycle":{"preStop":{"exec":{"command":["sh","-c","echo \"Pre stop hook triggered\"; sleep 10; echo \"Shutdown APIM Server\"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop\n"]}}},"livenessProbe":{"failureThreshold":3,"httpGet":{"path":"/services/Version","port":9763},"initialDelaySeconds":60,"periodSeconds":10},"name":"wso2am-control-plane","ports":[{"containerPort":9763,"protocol":"TCP"},{"containerPort":9443,"protocol":"TCP"},{"containerPort":9711,"protocol":"TCP"},{"containerPort":9611,"protocol":"TCP"},{"containerPort":5672,"protocol":"TCP"}],"readinessProbe":{"failureThreshold":3,"httpGet":{"path":"/services/Version","port":9763},"initialDelaySeconds":60,"periodSeconds":10},"resources":{"limits":{"cpu":"3000m","memory":"5Gi"},"requests":{"cpu":"2000m","memory":"2Gi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["all"]},"runAsNonRoot":true,"runAsUser":10001},"startupProbe":{"exec":{"command":["/bin/sh","-c","timeout 1 bash -c \"\u003c/dev/tcp/localhost/9443\""]},"failureThreshold":3,"initialDelaySeconds":60,"periodSeconds":10},"volumeMounts":[{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml","name":"wso2am-control-plane-conf","subPath":"deployment.toml"},{"mountPath":"/home/wso2carbon/docker-entrypoint.sh","name":"wso2am-control-plane-entrypoint","subPath":"docker-entrypoint.sh"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties","name":"wso2am-control-plane-log4j2","subPath":"log4j2.properties"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json","name":"wso2am-conf-admin-settings","subPath":"settings.json"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json","name":"wso2am-conf-devportal-settings","subPath":"settings.json"},{"mountPath":"/home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json","name":"wso2am-conf-publisher-settings","subPath":"settings.json"}]}],"securityContext":{"seccompProfile":{"type":"RuntimeDefault"}},"volumes":[{"configMap":{"defaultMode":263,"name":"apptest-5mjr3ks3-acp-conf-1"},"name":"wso2am-control-plane-conf"},{"configMap":{"defaultMode":263,"name":"apptest-5mjr3ks3-acp-conf-entrypoint"},"name":"wso2am-control-plane-entrypoint"},{"configMap":{"defaultMode":263,"name":"apptest-5mjr3ks3-acp-conf-log4j2"},"name":"wso2am-control-plane-log4j2"},{"configMap":{"defaultMode":263,"name":"apptest-5mjr3ks3-acp-conf-admin-settings"},"name":"wso2am-conf-admin-settings"},{"configMap":{"defaultMode":263,"name":"apptest-5mjr3ks3-acp-conf-devportal-settings"},"name":"wso2am-conf-devportal-settings"},{"configMap":{"defaultMode":263,"name":"apptest-5mjr3ks3-acp-conf-publisher-settings"},"name":"wso2am-conf-publisher-settings"}]}}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-acp-deployment-1
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619876015008"
    uid: c43b1af2-d39a-4e30-a206-79b90946c860
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        deployment: apptest-5mjr3ks3-acp
        node: apptest-5mjr3ks3-acp-1
    strategy:
      type: Recreate
    template:
      metadata:
        annotations:
          checksum.am.cp.conf: 3c9fe9d247bdc96a200d01118ebc7771717a59c7b92804d7ca581c7ea3f1c0c9
          checksum.am.cp.conf.log4j2: b169d29942d91253307e36ddf7ff2beff66ef1a9dbff1093ed922a9cbe720867
          checksum.am.cp.conf.secret: 6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb
          cloudmarketplace.googleapis.com/product.metadata: v1:{"services":[{"service_name":"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog",
            "service_level":"default"}]}
        creationTimestamp: null
        labels:
          deployment: apptest-5mjr3ks3-acp
          node: apptest-5mjr3ks3-acp-1
          product: apim
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: deployment
                    operator: In
                    values:
                    - apptest-5mjr3ks3-acp
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: PROFILE_NAME
            value: default
          - name: NODE_IP
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: status.podIP
          - name: JVM_MEM_OPTS
            value: -Xms2048m -Xmx2048m
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
          imagePullPolicy: Always
          lifecycle:
            preStop:
              exec:
                command:
                - sh
                - -c
                - |
                  echo "Pre stop hook triggered"; sleep 10; echo "Shutdown APIM Server"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          name: wso2am-control-plane
          ports:
          - containerPort: 9763
            protocol: TCP
          - containerPort: 9443
            protocol: TCP
          - containerPort: 9711
            protocol: TCP
          - containerPort: 9611
            protocol: TCP
          - containerPort: 5672
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "3"
              memory: 5Gi
            requests:
              cpu: "2"
              memory: 2Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - all
            runAsNonRoot: true
            runAsUser: 10001
          startupProbe:
            exec:
              command:
              - /bin/sh
              - -c
              - timeout 1 bash -c "</dev/tcp/localhost/9443"
            failureThreshold: 3
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
            name: wso2am-control-plane-conf
            subPath: deployment.toml
          - mountPath: /home/wso2carbon/docker-entrypoint.sh
            name: wso2am-control-plane-entrypoint
            subPath: docker-entrypoint.sh
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
            name: wso2am-control-plane-log4j2
            subPath: log4j2.properties
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
            name: wso2am-conf-admin-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
            name: wso2am-conf-devportal-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
            name: wso2am-conf-publisher-settings
            subPath: settings.json
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-1
          name: wso2am-control-plane-conf
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-entrypoint
          name: wso2am-control-plane-entrypoint
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-log4j2
          name: wso2am-control-plane-log4j2
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-admin-settings
          name: wso2am-conf-admin-settings
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-devportal-settings
          name: wso2am-conf-devportal-settings
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-publisher-settings
          name: wso2am-conf-publisher-settings
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:00:19Z"
      lastUpdateTime: "2025-12-02T10:00:19Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:00:19Z"
      lastUpdateTime: "2025-12-02T10:00:19Z"
      message: ReplicaSet "apptest-5mjr3ks3-acp-deployment-1-6b454874d" is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-adapter-deployment","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"adapter","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071"},"labels":{"app.kubernetes.io/app":"adapter","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["adapter"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":[{"name":"OPERATOR_POD_NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"ADAPTER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/adapter.key"},{"name":"ADAPTER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/adapter.crt"},{"name":"ADAPTER_SERVER_NAME","value":"apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"adapter","ports":[{"containerPort":18000,"protocol":"TCP"},{"containerPort":8765,"protocol":"TCP"},{"containerPort":18005,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"200m","memory":"128Mi"},"requests":{"cpu":"50m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/adapter.key","name":"adapter-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/adapter.crt","name":"adapter-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter-ca.crt","name":"adapter-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/router.crt","name":"router-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/enforcer.crt","name":"enforcer-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/consul","name":"adapter-truststore-consul-secret-volume"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/security/truststore/wso2-apim-carbon.pem","name":"enforcer-apikey-cert","subPath":"wso2-apim-carbon.pem"}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"name":"adapter-keystore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-5mjr3ks3-wso2-apk-adapter-server-cert"}},{"name":"adapter-truststore-consul-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-adapter-truststore-consul-secret"}},{"configMap":{"name":"apptest-5mjr3ks3-wso2-apk-log-conf"},"name":"log-conf-volume"},{"name":"router-truststore-secret-volume","secret":null},{"name":"enforcer-truststore-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-server-cert"}},{"name":"enforcer-apikey-cert","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret"}}]}}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-adapter-deployment
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669620449327020"
    uid: e0330555-f70c-4978-91ff-5f92c39bdbf1
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: adapter
        app.kubernetes.io/release: apptest-5mjr3ks3
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: 2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: adapter
          app.kubernetes.io/release: apptest-5mjr3ks3
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - adapter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: ADAPTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/adapter.key
          - name: ADAPTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/adapter.crt
          - name: ADAPTER_SERVER_NAME
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: adapter
          ports:
          - containerPort: 18000
            protocol: TCP
          - containerPort: 8765
            protocol: TCP
          - containerPort: 18005
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/adapter.key
            name: adapter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/adapter.crt
            name: adapter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: adapter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/consul
            name: adapter-truststore-consul-secret-volume
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: adapter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-adapter-server-cert
        - name: adapter-truststore-consul-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-adapter-truststore-consul-secret
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-log-conf
          name: log-conf-volume
        - emptyDir: {}
          name: router-truststore-secret-volume
        - name: enforcer-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-server-cert
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:00:19Z"
      lastUpdateTime: "2025-12-02T10:00:19Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:00:19Z"
      lastUpdateTime: "2025-12-02T10:00:20Z"
      message: ReplicaSet "apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-common-controller-deployment","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"commoncontroller","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"d7d9729495b578eaf450051044ddec481fee416a5d3f02f513cba4114f89a214"},"labels":{"app.kubernetes.io/app":"commoncontroller","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["common-controller"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":[{"name":"OPERATOR_POD_NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"COMMON_CONTROLLER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/commoncontroller.key"},{"name":"COMMON_CONTROLLER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/commoncontroller.crt"},{"name":"COMMON_CONTROLLER_SERVER_NAME","value":"apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"commoncontroller","ports":[{"containerPort":18005,"protocol":"TCP"},{"containerPort":18002,"protocol":"TCP"},{"containerPort":9543,"protocol":"TCP"},{"containerPort":18003,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"200m","memory":"128Mi"},"requests":{"cpu":"50m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/commoncontroller.key","name":"common-controller-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/commoncontroller.crt","name":"common-controller-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter-ca.crt","name":"common-controller-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ca-ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/tmp/k8s-webhook-server/serving-certs","name":"adapter-webhook-server-cert","readOnly":true},{"mountPath":"/home/wso2/security/sts/","name":"sts-shared-auth-key","readOnly":true}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"name":"common-controller-keystore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-5mjr3ks3-wso2-apk-common-controller-server-cert"}},{"configMap":{"name":"apptest-5mjr3ks3-wso2-apk-common-log-conf"},"name":"log-conf-volume"},{"name":"adapter-webhook-server-cert","secret":{"defaultMode":420,"secretName":"apptest-5mjr3ks3-wso2-apk-webhook-server-cert"}},{"name":"sts-shared-auth-key","secret":{"defaultMode":420,"secretName":"apptest-5mjr3ks3-wso2-apk-sts-shared-auth-key"}},{"name":"ratelimiter-truststore-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert"}}]}}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-common-controller-deployment
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669620472543005"
    uid: a2683fd2-78b5-4ca9-9654-0823a27287c6
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: commoncontroller
        app.kubernetes.io/release: apptest-5mjr3ks3
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: d7d9729495b578eaf450051044ddec481fee416a5d3f02f513cba4114f89a214
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: commoncontroller
          app.kubernetes.io/release: apptest-5mjr3ks3
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - common-controller
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: COMMON_CONTROLLER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/commoncontroller.key
          - name: COMMON_CONTROLLER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/commoncontroller.crt
          - name: COMMON_CONTROLLER_SERVER_NAME
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: commoncontroller
          ports:
          - containerPort: 18005
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          - containerPort: 9543
            protocol: TCP
          - containerPort: 18003
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/commoncontroller.key
            name: common-controller-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/commoncontroller.crt
            name: common-controller-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: common-controller-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /tmp/k8s-webhook-server/serving-certs
            name: adapter-webhook-server-cert
            readOnly: true
          - mountPath: /home/wso2/security/sts/
            name: sts-shared-auth-key
            readOnly: true
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: common-controller-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-common-controller-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-common-log-conf
          name: log-conf-volume
        - name: adapter-webhook-server-cert
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-webhook-server-cert
        - name: sts-shared-auth-key
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-sts-shared-auth-key
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:00:20Z"
      lastUpdateTime: "2025-12-02T10:00:20Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:00:19Z"
      lastUpdateTime: "2025-12-02T10:00:20Z"
      message: ReplicaSet "apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-config-ds-deployment","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"configdeployer-ds","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"fa9ec7acc06aa71ba3625b1baaf7e57e76a4068ecd8afe614b7aa597e33e0985"},"labels":{"app.kubernetes.io/app":"configdeployer-ds","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["config-ds"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"containers":[{"env":null,"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5","imagePullPolicy":"Always","livenessProbe":{"httpGet":{"path":"/health","port":9443,"scheme":"HTTPS"},"initialDelaySeconds":20,"periodSeconds":20},"name":"config-ds","ports":[{"containerPort":9443,"protocol":"TCP"}],"readinessProbe":{"httpGet":{"path":"/health","port":9443,"scheme":"HTTPS"},"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"500m","memory":"1024Mi"},"requests":{"cpu":"200m","memory":"512Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2apk/config-deployer/conf/Config.toml","name":"config-toml-volume","subPath":"Config.toml"},{"mountPath":"/home/wso2apk/config-deployer/security/config.key","name":"config-ds-tls-volume","subPath":"tls.key"},{"mountPath":"/home/wso2apk/config-deployer/security/config.pem","name":"config-ds-tls-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2apk/config-deployer/security/mg.pem","name":"enforcer-jwt-secret-volume","subPath":"mg.pem"},{"mountPath":"/tmp","name":"tmp"},{"mountPath":"/home/wso2apk/config-deployer/tmp","name":"config-deployer-temp"}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"configMap":{"name":"apptest-5mjr3ks3-wso2-apk-config-ds-configmap"},"name":"config-toml-volume"},{"name":"config-ds-tls-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-config-ds-server-cert"}},{"name":"enforcer-jwt-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret"}},{"emptyDir":{},"name":"tmp"},{"emptyDir":{},"name":"config-deployer-temp"}]}}}}
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-config-ds-deployment
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669619891263009"
    uid: 75edc513-4f9a-4e5a-86a4-2a0ffdcc4ef5
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: configdeployer-ds
        app.kubernetes.io/release: apptest-5mjr3ks3
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: fa9ec7acc06aa71ba3625b1baaf7e57e76a4068ecd8afe614b7aa597e33e0985
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: configdeployer-ds
          app.kubernetes.io/release: apptest-5mjr3ks3
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - config-ds
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: config-ds
          ports:
          - containerPort: 9443
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 1Gi
            requests:
              cpu: 200m
              memory: 512Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
            name: config-toml-volume
            subPath: Config.toml
          - mountPath: /home/wso2apk/config-deployer/security/config.key
            name: config-ds-tls-volume
            subPath: tls.key
          - mountPath: /home/wso2apk/config-deployer/security/config.pem
            name: config-ds-tls-volume
            subPath: tls.crt
          - mountPath: /home/wso2apk/config-deployer/security/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2apk/config-deployer/tmp
            name: config-deployer-temp
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-config-ds-configmap
          name: config-toml-volume
        - name: config-ds-tls-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-config-ds-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret
        - emptyDir: {}
          name: tmp
        - emptyDir: {}
          name: config-deployer-temp
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:00:19Z"
      lastUpdateTime: "2025-12-02T10:00:19Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:00:19Z"
      lastUpdateTime: "2025-12-02T10:00:19Z"
      message: ReplicaSet "apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"strategy":{"type":null},"template":{"metadata":{"annotations":{"checksum/config":"2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071"},"labels":{"app.kubernetes.io/app":"gateway","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["gateway-runtime"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"automountServiceAccountToken":false,"containers":[{"env":[{"name":"TOKEN_REVOCATION_ENABLED","value":"true"},{"name":"ADAPTER_HOST_NAME","value":"apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc"},{"name":"ADAPTER_HOST","value":"apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc"},{"name":"COMMON_CONTROLLER_HOST_NAME","value":"apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc"},{"name":"COMMON_CONTROLLER_HOST","value":"apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc"},{"name":"RATELIMITER_HOST","value":"apptest-5mjr3ks3-wso2-apk-ratelimiter-service.apptest-5mjr3ks3.svc"},{"name":"ENFORCER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/enforcer.key"},{"name":"ENFORCER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/enforcer.crt"},{"name":"ENFORCER_SERVER_NAME","value":"apptest-5mjr3ks3-wso2-apk-enforcer-service.apptest-5mjr3ks3.svc"},{"name":"TRUSTED_CA_CERTS_PATH","value":"/home/wso2/security/truststore"},{"name":"ADAPTER_XDS_PORT","value":"18000"},{"name":"RATELIMITER_PORT","value":"8091"},{"name":"COMMON_CONTROLLER_XDS_PORT","value":"18002"},{"name":"COMMON_CONTROLLER_REST_PORT","value":"18003"},{"name":"ENFORCER_LABEL","value":"wso2-apk-default"},{"name":"ENFORCER_REGION","value":"UNKNOWN"},{"name":"XDS_MAX_MSG_SIZE","value":"4194304"},{"name":"XDS_MAX_RETRIES","value":"3"},{"name":"enforcer_admin_pwd","value":"admin"},{"name":"REDIS_USERNAME","value":"default"},{"name":"REDIS_PASSWORD","value":""},{"name":"REDIS_HOST","value":"redis-master"},{"name":"REDIS_PORT","value":"6379"},{"name":"IS_REDIS_TLS_ENABLED","value":"false"},{"name":"REDIS_REVOKED_TOKENS_CHANNEL","value":"wso2-apk-revoked-tokens-channel"},{"name":"REDIS_KEY_FILE","value":"/home/wso2/security/truststore/enforcer.key"},{"name":"REDIS_CERT_FILE","value":"/home/wso2/security/truststore/enforcer.crt"},{"name":"REDIS_CA_CERT_FILE","value":"/home/wso2/security/truststore/enforcer.crt"},{"name":"REVOKED_TOKEN_CLEANUP_INTERVAL","value":"3600"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"enforcer","ports":[{"containerPort":8081,"protocol":"TCP"},{"containerPort":9001,"protocol":"TCP"},{"containerPort":5006,"protocol":"TCP"},{"containerPort":8084,"protocol":"TCP"},{"containerPort":9092,"protocol":"TCP"},{"containerPort":18002,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","check_health.sh"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"200m","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true,"runAsNonRoot":true},"volumeMounts":[{"mountPath":"/tmp","name":"tmp"},{"mountPath":"/home/wso2/security/keystore/enforcer.key","name":"enforcer-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/enforcer.crt","name":"enforcer-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/apk.crt","name":"enforcer-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/enforcer.crt","name":"enforcer-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter.crt","name":"adapter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/router.crt","name":"router-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/check_health.sh","name":"enforcer-health-check-volume","subPath":"check_health.sh"},{"mountPath":"/home/wso2/security/keystore/mg.pem","name":"enforcer-jwt-secret-volume","subPath":"mg.pem"},{"mountPath":"/home/wso2/security/truststore/mg.pem","name":"enforcer-jwt-secret-volume","subPath":"mg.pem"},{"mountPath":"/home/wso2/security/keystore/mg.key","name":"enforcer-jwt-secret-volume","subPath":"mg.key"},{"mountPath":"/home/wso2/security/truststore/wso2carbon.pem","name":"enforcer-trusted-certs","subPath":"wso2carbon.pem"},{"mountPath":"/home/wso2/security/truststore/wso2-apim-carbon.pem","name":"enforcer-apikey-cert","subPath":"wso2-apim-carbon.pem"},{"mountPath":"/home/wso2/security/truststore/idp.pem","name":"idp-certificate-secret-volume","subPath":"wso2carbon.pem"},{"mountPath":"/home/wso2/security/truststore/ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter-ca.crt","name":"ratelimiter-truststore-secret-volume","subPath":"ca.crt"}]},{"env":[{"name":"ADAPTER_HOST_NAME","value":"apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc"},{"name":"ADAPTER_HOST","value":"apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc"},{"name":"ENFORCER_HOST","value":"127.0.0.1"},{"name":"ENFORCER_ANALYTICS_HOST","value":"127.0.0.1"},{"name":"ROUTER_ADMIN_HOST","value":"0.0.0.0"},{"name":"ROUTER_ADMIN_PORT","value":"9000"},{"name":"ROUTER_PORT","value":"9095"},{"name":"ROUTER_CLUSTER","value":"apk_router_cluster"},{"name":"ROUTER_LABEL","value":"wso2-apk-default"},{"name":"ROUTER_PRIVATE_KEY_PATH","value":"/home/wso2/security/keystore/router.key"},{"name":"ROUTER_PUBLIC_CERT_PATH","value":"/home/wso2/security/keystore/router.crt"},{"name":"ADAPTER_PORT","value":"18000"},{"name":"ADAPTER_CA_CERT_PATH","value":"/home/wso2/security/truststore/adapter.crt"},{"name":"ENFORCER_PORT","value":"8081"},{"name":"ENFORCER_ANALYTICS_RECEIVER_PORT","value":"18090"},{"name":"ENFORCER_CA_CERT_PATH","value":"/home/wso2/security/truststore/enforcer.crt"},{"name":"CONCURRENCY","value":"2"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5","imagePullPolicy":"Always","livenessProbe":{"exec":{"command":["sh","router_check_health.sh","health"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"name":"router","ports":[{"containerPort":9095,"protocol":"TCP"},{"containerPort":9090,"protocol":"TCP"},{"containerPort":9091,"protocol":"TCP"},{"containerPort":9000,"protocol":"TCP"}],"readinessProbe":{"exec":{"command":["sh","router_check_health.sh","health"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"1000m","memory":"1028Mi"},"requests":{"cpu":"200m","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true,"runAsNonRoot":true},"startupProbe":{"exec":{"command":["sh","router_check_health.sh","health"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":20},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/router.key","name":"router-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/router.crt","name":"router-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/adapter.crt","name":"adapter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/enforcer.crt","name":"enforcer-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/conf/","name":"log-conf-volume"},{"mountPath":"/home/wso2/security/truststore/ratelimiter.crt","name":"ratelimiter-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter-ca.crt","name":"ratelimiter-truststore-secret-volume","subPath":"ca.crt"}]}],"securityContext":{"seccompProfile":{"type":"RuntimeDefault"}},"volumes":[{"name":"ratelimiter-truststore-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert"}},{"name":"enforcer-keystore-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-server-cert"}},{"configMap":{"name":"apptest-5mjr3ks3-wso2-apk-log-conf"},"name":"log-conf-volume"},{"configMap":{"name":"apptest-5mjr3ks3-wso2-apk-enforcer-grpc-probe-script-conf"},"name":"enforcer-health-check-volume"},{"name":"router-keystore-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-gateway-server-cert"}},{"name":"adapter-truststore-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-adapter-server-cert"}},{"name":"enforcer-jwt-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret"}},{"name":"enforcer-trusted-certs","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret"}},{"name":"enforcer-apikey-cert","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret"}},{"name":"idp-certificate-secret-volume","secret":{"secretName":"apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret"}},{"emptyDir":{},"name":"tmp"}]}}}}
    creationTimestamp: "2025-12-02T10:00:20Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669621243871003"
    uid: edd4ce7e-f65a-4dee-895b-e8ad481ffff1
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: gateway
        app.kubernetes.io/release: apptest-5mjr3ks3
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: 2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: gateway
          app.kubernetes.io/release: apptest-5mjr3ks3
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - gateway-runtime
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: TOKEN_REVOCATION_ENABLED
            value: "true"
          - name: ADAPTER_HOST_NAME
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: ADAPTER_HOST
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: COMMON_CONTROLLER_HOST_NAME
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          - name: COMMON_CONTROLLER_HOST
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          - name: RATELIMITER_HOST
            value: apptest-5mjr3ks3-wso2-apk-ratelimiter-service.apptest-5mjr3ks3.svc
          - name: ENFORCER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/enforcer.key
          - name: ENFORCER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/enforcer.crt
          - name: ENFORCER_SERVER_NAME
            value: apptest-5mjr3ks3-wso2-apk-enforcer-service.apptest-5mjr3ks3.svc
          - name: TRUSTED_CA_CERTS_PATH
            value: /home/wso2/security/truststore
          - name: ADAPTER_XDS_PORT
            value: "18000"
          - name: RATELIMITER_PORT
            value: "8091"
          - name: COMMON_CONTROLLER_XDS_PORT
            value: "18002"
          - name: COMMON_CONTROLLER_REST_PORT
            value: "18003"
          - name: ENFORCER_LABEL
            value: wso2-apk-default
          - name: ENFORCER_REGION
            value: UNKNOWN
          - name: XDS_MAX_MSG_SIZE
            value: "4194304"
          - name: XDS_MAX_RETRIES
            value: "3"
          - name: enforcer_admin_pwd
            value: admin
          - name: REDIS_USERNAME
            value: default
          - name: REDIS_PASSWORD
          - name: REDIS_HOST
            value: redis-master
          - name: REDIS_PORT
            value: "6379"
          - name: IS_REDIS_TLS_ENABLED
            value: "false"
          - name: REDIS_REVOKED_TOKENS_CHANNEL
            value: wso2-apk-revoked-tokens-channel
          - name: REDIS_KEY_FILE
            value: /home/wso2/security/truststore/enforcer.key
          - name: REDIS_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REDIS_CA_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REVOKED_TOKEN_CLEANUP_INTERVAL
            value: "3600"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: enforcer
          ports:
          - containerPort: 8081
            protocol: TCP
          - containerPort: 9001
            protocol: TCP
          - containerPort: 5006
            protocol: TCP
          - containerPort: 8084
            protocol: TCP
          - containerPort: 9092
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 512Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2/security/keystore/enforcer.key
            name: enforcer-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk.crt
            name: enforcer-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/check_health.sh
            name: enforcer-health-check-volume
            subPath: check_health.sh
          - mountPath: /home/wso2/security/keystore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/truststore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/keystore/mg.key
            name: enforcer-jwt-secret-volume
            subPath: mg.key
          - mountPath: /home/wso2/security/truststore/wso2carbon.pem
            name: enforcer-trusted-certs
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
          - mountPath: /home/wso2/security/truststore/idp.pem
            name: idp-certificate-secret-volume
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        - env:
          - name: ADAPTER_HOST_NAME
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: ADAPTER_HOST
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: ENFORCER_HOST
            value: 127.0.0.1
          - name: ENFORCER_ANALYTICS_HOST
            value: 127.0.0.1
          - name: ROUTER_ADMIN_HOST
            value: 0.0.0.0
          - name: ROUTER_ADMIN_PORT
            value: "9000"
          - name: ROUTER_PORT
            value: "9095"
          - name: ROUTER_CLUSTER
            value: apk_router_cluster
          - name: ROUTER_LABEL
            value: wso2-apk-default
          - name: ROUTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/router.key
          - name: ROUTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/router.crt
          - name: ADAPTER_PORT
            value: "18000"
          - name: ADAPTER_CA_CERT_PATH
            value: /home/wso2/security/truststore/adapter.crt
          - name: ENFORCER_PORT
            value: "8081"
          - name: ENFORCER_ANALYTICS_RECEIVER_PORT
            value: "18090"
          - name: ENFORCER_CA_CERT_PATH
            value: /home/wso2/security/truststore/enforcer.crt
          - name: CONCURRENCY
            value: "2"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: router
          ports:
          - containerPort: 9095
            protocol: TCP
          - containerPort: 9090
            protocol: TCP
          - containerPort: 9091
            protocol: TCP
          - containerPort: 9000
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "1"
              memory: 1028Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          startupProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/router.key
            name: router-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
        - name: enforcer-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-log-conf
          name: log-conf-volume
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-enforcer-grpc-probe-script-conf
          name: enforcer-health-check-volume
        - name: router-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-gateway-server-cert
        - name: adapter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-adapter-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret
        - name: enforcer-trusted-certs
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
        - name: idp-certificate-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
        - emptyDir: {}
          name: tmp
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:00:20Z"
      lastUpdateTime: "2025-12-02T10:00:20Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:00:20Z"
      lastUpdateTime: "2025-12-02T10:00:21Z"
      message: ReplicaSet "apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "1"
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/app":"ratelimiter","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"strategy":{"type":"RollingUpdate"},"template":{"metadata":{"labels":{"app.kubernetes.io/app":"ratelimiter","app.kubernetes.io/release":"apptest-5mjr3ks3"}},"spec":{"affinity":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app.kubernetes.io/app","operator":"In","values":["rate-limiter"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"automountServiceAccountToken":false,"containers":[{"env":[{"name":"HOST","value":"0.0.0.0"},{"name":"PORT","value":"8090"},{"name":"USE_STATSD","value":"false"},{"name":"LOG_LEVEL","value":"DEBUG"},{"name":"LIMIT_RESPONSE_HEADERS_ENABLED","value":"false"},{"name":"REDIS_TYPE","value":"single"},{"name":"REDIS_SOCKET_TYPE","value":"tcp"},{"name":"REDIS_URL","value":"redis-master:6379"},{"name":"REDIS_PIPELINE_WINDOW","value":"0.2ms"},{"name":"REDIS_PIPELINE_LIMIT","value":"0"},{"name":"GRPC_HOST","value":"0.0.0.0"},{"name":"GRPC_PORT","value":"8091"},{"name":"GRPC_SERVER_USE_TLS","value":"true"},{"name":"GRPC_SERVER_TLS_KEY","value":"/home/wso2/security/keystore/ratelimiter.key"},{"name":"GRPC_SERVER_TLS_CERT","value":"/home/wso2/security/keystore/ratelimiter.crt"},{"name":"GRPC_CLIENT_TLS_CACERT","value":"/home/wso2/security/truststore/ratelimiter-ca.crt"},{"name":"RATELIMITER_LABEL","value":"ratelimiter"},{"name":"CONFIG_GRPC_XDS_SERVER_URL","value":"apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc:18005"},{"name":"CONFIG_GRPC_XDS_SERVER_USE_TLS","value":"true"},{"name":"CONFIG_GRPC_XDS_CLIENT_TLS_KEY","value":"/home/wso2/security/keystore/ratelimiter.key"},{"name":"CONFIG_GRPC_XDS_CLIENT_TLS_CERT","value":"/home/wso2/security/keystore/ratelimiter.crt"},{"name":"CONFIG_GRPC_XDS_SERVER_TLS_CACERT","value":"/home/wso2/security/truststore/ratelimiter-ca.crt"},{"name":"CONFIG_GRPC_XDS_SERVER_TLS_SAN","value":"apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc"}],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5","imagePullPolicy":"Always","livenessProbe":{"failureThreshold":5,"httpGet":{"path":"/healthcheck","port":8090,"scheme":"HTTP"},"initialDelaySeconds":20,"periodSeconds":20},"name":"ratelimiter","ports":[{"containerPort":8090,"protocol":"TCP"},{"containerPort":8091,"protocol":"TCP"},{"containerPort":6070,"protocol":"TCP"}],"readinessProbe":{"failureThreshold":5,"httpGet":{"path":"/healthcheck","port":8090,"scheme":"HTTP"},"initialDelaySeconds":20,"periodSeconds":20},"resources":{"limits":{"cpu":"100m","memory":"128Mi"},"requests":{"cpu":"50m","memory":"64Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true},"volumeMounts":[{"mountPath":"/home/wso2/security/keystore/ratelimiter.key","name":"ratelimiter-keystore-secret-volume","subPath":"tls.key"},{"mountPath":"/home/wso2/security/keystore/ratelimiter.crt","name":"ratelimiter-keystore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/ratelimiter-ca.crt","name":"ratelimiter-keystore-secret-volume","subPath":"ca.crt"},{"mountPath":"/home/wso2/security/truststore/adapter.pem","name":"common-controller-truststore-secret-volume","subPath":"tls.crt"},{"mountPath":"/home/wso2/security/truststore/router.pem","name":"router-truststore-secret-volume","subPath":"tls.crt"}]}],"securityContext":{"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"wso2apk-platform","volumes":[{"name":"ratelimiter-keystore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert"}},{"name":"common-controller-truststore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-5mjr3ks3-wso2-apk-common-controller-server-cert"}},{"name":"router-truststore-secret-volume","secret":{"defaultMode":420,"secretName":"apptest-5mjr3ks3-wso2-apk-gateway-server-cert"}}]}}}}
    creationTimestamp: "2025-12-02T10:00:20Z"
    generation: 1
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669621305423024"
    uid: fac209c7-596b-4467-8e99-5a7006c41521
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/app: ratelimiter
        app.kubernetes.io/release: apptest-5mjr3ks3
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: ratelimiter
          app.kubernetes.io/release: apptest-5mjr3ks3
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - rate-limiter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: HOST
            value: 0.0.0.0
          - name: PORT
            value: "8090"
          - name: USE_STATSD
            value: "false"
          - name: LOG_LEVEL
            value: DEBUG
          - name: LIMIT_RESPONSE_HEADERS_ENABLED
            value: "false"
          - name: REDIS_TYPE
            value: single
          - name: REDIS_SOCKET_TYPE
            value: tcp
          - name: REDIS_URL
            value: redis-master:6379
          - name: REDIS_PIPELINE_WINDOW
            value: 0.2ms
          - name: REDIS_PIPELINE_LIMIT
            value: "0"
          - name: GRPC_HOST
            value: 0.0.0.0
          - name: GRPC_PORT
            value: "8091"
          - name: GRPC_SERVER_USE_TLS
            value: "true"
          - name: GRPC_SERVER_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: GRPC_SERVER_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: GRPC_CLIENT_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: RATELIMITER_LABEL
            value: ratelimiter
          - name: CONFIG_GRPC_XDS_SERVER_URL
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc:18005
          - name: CONFIG_GRPC_XDS_SERVER_USE_TLS
            value: "true"
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_SAN
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: ratelimiter
          ports:
          - containerPort: 8090
            protocol: TCP
          - containerPort: 8091
            protocol: TCP
          - containerPort: 6070
            protocol: TCP
          readinessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 100m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/ratelimiter.key
            name: ratelimiter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/ratelimiter.crt
            name: ratelimiter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/adapter.pem
            name: common-controller-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.pem
            name: router-truststore-secret-volume
            subPath: tls.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
        - name: common-controller-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-common-controller-server-cert
        - name: router-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-gateway-server-cert
  status:
    conditions:
    - lastTransitionTime: "2025-12-02T10:00:20Z"
      lastUpdateTime: "2025-12-02T10:00:20Z"
      message: Deployment does not have minimum availability.
      reason: MinimumReplicasUnavailable
      status: "False"
      type: Available
    - lastTransitionTime: "2025-12-02T10:00:20Z"
      lastUpdateTime: "2025-12-02T10:00:21Z"
      message: ReplicaSet "apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc"
        is progressing.
      reason: ReplicaSetUpdated
      status: "True"
      type: Progressing
    observedGeneration: 1
    replicas: 1
    unavailableReplicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:00:20Z"
    generation: 1
    labels:
      app.kubernetes.io/app: apim-apk-agent
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/name: apkagent
      pod-template-hash: d87b99c4b
    name: apkagent-d87b99c4b
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apkagent
      uid: e573d158-8e95-4cb4-827e-a79fa656d5e1
    resourceVersion: "1764669621330639005"
    uid: 437c958c-7f4e-4ffe-b7b9-73d8231b82ee
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: apim-apk-agent
        app.kubernetes.io/instance: apptest-5mjr3ks3
        app.kubernetes.io/name: apkagent
        pod-template-hash: d87b99c4b
    template:
      metadata:
        annotations:
          checksum/config: 2ba2373d663e022dd6b9f785c468c2338f5268d014367d07c7dd51b56b292c56
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: apim-apk-agent
          app.kubernetes.io/instance: apptest-5mjr3ks3
          app.kubernetes.io/name: apkagent
          pod-template-hash: d87b99c4b
      spec:
        containers:
        - env:
          - name: APIM_APK_AGENT_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/apk-agent.key
          - name: APIM_APK_AGENT_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/apk-agent.crt
          - name: APIM_APK_AGENT_SERVER_NAME
            value: apim-apk-agent-service.apptest-5mjr3ks3.svc
          - name: APIM_APK_AGENT_GRPC_PORT
            value: "18000"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apim-apk-agent:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: apkagent
          ports:
          - containerPort: 18000
            name: grpc-port
            protocol: TCP
          - containerPort: 18001
            name: rest-port
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 256Mi
            requests:
              cpu: 100m
              memory: 128Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/keystore/apk-agent.key
            name: apk-agent-certificates
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/apk-agent.crt
            name: apk-agent-certificates
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk-agent-ca.crt
            name: apk-agent-certificates
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: wso2agent-platform
        serviceAccountName: wso2agent-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-log-conf
          name: log-conf-volume
        - name: apk-agent-certificates
          secret:
            defaultMode: 420
            secretName: apk-agent-server-cert
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "1"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      deployment: apptest-5mjr3ks3-acp
      node: apptest-5mjr3ks3-acp-1
      pod-template-hash: 6b454874d
      product: apim
    name: apptest-5mjr3ks3-acp-deployment-1-6b454874d
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-5mjr3ks3-acp-deployment-1
      uid: c43b1af2-d39a-4e30-a206-79b90946c860
    resourceVersion: "1764669619799343010"
    uid: b55dd6b5-d713-4823-93ae-6a1133a25804
  spec:
    replicas: 1
    selector:
      matchLabels:
        deployment: apptest-5mjr3ks3-acp
        node: apptest-5mjr3ks3-acp-1
        pod-template-hash: 6b454874d
    template:
      metadata:
        annotations:
          checksum.am.cp.conf: 3c9fe9d247bdc96a200d01118ebc7771717a59c7b92804d7ca581c7ea3f1c0c9
          checksum.am.cp.conf.log4j2: b169d29942d91253307e36ddf7ff2beff66ef1a9dbff1093ed922a9cbe720867
          checksum.am.cp.conf.secret: 6931efed2d9b235c16cb2483d011065a68d48e84e9adb262621f41a66645fbfb
          cloudmarketplace.googleapis.com/product.metadata: v1:{"services":[{"service_name":"wso2-apimanager.endpoints.wso2-marketplace-public.cloud.goog",
            "service_level":"default"}]}
        creationTimestamp: null
        labels:
          deployment: apptest-5mjr3ks3-acp
          node: apptest-5mjr3ks3-acp-1
          pod-template-hash: 6b454874d
          product: apim
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: deployment
                    operator: In
                    values:
                    - apptest-5mjr3ks3-acp
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: PROFILE_NAME
            value: default
          - name: NODE_IP
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: status.podIP
          - name: JVM_MEM_OPTS
            value: -Xms2048m -Xmx2048m
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/wso2am-acp:4.5
          imagePullPolicy: Always
          lifecycle:
            preStop:
              exec:
                command:
                - sh
                - -c
                - |
                  echo "Pre stop hook triggered"; sleep 10; echo "Shutdown APIM Server"; ${WSO2_SERVER_HOME}/bin/api-cp.sh stop
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          name: wso2am-control-plane
          ports:
          - containerPort: 9763
            protocol: TCP
          - containerPort: 9443
            protocol: TCP
          - containerPort: 9711
            protocol: TCP
          - containerPort: 9611
            protocol: TCP
          - containerPort: 5672
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /services/Version
              port: 9763
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "3"
              memory: 5Gi
            requests:
              cpu: "2"
              memory: 2Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - all
            runAsNonRoot: true
            runAsUser: 10001
          startupProbe:
            exec:
              command:
              - /bin/sh
              - -c
              - timeout 1 bash -c "</dev/tcp/localhost/9443"
            failureThreshold: 3
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/deployment.toml
            name: wso2am-control-plane-conf
            subPath: deployment.toml
          - mountPath: /home/wso2carbon/docker-entrypoint.sh
            name: wso2am-control-plane-entrypoint
            subPath: docker-entrypoint.sh
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/conf/log4j2.properties
            name: wso2am-control-plane-log4j2
            subPath: log4j2.properties
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/admin/site/public/conf/settings.json
            name: wso2am-conf-admin-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/devportal/site/public/theme/settings.json
            name: wso2am-conf-devportal-settings
            subPath: settings.json
          - mountPath: /home/wso2carbon/wso2-config-volume/repository/deployment/server/webapps/publisher/site/public/conf/settings.json
            name: wso2am-conf-publisher-settings
            subPath: settings.json
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-1
          name: wso2am-control-plane-conf
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-entrypoint
          name: wso2am-control-plane-entrypoint
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-log4j2
          name: wso2am-control-plane-log4j2
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-admin-settings
          name: wso2am-conf-admin-settings
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-devportal-settings
          name: wso2am-conf-devportal-settings
        - configMap:
            defaultMode: 263
            name: apptest-5mjr3ks3-acp-conf-publisher-settings
          name: wso2am-conf-publisher-settings
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      app.kubernetes.io/app: adapter
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 6fd65c85bf
    name: apptest-5mjr3ks3-wso2-apk-adapter-deployment-6fd65c85bf
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-5mjr3ks3-wso2-apk-adapter-deployment
      uid: e0330555-f70c-4978-91ff-5f92c39bdbf1
    resourceVersion: "1764669620336015021"
    uid: 7df12cb0-2363-4fb7-aa3c-1a15cc848206
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: adapter
        app.kubernetes.io/release: apptest-5mjr3ks3
        pod-template-hash: 6fd65c85bf
    template:
      metadata:
        annotations:
          checksum/config: 2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: adapter
          app.kubernetes.io/release: apptest-5mjr3ks3
          pod-template-hash: 6fd65c85bf
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - adapter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: ADAPTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/adapter.key
          - name: ADAPTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/adapter.crt
          - name: ADAPTER_SERVER_NAME
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-adapter:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: adapter
          ports:
          - containerPort: 18000
            protocol: TCP
          - containerPort: 8765
            protocol: TCP
          - containerPort: 18005
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/adapter.key
            name: adapter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/adapter.crt
            name: adapter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: adapter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/consul
            name: adapter-truststore-consul-secret-volume
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: adapter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-adapter-server-cert
        - name: adapter-truststore-consul-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-adapter-truststore-consul-secret
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-log-conf
          name: log-conf-volume
        - emptyDir: {}
          name: router-truststore-secret-volume
        - name: enforcer-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-server-cert
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      app.kubernetes.io/app: commoncontroller
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 745d86d97f
    name: apptest-5mjr3ks3-wso2-apk-common-controller-deployment-745d86d97f
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-5mjr3ks3-wso2-apk-common-controller-deployment
      uid: a2683fd2-78b5-4ca9-9654-0823a27287c6
    resourceVersion: "1764669620388927013"
    uid: 3924638e-e6f8-48db-99c2-eab337b3643d
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: commoncontroller
        app.kubernetes.io/release: apptest-5mjr3ks3
        pod-template-hash: 745d86d97f
    template:
      metadata:
        annotations:
          checksum/config: d7d9729495b578eaf450051044ddec481fee416a5d3f02f513cba4114f89a214
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: commoncontroller
          app.kubernetes.io/release: apptest-5mjr3ks3
          pod-template-hash: 745d86d97f
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - common-controller
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - env:
          - name: OPERATOR_POD_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: COMMON_CONTROLLER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/commoncontroller.key
          - name: COMMON_CONTROLLER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/commoncontroller.crt
          - name: COMMON_CONTROLLER_SERVER_NAME
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-common-controller:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: commoncontroller
          ports:
          - containerPort: 18005
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          - containerPort: 9543
            protocol: TCP
          - containerPort: 18003
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 200m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/commoncontroller.key
            name: common-controller-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/commoncontroller.crt
            name: common-controller-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter-ca.crt
            name: common-controller-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ca-ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /tmp/k8s-webhook-server/serving-certs
            name: adapter-webhook-server-cert
            readOnly: true
          - mountPath: /home/wso2/security/sts/
            name: sts-shared-auth-key
            readOnly: true
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: common-controller-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-common-controller-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-common-log-conf
          name: log-conf-volume
        - name: adapter-webhook-server-cert
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-webhook-server-cert
        - name: sts-shared-auth-key
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-sts-shared-auth-key
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:00:19Z"
    generation: 1
    labels:
      app.kubernetes.io/app: configdeployer-ds
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 5777f5cb88
    name: apptest-5mjr3ks3-wso2-apk-config-ds-deployment-5777f5cb88
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-5mjr3ks3-wso2-apk-config-ds-deployment
      uid: 75edc513-4f9a-4e5a-86a4-2a0ffdcc4ef5
    resourceVersion: "1764669619829407000"
    uid: 496e3435-eae3-42ef-9286-a7b808d350db
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: configdeployer-ds
        app.kubernetes.io/release: apptest-5mjr3ks3
        pod-template-hash: 5777f5cb88
    template:
      metadata:
        annotations:
          checksum/config: fa9ec7acc06aa71ba3625b1baaf7e57e76a4068ecd8afe614b7aa597e33e0985
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: configdeployer-ds
          app.kubernetes.io/release: apptest-5mjr3ks3
          pod-template-hash: 5777f5cb88
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - config-ds
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        containers:
        - image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-config-deployer-service:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: config-ds
          ports:
          - containerPort: 9443
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 9443
              scheme: HTTPS
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 1Gi
            requests:
              cpu: 200m
              memory: 512Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2apk/config-deployer/conf/Config.toml
            name: config-toml-volume
            subPath: Config.toml
          - mountPath: /home/wso2apk/config-deployer/security/config.key
            name: config-ds-tls-volume
            subPath: tls.key
          - mountPath: /home/wso2apk/config-deployer/security/config.pem
            name: config-ds-tls-volume
            subPath: tls.crt
          - mountPath: /home/wso2apk/config-deployer/security/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2apk/config-deployer/tmp
            name: config-deployer-temp
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-config-ds-configmap
          name: config-toml-volume
        - name: config-ds-tls-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-config-ds-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret
        - emptyDir: {}
          name: tmp
        - emptyDir: {}
          name: config-deployer-temp
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:00:20Z"
    generation: 1
    labels:
      app.kubernetes.io/app: gateway
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 6f78cc4ccf
    name: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment-6f78cc4ccf
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-5mjr3ks3-wso2-apk-gateway-runtime-deployment
      uid: edd4ce7e-f65a-4dee-895b-e8ad481ffff1
    resourceVersion: "1764669621101087024"
    uid: 28f11ca0-3ddc-4ce3-8bac-61489fe88aaf
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: gateway
        app.kubernetes.io/release: apptest-5mjr3ks3
        pod-template-hash: 6f78cc4ccf
    template:
      metadata:
        annotations:
          checksum/config: 2b5963e5734a48ac8cf3d16f02639f60e9bb5cd5ad7897c7d07247f56b3ad071
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: gateway
          app.kubernetes.io/release: apptest-5mjr3ks3
          pod-template-hash: 6f78cc4ccf
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - gateway-runtime
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: TOKEN_REVOCATION_ENABLED
            value: "true"
          - name: ADAPTER_HOST_NAME
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: ADAPTER_HOST
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: COMMON_CONTROLLER_HOST_NAME
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          - name: COMMON_CONTROLLER_HOST
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          - name: RATELIMITER_HOST
            value: apptest-5mjr3ks3-wso2-apk-ratelimiter-service.apptest-5mjr3ks3.svc
          - name: ENFORCER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/enforcer.key
          - name: ENFORCER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/enforcer.crt
          - name: ENFORCER_SERVER_NAME
            value: apptest-5mjr3ks3-wso2-apk-enforcer-service.apptest-5mjr3ks3.svc
          - name: TRUSTED_CA_CERTS_PATH
            value: /home/wso2/security/truststore
          - name: ADAPTER_XDS_PORT
            value: "18000"
          - name: RATELIMITER_PORT
            value: "8091"
          - name: COMMON_CONTROLLER_XDS_PORT
            value: "18002"
          - name: COMMON_CONTROLLER_REST_PORT
            value: "18003"
          - name: ENFORCER_LABEL
            value: wso2-apk-default
          - name: ENFORCER_REGION
            value: UNKNOWN
          - name: XDS_MAX_MSG_SIZE
            value: "4194304"
          - name: XDS_MAX_RETRIES
            value: "3"
          - name: enforcer_admin_pwd
            value: admin
          - name: REDIS_USERNAME
            value: default
          - name: REDIS_PASSWORD
          - name: REDIS_HOST
            value: redis-master
          - name: REDIS_PORT
            value: "6379"
          - name: IS_REDIS_TLS_ENABLED
            value: "false"
          - name: REDIS_REVOKED_TOKENS_CHANNEL
            value: wso2-apk-revoked-tokens-channel
          - name: REDIS_KEY_FILE
            value: /home/wso2/security/truststore/enforcer.key
          - name: REDIS_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REDIS_CA_CERT_FILE
            value: /home/wso2/security/truststore/enforcer.crt
          - name: REVOKED_TOKEN_CLEANUP_INTERVAL
            value: "3600"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-enforcer:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: enforcer
          ports:
          - containerPort: 8081
            protocol: TCP
          - containerPort: 9001
            protocol: TCP
          - containerPort: 5006
            protocol: TCP
          - containerPort: 8084
            protocol: TCP
          - containerPort: 9092
            protocol: TCP
          - containerPort: 18002
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - check_health.sh
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 500m
              memory: 512Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/wso2/security/keystore/enforcer.key
            name: enforcer-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/apk.crt
            name: enforcer-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/check_health.sh
            name: enforcer-health-check-volume
            subPath: check_health.sh
          - mountPath: /home/wso2/security/keystore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/truststore/mg.pem
            name: enforcer-jwt-secret-volume
            subPath: mg.pem
          - mountPath: /home/wso2/security/keystore/mg.key
            name: enforcer-jwt-secret-volume
            subPath: mg.key
          - mountPath: /home/wso2/security/truststore/wso2carbon.pem
            name: enforcer-trusted-certs
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/wso2-apim-carbon.pem
            name: enforcer-apikey-cert
            subPath: wso2-apim-carbon.pem
          - mountPath: /home/wso2/security/truststore/idp.pem
            name: idp-certificate-secret-volume
            subPath: wso2carbon.pem
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        - env:
          - name: ADAPTER_HOST_NAME
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: ADAPTER_HOST
            value: apptest-5mjr3ks3-wso2-apk-adapter-service.apptest-5mjr3ks3.svc
          - name: ENFORCER_HOST
            value: 127.0.0.1
          - name: ENFORCER_ANALYTICS_HOST
            value: 127.0.0.1
          - name: ROUTER_ADMIN_HOST
            value: 0.0.0.0
          - name: ROUTER_ADMIN_PORT
            value: "9000"
          - name: ROUTER_PORT
            value: "9095"
          - name: ROUTER_CLUSTER
            value: apk_router_cluster
          - name: ROUTER_LABEL
            value: wso2-apk-default
          - name: ROUTER_PRIVATE_KEY_PATH
            value: /home/wso2/security/keystore/router.key
          - name: ROUTER_PUBLIC_CERT_PATH
            value: /home/wso2/security/keystore/router.crt
          - name: ADAPTER_PORT
            value: "18000"
          - name: ADAPTER_CA_CERT_PATH
            value: /home/wso2/security/truststore/adapter.crt
          - name: ENFORCER_PORT
            value: "8081"
          - name: ENFORCER_ANALYTICS_RECEIVER_PORT
            value: "18090"
          - name: ENFORCER_CA_CERT_PATH
            value: /home/wso2/security/truststore/enforcer.crt
          - name: CONCURRENCY
            value: "2"
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-router:4.5
          imagePullPolicy: Always
          livenessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: router
          ports:
          - containerPort: 9095
            protocol: TCP
          - containerPort: 9090
            protocol: TCP
          - containerPort: 9091
            protocol: TCP
          - containerPort: 9000
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: "1"
              memory: 1028Mi
            requests:
              cpu: 200m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsNonRoot: true
          startupProbe:
            exec:
              command:
              - sh
              - router_check_health.sh
              - health
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/router.key
            name: router-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/router.crt
            name: router-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/adapter.crt
            name: adapter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/enforcer.crt
            name: enforcer-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/conf/
            name: log-conf-volume
          - mountPath: /home/wso2/security/truststore/ratelimiter.crt
            name: ratelimiter-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-truststore-secret-volume
            subPath: ca.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          seccompProfile:
            type: RuntimeDefault
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
        - name: enforcer-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-server-cert
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-log-conf
          name: log-conf-volume
        - configMap:
            defaultMode: 420
            name: apptest-5mjr3ks3-wso2-apk-enforcer-grpc-probe-script-conf
          name: enforcer-health-check-volume
        - name: router-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-gateway-server-cert
        - name: adapter-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-adapter-server-cert
        - name: enforcer-jwt-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-keystore-secret
        - name: enforcer-trusted-certs
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
        - name: enforcer-apikey-cert
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
        - name: idp-certificate-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-enforcer-truststore-secret
        - emptyDir: {}
          name: tmp
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: ReplicaSet
  metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2025-12-02T10:00:20Z"
    generation: 1
    labels:
      app.kubernetes.io/app: ratelimiter
      app.kubernetes.io/release: apptest-5mjr3ks3
      pod-template-hash: 7c67b45dbc
    name: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment-7c67b45dbc
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: apptest-5mjr3ks3-wso2-apk-ratelimiter-deployment
      uid: fac209c7-596b-4467-8e99-5a7006c41521
    resourceVersion: "1764669621243887023"
    uid: fa2cc910-3e09-417d-81a8-ffc3a6415569
  spec:
    replicas: 1
    selector:
      matchLabels:
        app.kubernetes.io/app: ratelimiter
        app.kubernetes.io/release: apptest-5mjr3ks3
        pod-template-hash: 7c67b45dbc
    template:
      metadata:
        creationTimestamp: null
        labels:
          app.kubernetes.io/app: ratelimiter
          app.kubernetes.io/release: apptest-5mjr3ks3
          pod-template-hash: 7c67b45dbc
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/app
                    operator: In
                    values:
                    - rate-limiter
                topologyKey: topology.kubernetes.io/zone
              weight: 100
        automountServiceAccountToken: false
        containers:
        - env:
          - name: HOST
            value: 0.0.0.0
          - name: PORT
            value: "8090"
          - name: USE_STATSD
            value: "false"
          - name: LOG_LEVEL
            value: DEBUG
          - name: LIMIT_RESPONSE_HEADERS_ENABLED
            value: "false"
          - name: REDIS_TYPE
            value: single
          - name: REDIS_SOCKET_TYPE
            value: tcp
          - name: REDIS_URL
            value: redis-master:6379
          - name: REDIS_PIPELINE_WINDOW
            value: 0.2ms
          - name: REDIS_PIPELINE_LIMIT
            value: "0"
          - name: GRPC_HOST
            value: 0.0.0.0
          - name: GRPC_PORT
            value: "8091"
          - name: GRPC_SERVER_USE_TLS
            value: "true"
          - name: GRPC_SERVER_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: GRPC_SERVER_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: GRPC_CLIENT_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: RATELIMITER_LABEL
            value: ratelimiter
          - name: CONFIG_GRPC_XDS_SERVER_URL
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc:18005
          - name: CONFIG_GRPC_XDS_SERVER_USE_TLS
            value: "true"
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_KEY
            value: /home/wso2/security/keystore/ratelimiter.key
          - name: CONFIG_GRPC_XDS_CLIENT_TLS_CERT
            value: /home/wso2/security/keystore/ratelimiter.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_CACERT
            value: /home/wso2/security/truststore/ratelimiter-ca.crt
          - name: CONFIG_GRPC_XDS_SERVER_TLS_SAN
            value: apptest-5mjr3ks3-wso2-apk-common-controller-service.apptest-5mjr3ks3.svc
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/apk-ratelimiter:4.5
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          name: ratelimiter
          ports:
          - containerPort: 8090
            protocol: TCP
          - containerPort: 8091
            protocol: TCP
          - containerPort: 6070
            protocol: TCP
          readinessProbe:
            failureThreshold: 5
            httpGet:
              path: /healthcheck
              port: 8090
              scheme: HTTP
            initialDelaySeconds: 20
            periodSeconds: 20
            successThreshold: 1
            timeoutSeconds: 1
          resources:
            limits:
              cpu: 100m
              memory: 128Mi
            requests:
              cpu: 50m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /home/wso2/security/keystore/ratelimiter.key
            name: ratelimiter-keystore-secret-volume
            subPath: tls.key
          - mountPath: /home/wso2/security/keystore/ratelimiter.crt
            name: ratelimiter-keystore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/ratelimiter-ca.crt
            name: ratelimiter-keystore-secret-volume
            subPath: ca.crt
          - mountPath: /home/wso2/security/truststore/adapter.pem
            name: common-controller-truststore-secret-volume
            subPath: tls.crt
          - mountPath: /home/wso2/security/truststore/router.pem
            name: router-truststore-secret-volume
            subPath: tls.crt
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: wso2apk-platform
        serviceAccountName: wso2apk-platform
        terminationGracePeriodSeconds: 30
        volumes:
        - name: ratelimiter-keystore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-ratelimiter-server-cert
        - name: common-controller-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-common-controller-server-cert
        - name: router-truststore-secret-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-wso2-apk-gateway-server-cert
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
- apiVersion: apps/v1
  kind: StatefulSet
  metadata:
    annotations:
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"},"name":"redis-master","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"replicas":1,"revisionHistoryLimit":10,"selector":{"matchLabels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/name":"redis"}},"serviceName":"redis-headless","template":{"metadata":{"annotations":{"checksum/configmap":"2a9ab4a5432825504d910f022638674ce88eaefe9f9f595ad8bc107377d104fb","checksum/health":"aff24913d801436ea469d8d374b2ddb3ec4c43ee7ab24663d5f8ff1a1b6991a9","checksum/scripts":"bdec350b84a1ace7cc118db113a21c9f160bde3425b07714e1c0c1da722621cf","checksum/secret":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a"},"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.4.2","helm.sh/chart":"redis-20.10.0"}},"spec":{"affinity":{"nodeAffinity":null,"podAffinity":null,"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/name":"redis"}},"topologyKey":"kubernetes.io/hostname"},"weight":1}]}},"automountServiceAccountToken":false,"containers":[{"args":["-c","/opt/bitnami/scripts/start-scripts/start-master.sh"],"command":["/bin/bash"],"env":[{"name":"BITNAMI_DEBUG","value":"true"},{"name":"REDIS_REPLICATION_MODE","value":"master"},{"name":"ALLOW_EMPTY_PASSWORD","value":"yes"},{"name":"REDIS_TLS_ENABLED","value":"no"},{"name":"REDIS_PORT","value":"6379"}],"image":"docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["sh","-c","/health/ping_liveness_local.sh 5"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":5,"successThreshold":1,"timeoutSeconds":6},"name":"redis","ports":[{"containerPort":6379,"name":"redis"}],"readinessProbe":{"exec":{"command":["sh","-c","/health/ping_readiness_local.sh 1"]},"failureThreshold":5,"initialDelaySeconds":20,"periodSeconds":5,"successThreshold":1,"timeoutSeconds":2},"resources":{"limits":{"cpu":"150m","ephemeral-storage":"2Gi","memory":"192Mi"},"requests":{"cpu":"100m","ephemeral-storage":"50Mi","memory":"128Mi"}},"securityContext":{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"readOnlyRootFilesystem":true,"runAsGroup":1001,"runAsNonRoot":true,"seLinuxOptions":{},"seccompProfile":{"type":"RuntimeDefault"}},"volumeMounts":[{"mountPath":"/opt/bitnami/scripts/start-scripts","name":"start-scripts"},{"mountPath":"/health","name":"health"},{"mountPath":"/data","name":"redis-data"},{"mountPath":"/opt/bitnami/redis/mounted-etc","name":"config"},{"mountPath":"/opt/bitnami/redis/etc/","name":"empty-dir","subPath":"app-conf-dir"},{"mountPath":"/tmp","name":"empty-dir","subPath":"tmp-dir"}]}],"enableServiceLinks":true,"securityContext":{"fsGroup":1001,"fsGroupChangePolicy":"Always","runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"},"supplementalGroups":[],"sysctls":[]},"serviceAccountName":"redis-master","terminationGracePeriodSeconds":30,"volumes":[{"configMap":{"defaultMode":493,"name":"redis-scripts"},"name":"start-scripts"},{"configMap":{"defaultMode":493,"name":"redis-health"},"name":"health"},{"configMap":{"name":"redis-configuration"},"name":"config"},{"emptyDir":{},"name":"empty-dir"}]}},"updateStrategy":{"type":"RollingUpdate"},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"apptest-5mjr3ks3","app.kubernetes.io/name":"redis"},"name":"redis-data"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"8Gi"}}}}]}}
    creationTimestamp: "2025-12-02T10:00:20Z"
    generation: 1
    labels:
      app.kubernetes.io/component: master
      app.kubernetes.io/instance: apptest-5mjr3ks3
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: redis
      app.kubernetes.io/version: 7.4.2
      helm.sh/chart: redis-20.10.0
    name: redis-master
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669621525695005"
    uid: 3fd64999-f757-4f09-97fd-d5b0bed8f363
  spec:
    persistentVolumeClaimRetentionPolicy:
      whenDeleted: Retain
      whenScaled: Retain
    podManagementPolicy: OrderedReady
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/component: master
        app.kubernetes.io/instance: apptest-5mjr3ks3
        app.kubernetes.io/name: redis
    serviceName: redis-headless
    template:
      metadata:
        annotations:
          checksum/configmap: 2a9ab4a5432825504d910f022638674ce88eaefe9f9f595ad8bc107377d104fb
          checksum/health: aff24913d801436ea469d8d374b2ddb3ec4c43ee7ab24663d5f8ff1a1b6991a9
          checksum/scripts: bdec350b84a1ace7cc118db113a21c9f160bde3425b07714e1c0c1da722621cf
          checksum/secret: 44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a
        creationTimestamp: null
        labels:
          app.kubernetes.io/component: master
          app.kubernetes.io/instance: apptest-5mjr3ks3
          app.kubernetes.io/managed-by: Helm
          app.kubernetes.io/name: redis
          app.kubernetes.io/version: 7.4.2
          helm.sh/chart: redis-20.10.0
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchLabels:
                    app.kubernetes.io/component: master
                    app.kubernetes.io/instance: apptest-5mjr3ks3
                    app.kubernetes.io/name: redis
                topologyKey: kubernetes.io/hostname
              weight: 1
        automountServiceAccountToken: false
        containers:
        - args:
          - -c
          - /opt/bitnami/scripts/start-scripts/start-master.sh
          command:
          - /bin/bash
          env:
          - name: BITNAMI_DEBUG
            value: "true"
          - name: REDIS_REPLICATION_MODE
            value: master
          - name: ALLOW_EMPTY_PASSWORD
            value: "yes"
          - name: REDIS_TLS_ENABLED
            value: "no"
          - name: REDIS_PORT
            value: "6379"
          image: docker.io/bitnamilegacy/redis:7.4.2-debian-12-r4
          imagePullPolicy: IfNotPresent
          livenessProbe:
            exec:
              command:
              - sh
              - -c
              - /health/ping_liveness_local.sh 5
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 6
          name: redis
          ports:
          - containerPort: 6379
            name: redis
            protocol: TCP
          readinessProbe:
            exec:
              command:
              - sh
              - -c
              - /health/ping_readiness_local.sh 1
            failureThreshold: 5
            initialDelaySeconds: 20
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 2
          resources:
            limits:
              cpu: 150m
              ephemeral-storage: 2Gi
              memory: 192Mi
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsGroup: 1001
            runAsNonRoot: true
            seLinuxOptions: {}
            seccompProfile:
              type: RuntimeDefault
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /opt/bitnami/scripts/start-scripts
            name: start-scripts
          - mountPath: /health
            name: health
          - mountPath: /data
            name: redis-data
          - mountPath: /opt/bitnami/redis/mounted-etc
            name: config
          - mountPath: /opt/bitnami/redis/etc/
            name: empty-dir
            subPath: app-conf-dir
          - mountPath: /tmp
            name: empty-dir
            subPath: tmp-dir
        dnsPolicy: ClusterFirst
        enableServiceLinks: true
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          fsGroup: 1001
          fsGroupChangePolicy: Always
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        serviceAccount: redis-master
        serviceAccountName: redis-master
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 493
            name: redis-scripts
          name: start-scripts
        - configMap:
            defaultMode: 493
            name: redis-health
          name: health
        - configMap:
            defaultMode: 420
            name: redis-configuration
          name: config
        - emptyDir: {}
          name: empty-dir
    updateStrategy:
      type: RollingUpdate
    volumeClaimTemplates:
    - apiVersion: v1
      kind: PersistentVolumeClaim
      metadata:
        creationTimestamp: null
        labels:
          app.kubernetes.io/component: master
          app.kubernetes.io/instance: apptest-5mjr3ks3
          app.kubernetes.io/name: redis
        name: redis-data
      spec:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 8Gi
        volumeMode: Filesystem
      status:
        phase: Pending
  status:
    availableReplicas: 0
    collisionCount: 0
    currentReplicas: 1
    currentRevision: redis-master-c4bd6cbb8
    observedGeneration: 1
    replicas: 1
    updateRevision: redis-master-c4bd6cbb8
    updatedReplicas: 1
- apiVersion: batch/v1
  kind: Job
  metadata:
    annotations:
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"batch/v1","kind":"Job","metadata":{"annotations":{},"labels":{"app.kubernetes.io/component":"deployer.marketplace.cloud.google.com","app.kubernetes.io/name":"apptest-5mjr3ks3","marketplace.cloud.google.com/deployer":"Main"},"name":"apptest-5mjr3ks3-deployer","namespace":"apptest-5mjr3ks3","ownerReferences":[{"apiVersion":"app.k8s.io/v1beta1","blockOwnerDeletion":true,"kind":"Application","name":"apptest-5mjr3ks3","uid":"a82f27f1-84ff-4545-9bdb-186e532a17aa"}]},"spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"spec":{"containers":[{"command":["/bin/deploy_with_tests.sh"],"image":"us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5","imagePullPolicy":"Always","name":"deployer","resources":{"requests":{"cpu":"100m","memory":"100Mi"}},"volumeMounts":[{"mountPath":"/data/values.yaml","name":"config-volume","readOnly":true,"subPath":"values.yaml"}]}],"restartPolicy":"Never","serviceAccountName":"apptest-5mjr3ks3-deployer-sa","volumes":[{"name":"config-volume","secret":{"secretName":"apptest-5mjr3ks3-deployer-config"}}]}}}}
    creationTimestamp: "2025-12-02T10:00:06Z"
    generation: 1
    labels:
      app.kubernetes.io/component: deployer.marketplace.cloud.google.com
      app.kubernetes.io/name: apptest-5mjr3ks3
      marketplace.cloud.google.com/deployer: Main
    name: apptest-5mjr3ks3-deployer
    namespace: apptest-5mjr3ks3
    ownerReferences:
    - apiVersion: app.k8s.io/v1beta1
      blockOwnerDeletion: true
      kind: Application
      name: apptest-5mjr3ks3
      uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
    resourceVersion: "1764669625963007016"
    uid: c2884b93-60a4-4f34-89eb-0b91a926dea3
  spec:
    backoffLimit: 0
    completionMode: NonIndexed
    completions: 1
    manualSelector: false
    parallelism: 1
    podReplacementPolicy: TerminatingOrFailed
    selector:
      matchLabels:
        batch.kubernetes.io/controller-uid: c2884b93-60a4-4f34-89eb-0b91a926dea3
    suspend: false
    template:
      metadata:
        annotations:
          sidecar.istio.io/inject: "false"
        creationTimestamp: null
        labels:
          batch.kubernetes.io/controller-uid: c2884b93-60a4-4f34-89eb-0b91a926dea3
          batch.kubernetes.io/job-name: apptest-5mjr3ks3-deployer
          controller-uid: c2884b93-60a4-4f34-89eb-0b91a926dea3
          job-name: apptest-5mjr3ks3-deployer
      spec:
        containers:
        - command:
          - /bin/deploy_with_tests.sh
          image: us-docker.pkg.dev/wso2-marketplace-public/wso2-marketplace/deployer:4.5
          imagePullPolicy: Always
          name: deployer
          resources:
            requests:
              cpu: 100m
              memory: 100Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /data/values.yaml
            name: config-volume
            readOnly: true
            subPath: values.yaml
        dnsPolicy: ClusterFirst
        restartPolicy: Never
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: apptest-5mjr3ks3-deployer-sa
        serviceAccountName: apptest-5mjr3ks3-deployer-sa
        terminationGracePeriodSeconds: 30
        volumes:
        - name: config-volume
          secret:
            defaultMode: 420
            secretName: apptest-5mjr3ks3-deployer-config
  status:
    conditions:
    - lastProbeTime: "2025-12-02T10:00:25Z"
      lastTransitionTime: "2025-12-02T10:00:25Z"
      message: Job has reached the specified backoff limit
      reason: BackoffLimitExceeded
      status: "True"
      type: FailureTarget
    - lastProbeTime: "2025-12-02T10:00:25Z"
      lastTransitionTime: "2025-12-02T10:00:25Z"
      message: Job has reached the specified backoff limit
      reason: BackoffLimitExceeded
      status: "True"
      type: Failed
    failed: 1
    ready: 0
    startTime: "2025-12-02T10:00:06Z"
    terminating: 0
    uncountedTerminatedPods: {}
- apiVersion: app.k8s.io/v1beta1
  kind: Application
  metadata:
    annotations:
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"app.k8s.io/v1beta1","kind":"Application","metadata":{"annotations":{"kubernetes-engine.cloud.google.com/icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==","marketplace.cloud.google.com/deploy-info":"{\"partner_id\": \"wso2-marketplace-public\", \"product_id\": \"wso2-apim-kubernetes\", \"partner_name\": \"WSO2\"}"},"labels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"},"name":"apptest-5mjr3ks3","namespace":"apptest-5mjr3ks3"},"spec":{"componentKinds":[{"group":"apps/v1","kind":"Deployment"},{"group":"apps/v1","kind":"StatefulSet"},{"group":"v1","kind":"Service"},{"group":"v1","kind":"ConfigMap"},{"group":"v1","kind":"Secret"}],"descriptor":{"description":"WSO2 API Manager provides a complete platform for building, managing, and scaling APIs.","links":[{"description":"User Guide: Getting Started","url":"https://apim.docs.wso2.com/"},{"description":"WSO2 API Manager Documentation","url":"https://apim.docs.wso2.com/en/latest/"}],"maintainers":[{"name":"WSO2","url":"https://wso2.com"}],"notes":"WSO2 API Manager has been deployed. Access the management console and API gateway according to your ingress configuration.","type":"WSO2 API Manager","version":"4.5.0"},"selector":{"matchLabels":{"app.kubernetes.io/name":"apptest-5mjr3ks3"}}}}
      kubernetes-engine.cloud.google.com/icon: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==
      marketplace.cloud.google.com/deploy-info: '{"partner_id": "wso2-marketplace-public",
        "product_id": "wso2-apim-kubernetes", "partner_name": "WSO2"}'
    creationTimestamp: "2025-12-02T09:59:38Z"
    generation: 3
    labels:
      app.kubernetes.io/name: apptest-5mjr3ks3
    name: apptest-5mjr3ks3
    namespace: apptest-5mjr3ks3
    resourceVersion: "1764669623078671015"
    uid: a82f27f1-84ff-4545-9bdb-186e532a17aa
  spec:
    assemblyPhase: Failed
    componentKinds:
    - group: apps/v1
      kind: Deployment
    - group: apps/v1
      kind: StatefulSet
    - group: v1
      kind: Service
    - group: v1
      kind: ConfigMap
    - group: v1
      kind: Secret
    descriptor:
      description: WSO2 API Manager provides a complete platform for building, managing,
        and scaling APIs.
      links:
      - description: 'User Guide: Getting Started'
        url: https://apim.docs.wso2.com/
      - description: WSO2 API Manager Documentation
        url: https://apim.docs.wso2.com/en/latest/
      maintainers:
      - name: WSO2
        url: https://wso2.com
      notes: WSO2 API Manager has been deployed. Access the management console and
        API gateway according to your ingress configuration.
      type: WSO2 API Manager
      version: 4.5.0
    selector:
      matchLabels:
        app.kubernetes.io/name: apptest-5mjr3ks3
kind: List
metadata:
  resourceVersion: ""
Using /opt/kubectl/1.31/kubectl (server=1.32)
namespace "apptest-5mjr3ks3" deleted
